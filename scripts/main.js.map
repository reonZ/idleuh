{
  "version": 3,
  "sources": ["../../../../../dev/module-api/foundry/chat.js", "../../../../../dev/module-api/foundry/document.js", "../../../../../dev/module-api/utils/object.js", "../../../../../dev/module-api/utils/string.js", "../../../../../dev/module-api/foundry/handlebars.js", "../../../../../dev/module-api/foundry/item.js", "../../../../../dev/module-api/foundry/localize.js", "../../../../../dev/module-api/foundry/module.js", "../../../../../dev/module-api/foundry/notifications.js", "../../../../../dev/module-api/foundry/settings.js", "../../../../../dev/module-api/foundry/socket.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/index.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/purry.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/add.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/addProp.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/allPass.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/anyPass.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/_withPrecision.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/ceil.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/chunk.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/clamp.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/type.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/clone.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isTruthy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/compact.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/concat.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/_purryOn.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/conditional.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/countBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/pipe.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/createPipe.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/debounce.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/_reduceLazy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/difference.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/differenceWith.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/divide.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/drop.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/_swapInPlace.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/_heap.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/_purryOrderRules.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/dropFirstBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/dropLast.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/dropLastWhile.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/dropWhile.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/equals.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/toPairs.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/evolve.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/_toLazyIndexed.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/filter.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/_toSingle.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/find.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/findIndex.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/findLast.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/findLastIndex.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/first.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/hasAtLeast.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/firstBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/flatten.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/flatMap.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/flatMapToObj.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/flattenDeep.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/floor.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/forEach.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/forEachObj.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/fromPairs.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/groupBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/identity.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/indexBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/intersection.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/intersectionWith.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/invert.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isArray.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isBoolean.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isDate.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isDefined.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isObject.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isString.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isEmpty.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isError.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isFunction.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isNil.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isNonNull.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isNot.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isNumber.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isObjectType.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isPlainObject.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isPromise.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/isSymbol.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/join.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/keys.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/last.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/length.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/map.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/mapKeys.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/mapToObj.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/mapValues.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/maxBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/meanBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/merge.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/mergeAll.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/mergeDeep.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/minBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/multiply.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/noop.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/_quickSelect.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/nthBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/objOf.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/omit.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/omitBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/once.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/only.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/partition.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/pathOr.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/pick.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/pickBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/prop.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/range.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/randomString.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/rankBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/reduce.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/reject.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/reverse.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/round.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/sample.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/set.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/setPath.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/shuffle.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/sliceString.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/sort.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/sortBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/_binarySearchCutoffIndex.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/sortedIndex.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/sortedIndexBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/sortedIndexWith.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/sortedLastIndex.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/sortedLastIndexBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/splice.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/splitAt.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/splitWhen.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/stringToPath.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/subtract.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/sumBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/swapIndices.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/swapProps.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/take.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/takeFirstBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/takeLastWhile.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/takeWhile.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/tap.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/times.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/uniq.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/uniqBy.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/uniqWith.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/values.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/zip.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/zipObj.js", "../../../../../dev/module-api/node_modules/remeda/dist/es/zipWith.js", "../../../../../dev/module-api/pf2e/misc.js", "../../../../../dev/module-api/pf2e/dc.js", "../../../../../dev/module-api/pf2e/spell.js", "../../../../../dev/module-api/pf2e/identify.js", "../../../../../dev/module-api/pf2e/inline-roll.js", "../../../../../dev/module-api/pf2e/item.js", "../../../../../dev/module-api/pf2e/spell-consumables.js", "../../../../../dev/module-api/pf2e/success.js", "../src/macros/shared/esoteric.js", "../src/macros/esoteric.js", "../src/macros/extract.js", "../src/apps/identify.js", "../src/macros/identify.js", "../src/macros/imaginarium.js", "../src/macros/marshal.js", "../src/macros/shared/damage.js", "../src/macros/nimbus.js", "../src/macros/perception.js", "../src/macros/snatcher.js", "../src/macros/spike.js", "../src/macros/vulnerability.js", "../src/main.js"],
  "sourcesContent": ["/**\r\n * @generator\r\n * @template T\r\n * @param {number} nb\r\n * @param {T} [fromMessage]\r\n * @returns {{message: T, html: JQuery}}\r\n */\r\nexport function* latestChatMessages(nb, fromMessage) {\r\n\tconst chat = ui.chat?.element;\r\n\tif (!chat) return;\r\n\r\n\tconst messages = game.messages.contents;\r\n\tconst start =\r\n\t\t(fromMessage\r\n\t\t\t? messages.findLastIndex((m) => m === fromMessage)\r\n\t\t\t: messages.length) - 1;\r\n\r\n\tfor (let i = start; i >= start - nb; i--) {\r\n\t\tconst message = messages[i];\r\n\t\tif (!message) return;\r\n\r\n\t\tconst html = chat.find(`[data-message-id=${message.id}]`);\r\n\t\tif (!html.length) continue;\r\n\r\n\t\tyield { message, html };\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} uuid\r\n * @param {string} [label]\r\n * @returns {string}\r\n */\r\nexport function chatUUID(uuid, label) {\r\n\tif (!uuid) {\r\n\t\treturn `<span style=\"background: #DDD; padding: 1px 4px; border: 1px solid var(--color-border-dark-tertiary);\r\nborder-radius: 2px; white-space: nowrap; word-break: break-all;\">${label}</span>`;\r\n\t}\r\n\r\n\tif (label) return `@UUID[${uuid}]{${label}}`;\r\n\r\n\treturn `@UUID[${uuid}]`;\r\n}\r\n\r\n/**\r\n * @param {object} message\r\n * @returns {string}\r\n */\r\nexport function hasEmbeddedSpell(message) {\r\n\treturn !!(\r\n\t\tmessage.getFlag(\"pf2e\", \"casting.embeddedSpell\") ||\r\n\t\tmessage.item?.trickMagicEntry\r\n\t);\r\n}\r\n", "import { MODULE, socketEmit } from \".\";\r\n\r\n/**\r\n * @param {object} doc\r\n * @param {string[]} path\r\n * @returns {unknown}\r\n */\r\nexport function getInMemory(doc, ...path) {\r\n\treturn getProperty(doc, `modules.${MODULE.id}.${path.join(\".\")}`);\r\n}\r\n\r\n/**\r\n * @param {object} doc\r\n * @param  {(string|unknown)[]} args\r\n * @returns {Boolean}\r\n */\r\nexport function setInMemory(doc, ...args) {\r\n\tconst value = args.splice(-1)[0];\r\n\treturn setProperty(doc, `modules.${MODULE.id}.${args.join(\".\")}`, value);\r\n}\r\n\r\n/**\r\n * @param {object} doc\r\n * @param  {(string|unknown)[]} args\r\n * @returns {unknown}\r\n */\r\nexport function getInMemoryAndSetIfNot(doc, ...args) {\r\n\tconst value = args.splice(-1)[0];\r\n\tconst current = getInMemory(doc, ...args);\r\n\tif (current != null) return current;\r\n\tconst result = typeof value === \"function\" ? value() : value;\r\n\tsetInMemory(doc, ...args, result);\r\n\treturn result;\r\n}\r\n\r\n/**\r\n * @param {object} doc\r\n * @param {string[]} path\r\n * @returns {boolean}\r\n */\r\nexport function deleteInMemory(doc, ...path) {\r\n\tconst split = [\"modules\", MODULE.id, ...path.flatMap((x) => x.split(\".\"))];\r\n\tconst last = split.pop();\r\n\tlet cursor = doc;\r\n\tfor (const key of split) {\r\n\t\tcursor = cursor[key];\r\n\t\tif (!cursor) return true;\r\n\t}\r\n\treturn delete cursor[last];\r\n}\r\n\r\n/**\r\n * @param {object} options\r\n * @param {FoundryDocument} options.doc\r\n * @param {Record<string, unknown>} [options.updates]\r\n * @returns {Promise<void>}\r\n */\r\nexport async function updateDocument({ doc, updates, message }, userId) {\r\n\tconst foundryDoc =\r\n\t\tdoc instanceof foundry.abstract.Document ? doc : await fromUuid(doc);\r\n\r\n\tif (!foundryDoc.isOwner) {\r\n\t\tsocketEmit({\r\n\t\t\ttype: \"permission.update-document\",\r\n\t\t\tdoc: foundryDoc.uuid,\r\n\t\t\tupdates,\r\n\t\t\tmessage,\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\r\n\tfoundryDoc.update(updates);\r\n\r\n\tif (message) {\r\n\t\tmessage.user = userId ?? game.user.id;\r\n\t\tChatMessage.implementation.create(message);\r\n\t}\r\n}\r\n\r\n/** *\r\n * @param {foundry.Document} doc\r\n * @returns {string|undefined}\r\n */\r\nexport function getSourceId(doc) {\r\n\treturn doc.getFlag(\"core\", \"sourceId\");\r\n}\r\n\r\n/**\r\n * @param {foundry.Document} doc\r\n * @param {string|} list\r\n * @returns {boolean}\r\n */\r\nexport function includesSourceId(doc, list) {\r\n\tconst sourceId = getSourceId(doc);\r\n\treturn sourceId ? list.includes(sourceId) : false;\r\n}\r\n\r\n/**\r\n * @param {string|string[]} sourceId\r\n * @returns {(item: object) => boolean}\r\n */\r\nexport function getSourceIdCondition(sourceId) {\r\n\treturn Array.isArray(sourceId)\r\n\t\t? (item) => includesSourceId(item, sourceId)\r\n\t\t: (item) => getSourceId(item) === sourceId;\r\n}\r\n", "export const AsyncFunction = (async () => {}).constructor;\r\n\r\n/**\r\n * @param {object} obj\r\n * @param {string} name\r\n * @returns {boolean}\r\n */\r\nexport function isInstanceOf(obj, name) {\r\n\tif (typeof obj !== \"object\") return false;\r\n\r\n\tlet cursor = Reflect.getPrototypeOf(obj);\r\n\twhile (cursor) {\r\n\t\tif (cursor.constructor.name === name) return true;\r\n\t\tcursor = Reflect.getPrototypeOf(cursor);\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n", "/**\r\n * @param {string} separator\r\n * @param  {(string|string[])[]} path\r\n * @returns {string}\r\n */\r\nexport function joinStr(separator, ...path) {\r\n\tconst pathArr = Array.isArray(path[0]) ? path[0] : path;\r\n\treturn pathArr.filter((x) => typeof x === \"string\").join(separator);\r\n}\r\n\r\n/**\r\n * @param {string} str\r\n * @returns {string}\r\n */\r\nexport function capitalize(str) {\r\n\tif (!str) return \"\";\r\n\treturn str[0].toUpperCase() + str.slice(1);\r\n}\r\n", "import { MODULE } from \".\";\r\nimport { joinStr } from \"../utils\";\r\n\r\n/**\r\n * @param  {(string|object)[]} args\r\n * @returns {Promise<string>}\r\n */\r\nexport function render(...args) {\r\n\tconst data = typeof args.at(-1) === \"object\" ? args.splice(-1)[0] : {};\r\n\tconst path = templatePath(...args);\r\n\treturn renderTemplate(path, data);\r\n}\r\n\r\n/**\r\n * @param  {string[]} path\r\n * @returns {string}\r\n */\r\nexport function templatePath(...path) {\r\n\treturn `modules/${MODULE.id}/templates/${joinStr(\"/\", path)}.hbs`;\r\n}\r\n", "import { getSourceIdCondition } from \"./document\";\r\n\r\n/**\r\n *\r\n * @param {object} actor\r\n * @param {string|string[]} itemTypes\r\n * @returns {object[]}\r\n */\r\nexport function getItems(actor, itemTypes = []) {\r\n\tconst types = typeof itemTypes === \"string\" ? [itemTypes] : itemTypes;\r\n\treturn types.length\r\n\t\t? types.flatMap((type) => actor.itemTypes[type])\r\n\t\t: actor.items;\r\n}\r\n\r\n/**\r\n * @param {object} actor\r\n * @param {string} sourceId\r\n * @param {string|string[]} itemTypes\r\n * @returns {boolean}\r\n */\r\nexport function hasItemWithSourceId(actor, sourceId, itemTypes) {\r\n\treturn getItems(actor, itemTypes).some(getSourceIdCondition(sourceId));\r\n}\r\n\r\n/**\r\n * @param {object} actor\r\n * @param {string} sourceId\r\n * @param {string|string[]} itemTypes\r\n * @returns {object} item\r\n */\r\nexport function getItemWithSourceId(actor, sourceId, itemTypes) {\r\n\treturn getItems(actor, itemTypes).find(getSourceIdCondition(sourceId));\r\n}\r\n", "import { MODULE, error, info, warn } from \".\";\r\nimport { joinStr } from \"../utils\";\r\n\r\n/**\r\n * @param {(string | object)[]} args\r\n * @returns {string}\r\n */\r\nexport function localize(...args) {\r\n\targs.unshift(MODULE.id);\r\n\tconst data = typeof args.at(-1) === \"object\" ? args.splice(-1)[0] : undefined;\r\n\treturn game.i18n[data ? \"format\" : \"localize\"](joinStr(\".\", args), data);\r\n}\r\n\r\n/**\r\n * Check if a module localization exists\r\n * @param {string[]} keys\r\n * @returns {boolean}\r\n */\r\nexport function hasLocalization(...keys) {\r\n\treturn game.i18n.has(`${MODULE.id}.${keys.join(\".\")}`, false);\r\n}\r\n\r\n/**\r\n * Used to localize in handlebars template\r\n * @param  {(string | {hash: object})[]} args\r\n * @returns {string}\r\n */\r\nexport function templateLocalize(...args) {\r\n\tconst data = args.splice(-1)[0].hash;\r\n\treturn localize(...args, data);\r\n}\r\n\r\n/**\r\n * @param  {string[]} path\r\n * @returns {string}\r\n */\r\nexport function localizePath(...path) {\r\n\treturn `${MODULE.id}.${path.join(\".\")}`;\r\n}\r\n\r\n/**\r\n * Convenient localization object with a sub context\r\n * @param {string} subKey\r\n * @returns {typeof localize & {path: typeof localizePath, template: typeof templateLocalize, warn: typeof warn, info: typeof info, error: typeof error, i18n: {i18n: typeof templateLocalize, i18Path: typeof localizePath}}}\r\n */\r\nexport function subLocalize(subKey) {\r\n\tconst fn = (...args) => localize(subKey, ...args);\r\n\r\n\tObject.defineProperties(fn, {\r\n\t\twarn: {\r\n\t\t\tvalue: (str, arg1, arg2) => warn(`${subKey}.${str}`, arg1, arg2),\r\n\t\t\tenumerable: false,\r\n\t\t\tconfigurable: false,\r\n\t\t},\r\n\t\tinfo: {\r\n\t\t\tvalue: (str, arg1, arg2) => info(`${subKey}.${str}`, arg1, arg2),\r\n\t\t\tenumerable: false,\r\n\t\t\tconfigurable: false,\r\n\t\t},\r\n\t\terror: {\r\n\t\t\tvalue: (str, arg1, arg2) => error(`${subKey}.${str}`, arg1, arg2),\r\n\t\t\tenumerable: false,\r\n\t\t\tconfigurable: false,\r\n\t\t},\r\n\t\thas: {\r\n\t\t\tvalue: (key) => hasLocalization(subKey, key),\r\n\t\t\tenumerable: false,\r\n\t\t\tconfigurable: false,\r\n\t\t},\r\n\t\tpath: {\r\n\t\t\tvalue: (key) => localizePath(subKey, key),\r\n\t\t\tenumerable: false,\r\n\t\t\tconfigurable: false,\r\n\t\t},\r\n\t\ttemplate: {\r\n\t\t\tvalue: (key, { hash }) => fn(key, hash),\r\n\t\t\tenumerable: false,\r\n\t\t\tconfigurable: false,\r\n\t\t},\r\n\t\ti18n: {\r\n\t\t\tget() {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ti18n: this.template,\r\n\t\t\t\t\ti18Path: this.path,\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tenumerable: false,\r\n\t\t\tconfigurable: false,\r\n\t\t},\r\n\t});\r\n\r\n\treturn fn;\r\n}\r\n\r\n/**\r\n * @param {string} a\r\n * @param {string} b\r\n * @returns {number}\r\n */\r\nexport function localeCompare(a, b) {\r\n\treturn a.localeCompare(b, game.i18n.lang);\r\n}\r\n", "/**\r\n * @type {string}\r\n */\r\nlet MODULE_ID = null;\r\n\r\nexport const MODULE = {\r\n\tget id() {\r\n\t\tif (!MODULE_ID) {\r\n\t\t\tthrow new Error(\"Module id needs to be registered.\");\r\n\t\t}\r\n\t\treturn MODULE_ID;\r\n\t},\r\n\t/**\r\n\t * @param {string} str\r\n\t */\r\n\terror(str) {\r\n\t\tthrow new Error(`[${this.id}] ${str}`);\r\n\t},\r\n};\r\n\r\n/**\r\n * register the module id\r\n * @param {string} id\r\n */\r\nexport function registerModule(id) {\r\n\tMODULE_ID = id;\r\n}\r\n\r\n/**\r\n * @param {string} [id]\r\n * @returns {object}\r\n */\r\nexport function getModule(id) {\r\n\treturn game.modules.get(id ?? MODULE.id);\r\n}\r\n", "import { localize } from \"./localize\";\r\n\r\n/**\r\n * @param {string} str\r\n * @param {\"warning\" | \"info\" | \"error\" | object | boolean} [arg1]\r\n * @param {object | boolean} [arg2]\r\n * @param {boolean} [arg3]\r\n */\r\nfunction notify(str, arg1, arg2, arg3) {\r\n\tconst type = typeof arg1 === \"string\" ? arg1 : \"info\";\r\n\tconst data =\r\n\t\ttypeof arg1 === \"object\"\r\n\t\t\t? arg1\r\n\t\t\t: typeof arg2 === \"object\"\r\n\t\t\t  ? arg2\r\n\t\t\t  : undefined;\r\n\tconst permanent =\r\n\t\ttypeof arg1 === \"boolean\"\r\n\t\t\t? arg1\r\n\t\t\t: typeof arg2 === \"boolean\"\r\n\t\t\t  ? arg2\r\n\t\t\t  : arg3 ?? false;\r\n\r\n\tui.notifications.notify(localize(str, data), type, { permanent });\r\n}\r\n\r\n/**\r\n * @typedef { (str: string, arg1?: object | boolean, arg2?: boolean) => void } Notify\r\n */\r\n\r\n/**\r\n * @type {Notify}\r\n */\r\nexport function warn(str, arg1, arg2) {\r\n\tnotify(str, \"warning\", arg1, arg2);\r\n}\r\n\r\n/**\r\n * @type {Notify}\r\n */\r\nexport function info(str, arg1, arg2) {\r\n\tnotify(str, \"info\", arg1, arg2);\r\n}\r\n\r\n/**\r\n * @type {Notify}\r\n */\r\nexport function error(str, arg1, arg2) {\r\n\tnotify(str, \"error\", arg1, arg2);\r\n}\r\n", "import { MODULE } from \".\";\r\nimport { arrayToObject } from \"../utils/array\";\r\n\r\n/**\r\n * @template {number | boolean | string} T\r\n * @param { {key: string, type: new (...args: unknkown[]) => T, default: T, [k: string]: unknown }} options\r\n */\r\nexport function registerSetting(options) {\r\n\toptions.key ??= options.name;\r\n\r\n\tif (Array.isArray(options.choices)) {\r\n\t\toptions.choices = arrayToObject(options.choices, (choice) =>\r\n\t\t\tsettingPath(options.key, \"choices\", choice),\r\n\t\t);\r\n\t}\r\n\r\n\toptions.name = settingPath(options.key, \"name\");\r\n\toptions.hint = settingPath(options.key, \"hint\");\r\n\toptions.scope ??= \"world\";\r\n\toptions.config ??= true;\r\n\r\n\tgame.settings.register(MODULE.id, options.key, options);\r\n}\r\n\r\nexport function registerSettingMenu(options) {\r\n\toptions.key ??= options.name;\r\n\r\n\toptions.name = settingPath(\"menus\", options.key, \"name\");\r\n\toptions.label = settingPath(\"menus\", options.key, \"label\");\r\n\toptions.hint = settingPath(\"menus\", options.key, \"hint\");\r\n\toptions.restricted ??= true;\r\n\toptions.icon ??= \"fas fa-cogs\";\r\n\r\n\tgame.settings.registerMenu(MODULE.id, options.key, options);\r\n}\r\n\r\n/**\r\n * @param {string[]} path\r\n * @returns\r\n */\r\nexport function settingPath(...path) {\r\n\treturn `${MODULE.id}.settings.${path.join(\".\")}`;\r\n}\r\n\r\n/**\r\n * @param {string} setting\r\n * @returns {unknown}\r\n */\r\nexport function getSetting(setting) {\r\n\treturn game.settings.get(MODULE.id, setting);\r\n}\r\n\r\n/**\r\n * @param {string} setting\r\n * @returns {boolean}\r\n */\r\nexport function isChoiceSetting(setting) {\r\n\treturn !!game.settings.settings.get(`${MODULE.id}.${setting}`)?.choices;\r\n}\r\n\r\n/**\r\n * @template T\r\n * @param {string} setting\r\n * @param {T} value\r\n * @returns {Promise<T>}\r\n */\r\nexport function setSetting(setting, value) {\r\n\treturn game.settings.set(MODULE.id, setting, value);\r\n}\r\n", "import { MODULE, updateDocument } from \".\";\r\n\r\n/**\r\n * @typedef { {key: string, [k: string]: unknown} } ModulePacket\r\n * @typedef { (packet: ModulePacket, senderId: string) => void} ModuleSocketFunction\r\n */\r\n\r\n/**\r\n * @param {ModuleSocketFunction} callback\r\n */\r\nexport function socketOn(callback) {\r\n\tgame.socket.on(`module.${MODULE.id}`, callback);\r\n}\r\n\r\n/**\r\n * @param {ModuleSocketFunction} callback\r\n */\r\nexport function socketOff(callback) {\r\n\tgame.socket.off(`module.${MODULE.id}`, callback);\r\n}\r\n\r\n/**\r\n * @param {ModulePacket} packet\r\n */\r\nexport function socketEmit(packet) {\r\n\tgame.socket.emit(`module.${MODULE.id}`, packet);\r\n}\r\n\r\nlet permissionSocketRegistered = false;\r\nexport function registerPermissionSocket() {\r\n\tif (permissionSocketRegistered) return;\r\n\r\n\tpermissionSocketRegistered = true;\r\n\r\n\tsocketOn((packet, userId) => {\r\n\t\tswitch (packet.type) {\r\n\t\t\tcase \"permission.update-document\":\r\n\t\t\t\tupdateDocument(packet, userId);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t});\r\n}\r\n", "export * from './add';\nexport * from './addProp';\nexport * from './allPass';\nexport * from './anyPass';\nexport * from './ceil';\nexport * from './chunk';\nexport * from './clamp';\nexport * from './clone';\nexport * from './compact';\nexport * from './concat';\nexport * from './conditional';\nexport * from './countBy';\nexport * from './createPipe';\nexport * from './debounce';\nexport * from './difference';\nexport * from './differenceWith';\nexport * from './divide';\nexport * from './drop';\nexport * from './dropFirstBy';\nexport * from './dropLast';\nexport * from './dropLastWhile';\nexport * from './dropWhile';\nexport * from './equals';\nexport * from './evolve';\nexport * from './filter';\nexport * from './find';\nexport * from './findIndex';\nexport * from './findLast';\nexport * from './findLastIndex';\nexport * from './first';\nexport * from './firstBy';\nexport * from './flatMap';\nexport * from './flatMapToObj';\nexport * from './flatten';\nexport * from './flattenDeep';\nexport * from './floor';\nexport * from './forEach';\nexport * from './forEachObj';\nexport * from './fromPairs';\nexport * from './groupBy';\nexport * from './hasAtLeast';\nexport * from './identity';\nexport * from './indexBy';\nexport * from './intersection';\nexport * from './intersectionWith';\nexport * from './invert';\nexport * from './isArray';\nexport * from './isBoolean';\nexport * from './isDate';\nexport * from './isDefined';\nexport * from './isEmpty';\nexport * from './isError';\nexport * from './isFunction';\nexport * from './isNil';\nexport * from './isNonNull';\nexport * from './isNot';\nexport * from './isNumber';\nexport * from './isObject';\nexport * from './isObjectType';\nexport * from './isPlainObject';\nexport * from './isPromise';\nexport * from './isString';\nexport * from './isSymbol';\nexport * from './isTruthy';\nexport * from './join';\nexport * from './keys';\nexport * from './last';\nexport * from './length';\nexport * from './map';\nexport * from './mapKeys';\nexport * from './mapToObj';\nexport * from './mapValues';\nexport * from './maxBy';\nexport * from './meanBy';\nexport * from './merge';\nexport * from './mergeAll';\nexport * from './mergeDeep';\nexport * from './minBy';\nexport * from './multiply';\nexport * from './noop';\nexport * from './nthBy';\nexport * from './objOf';\nexport * from './omit';\nexport * from './omitBy';\nexport * from './once';\nexport * from './only';\nexport * from './partition';\nexport * from './pathOr';\nexport * from './pick';\nexport * from './pickBy';\nexport * from './pipe';\nexport * from './prop';\nexport * from './purry';\nexport * from './randomString';\nexport * from './range';\nexport * from './rankBy';\nexport * from './reduce';\nexport * from './reject';\nexport * from './reverse';\nexport * from './round';\nexport * from './sample';\nexport * from './set';\nexport * from './setPath';\nexport * from './shuffle';\nexport * from './sliceString';\nexport * from './sort';\nexport * from './sortBy';\nexport * from './sortedIndex';\nexport * from './sortedIndexBy';\nexport * from './sortedIndexWith';\nexport * from './sortedLastIndex';\nexport * from './sortedLastIndexBy';\nexport * from './splice';\nexport * from './splitAt';\nexport * from './splitWhen';\nexport * from './stringToPath';\nexport * from './subtract';\nexport * from './sumBy';\nexport * from './swapIndices';\nexport * from './swapProps';\nexport * from './take';\nexport * from './takeFirstBy';\nexport * from './takeLastWhile';\nexport * from './takeWhile';\nexport * from './tap';\nexport * from './times';\nexport * from './toPairs';\nexport * from './type';\nexport * from './uniq';\nexport * from './uniqBy';\nexport * from './uniqWith';\nexport * from './values';\nexport * from './zip';\nexport * from './zipObj';\nexport * from './zipWith';\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nexport function purry(fn, args, lazy) {\n    var diff = fn.length - args.length;\n    var arrayArgs = Array.from(args);\n    if (diff === 0) {\n        return fn.apply(void 0, arrayArgs);\n    }\n    if (diff === 1) {\n        var ret = function (data) { return fn.apply(void 0, __spreadArray([data], arrayArgs, false)); };\n        if (lazy || fn.lazy) {\n            ret.lazy = lazy || fn.lazy;\n            ret.lazyArgs = args;\n        }\n        return ret;\n    }\n    throw new Error('Wrong number of arguments');\n}\n", "import { purry } from './purry';\nexport function add() {\n    return purry(_add, arguments);\n}\nfunction _add(value, addend) {\n    return value + addend;\n}\n", "var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { purry } from './purry';\nexport function addProp() {\n    return purry(_addProp, arguments);\n}\nfunction _addProp(obj, prop, value) {\n    var _a;\n    return __assign(__assign({}, obj), (_a = {}, _a[prop] = value, _a));\n}\n", "import { purry } from './purry';\nexport function allPass() {\n    return purry(_allPass, arguments);\n}\nfunction _allPass(data, fns) {\n    return fns.every(function (fn) { return fn(data); });\n}\n", "import { purry } from './purry';\nexport function anyPass() {\n    return purry(_anyPass, arguments);\n}\nfunction _anyPass(data, fns) {\n    return fns.some(function (fn) { return fn(data); });\n}\n", "var MAX_PRECISION = 15;\nexport function _withPrecision(roundingFn) {\n    return function (value, precision) {\n        if (precision === 0) {\n            return roundingFn(value);\n        }\n        if (!Number.isInteger(precision)) {\n            throw new TypeError(\"precision must be an integer: \".concat(precision));\n        }\n        if (precision > MAX_PRECISION || precision < -MAX_PRECISION) {\n            throw new RangeError(\"precision must be between -15 and 15\");\n        }\n        if (Number.isNaN(value) || !Number.isFinite(value)) {\n            return roundingFn(value);\n        }\n        var multiplier = Math.pow(10, precision);\n        return roundingFn(value * multiplier) / multiplier;\n    };\n}\n", "import { _withPrecision } from './_withPrecision';\nimport { purry } from './purry';\nexport function ceil() {\n    return purry(_withPrecision(Math.ceil), arguments);\n}\n", "import { purry } from './purry';\nexport function chunk() {\n    return purry(_chunk, arguments);\n}\nfunction _chunk(array, size) {\n    var ret = Array.from({\n        length: Math.ceil(array.length / size),\n    });\n    for (var index = 0; index < ret.length; index += 1) {\n        ret[index] = array.slice(index * size, (index + 1) * size);\n    }\n    return ret;\n}\n", "import { purry } from './purry';\nexport function clamp() {\n    return purry(_clamp, arguments);\n}\nfunction _clamp(value, limits) {\n    if (limits.min != null) {\n        if (limits.min > value) {\n            return limits.min;\n        }\n    }\n    if (limits.max != null) {\n        if (limits.max < value) {\n            return limits.max;\n        }\n    }\n    return value;\n}\n", "export function type(val) {\n    return val === null\n        ? 'Null'\n        : val === undefined\n            ? 'Undefined'\n            : Object.prototype.toString.call(val).slice(8, -1);\n}\n", "import { type } from './type';\nfunction _cloneRegExp(pattern) {\n    return new RegExp(pattern.source, (pattern.global ? 'g' : '') +\n        (pattern.ignoreCase ? 'i' : '') +\n        (pattern.multiline ? 'm' : '') +\n        (pattern.sticky ? 'y' : '') +\n        (pattern.unicode ? 'u' : ''));\n}\nfunction _clone(value, refFrom, refTo, deep) {\n    function copy(copiedValue) {\n        var len = refFrom.length;\n        var idx = 0;\n        while (idx < len) {\n            if (value === refFrom[idx]) {\n                return refTo[idx];\n            }\n            idx += 1;\n        }\n        refFrom[idx + 1] = value;\n        refTo[idx + 1] = copiedValue;\n        for (var key in value) {\n            copiedValue[key] = deep\n                ? _clone(value[key], refFrom, refTo, true)\n                : value[key];\n        }\n        return copiedValue;\n    }\n    switch (type(value)) {\n        case 'Object':\n            return copy({});\n        case 'Array':\n            return copy([]);\n        case 'Date':\n            return new Date(value.valueOf());\n        case 'RegExp':\n            return _cloneRegExp(value);\n        default:\n            return value;\n    }\n}\nexport function clone(value) {\n    return value != null && typeof value.clone === 'function'\n        ? value.clone()\n        : _clone(value, [], [], true);\n}\n", "export function isTruthy(data) {\n    return !!data;\n}\n", "import { isTruthy } from './isTruthy';\nexport function compact(items) {\n    return items.filter(isTruthy);\n}\n", "import { purry } from './purry';\nexport function concat() {\n    return purry(_concat, arguments);\n}\nfunction _concat(arr1, arr2) {\n    return arr1.concat(arr2);\n}\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nexport function purryOn(isArg, implementation, args) {\n    var callArgs = Array.from(args);\n    var dataOrArg = callArgs[0], rest = callArgs.slice(1);\n    return isArg(dataOrArg)\n        ? function (data) { return implementation.apply(void 0, __spreadArray([data], callArgs, false)); }\n        : implementation.apply(void 0, __spreadArray([dataOrArg], rest, false));\n}\n", "import { purryOn } from './_purryOn';\nexport function conditional() {\n    return purryOn(isCase, conditionalImplementation, arguments);\n}\nfunction conditionalImplementation(data) {\n    var cases = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        cases[_i - 1] = arguments[_i];\n    }\n    for (var _a = 0, cases_1 = cases; _a < cases_1.length; _a++) {\n        var _b = cases_1[_a], when = _b[0], then = _b[1];\n        if (when(data)) {\n            return then(data);\n        }\n    }\n    throw new Error('conditional: data failed for all cases');\n}\nfunction isCase(maybeCase) {\n    if (!Array.isArray(maybeCase)) {\n        return false;\n    }\n    var when = maybeCase[0], then = maybeCase[1], rest = maybeCase.slice(2);\n    return (typeof when === 'function' &&\n        when.length <= 1 &&\n        typeof then === 'function' &&\n        then.length <= 1 &&\n        rest.length === 0);\n}\n(function (conditional) {\n    conditional.defaultCase = function (then) {\n        if (then === void 0) { then = trivialDefaultCase; }\n        return [function () { return true; }, then];\n    };\n})(conditional || (conditional = {}));\nvar trivialDefaultCase = function () { return undefined; };\n", "import { purry } from './purry';\nvar _countBy = function (indexed) {\n    return function (array, fn) {\n        return array.reduce(function (ret, item, index) {\n            var value = indexed ? fn(item, index, array) : fn(item);\n            return ret + (value ? 1 : 0);\n        }, 0);\n    };\n};\nexport function countBy() {\n    return purry(_countBy(false), arguments);\n}\n(function (countBy) {\n    function indexed() {\n        return purry(_countBy(true), arguments);\n    }\n    countBy.indexed = indexed;\n})(countBy || (countBy = {}));\n", "export function pipe(value) {\n    var operations = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        operations[_i - 1] = arguments[_i];\n    }\n    var ret = value;\n    var lazyOps = operations.map(function (op) {\n        var _a = op, lazy = _a.lazy, lazyArgs = _a.lazyArgs;\n        if (lazy) {\n            var fn = lazy.apply(void 0, (lazyArgs || []));\n            fn.indexed = lazy.indexed;\n            fn.single = lazy.single;\n            fn.index = 0;\n            fn.items = [];\n            return fn;\n        }\n        return null;\n    });\n    var opIdx = 0;\n    while (opIdx < operations.length) {\n        var op = operations[opIdx];\n        var lazyOp = lazyOps[opIdx];\n        if (!lazyOp) {\n            ret = op(ret);\n            opIdx++;\n            continue;\n        }\n        var lazySeq = [];\n        for (var j = opIdx; j < operations.length; j++) {\n            if (lazyOps[j]) {\n                lazySeq.push(lazyOps[j]);\n                if (lazyOps[j].single) {\n                    break;\n                }\n            }\n            else {\n                break;\n            }\n        }\n        var acc = [];\n        for (var _a = 0, ret_1 = ret; _a < ret_1.length; _a++) {\n            var item = ret_1[_a];\n            if (_processItem({ item: item, acc: acc, lazySeq: lazySeq })) {\n                break;\n            }\n        }\n        var lastLazySeq = lazySeq[lazySeq.length - 1];\n        if (lastLazySeq.single) {\n            ret = acc[0];\n        }\n        else {\n            ret = acc;\n        }\n        opIdx += lazySeq.length;\n    }\n    return ret;\n}\nfunction _processItem(_a) {\n    var item = _a.item, lazySeq = _a.lazySeq, acc = _a.acc;\n    if (lazySeq.length === 0) {\n        acc.push(item);\n        return false;\n    }\n    var lazyResult = { done: false, hasNext: false };\n    var isDone = false;\n    for (var i = 0; i < lazySeq.length; i++) {\n        var lazyFn = lazySeq[i];\n        var indexed = lazyFn.indexed;\n        var index = lazyFn.index;\n        var items = lazyFn.items;\n        items.push(item);\n        lazyResult = indexed ? lazyFn(item, index, items) : lazyFn(item);\n        lazyFn.index++;\n        if (lazyResult.hasNext) {\n            if (lazyResult.hasMany) {\n                var nextValues = lazyResult.next;\n                for (var _i = 0, nextValues_1 = nextValues; _i < nextValues_1.length; _i++) {\n                    var subItem = nextValues_1[_i];\n                    var subResult = _processItem({\n                        item: subItem,\n                        acc: acc,\n                        lazySeq: lazySeq.slice(i + 1),\n                    });\n                    if (subResult) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n            else {\n                item = lazyResult.next;\n            }\n        }\n        if (!lazyResult.hasNext) {\n            break;\n        }\n        if (lazyResult.done) {\n            isDone = true;\n        }\n    }\n    if (lazyResult.hasNext) {\n        acc.push(item);\n    }\n    if (isDone) {\n        return true;\n    }\n    return false;\n}\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { pipe } from './pipe';\nexport function createPipe() {\n    var operations = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        operations[_i] = arguments[_i];\n    }\n    return function (value) { return pipe.apply(void 0, __spreadArray([value], operations, false)); };\n}\n", "export function debounce(func, _a) {\n    var waitMs = _a.waitMs, _b = _a.timing, timing = _b === void 0 ? 'trailing' : _b, maxWaitMs = _a.maxWaitMs;\n    if (maxWaitMs !== undefined && waitMs !== undefined && maxWaitMs < waitMs) {\n        throw new Error(\"debounce: maxWaitMs (\".concat(maxWaitMs, \") cannot be less than waitMs (\").concat(waitMs, \")\"));\n    }\n    var coolDownTimeoutId;\n    var maxWaitTimeoutId;\n    var latestCallArgs;\n    var result;\n    var handleInvoke = function () {\n        if (latestCallArgs === undefined) {\n            return;\n        }\n        if (maxWaitTimeoutId !== undefined) {\n            var timeoutId = maxWaitTimeoutId;\n            maxWaitTimeoutId = undefined;\n            clearTimeout(timeoutId);\n        }\n        var args = latestCallArgs;\n        latestCallArgs = undefined;\n        result = func.apply(void 0, args);\n    };\n    var handleCoolDownEnd = function () {\n        if (coolDownTimeoutId === undefined) {\n            return;\n        }\n        var timeoutId = coolDownTimeoutId;\n        coolDownTimeoutId = undefined;\n        clearTimeout(timeoutId);\n        if (latestCallArgs !== undefined) {\n            handleInvoke();\n        }\n    };\n    var handleDebouncedCall = function (args) {\n        latestCallArgs = args;\n        if (maxWaitMs !== undefined && maxWaitTimeoutId === undefined) {\n            maxWaitTimeoutId = setTimeout(handleInvoke, maxWaitMs);\n        }\n    };\n    return {\n        call: function () {\n            var _a;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            if (coolDownTimeoutId === undefined) {\n                if (timing === 'trailing') {\n                    handleDebouncedCall(args);\n                }\n                else {\n                    result = func.apply(void 0, args);\n                }\n            }\n            else {\n                if (timing !== 'leading') {\n                    handleDebouncedCall(args);\n                }\n                var timeoutId = coolDownTimeoutId;\n                coolDownTimeoutId = undefined;\n                clearTimeout(timeoutId);\n            }\n            coolDownTimeoutId = setTimeout(handleCoolDownEnd, (_a = waitMs !== null && waitMs !== void 0 ? waitMs : maxWaitMs) !== null && _a !== void 0 ? _a : 0);\n            return result;\n        },\n        cancel: function () {\n            if (coolDownTimeoutId !== undefined) {\n                var timeoutId = coolDownTimeoutId;\n                coolDownTimeoutId = undefined;\n                clearTimeout(timeoutId);\n            }\n            if (maxWaitTimeoutId !== undefined) {\n                var timeoutId = maxWaitTimeoutId;\n                maxWaitTimeoutId = undefined;\n                clearTimeout(timeoutId);\n            }\n            latestCallArgs = undefined;\n        },\n        flush: function () {\n            handleCoolDownEnd();\n            return result;\n        },\n        get isPending() {\n            return coolDownTimeoutId !== undefined;\n        },\n        get cachedValue() {\n            return result;\n        },\n    };\n}\n", "export function _reduceLazy(array, lazy, indexed) {\n    var newArray = [];\n    for (var index = 0; index < array.length; index++) {\n        var item = array[index];\n        var result = indexed ? lazy(item, index, array) : lazy(item);\n        if (result.hasMany === true) {\n            newArray.push.apply(newArray, result.next);\n        }\n        else if (result.hasNext) {\n            newArray.push(result.next);\n        }\n    }\n    return newArray;\n}\n", "import { purry } from './purry';\nimport { _reduceLazy } from './_reduceLazy';\nexport function difference() {\n    return purry(_difference, arguments, difference.lazy);\n}\nfunction _difference(array, other) {\n    var lazy = difference.lazy(other);\n    return _reduceLazy(array, lazy);\n}\n(function (difference) {\n    function lazy(other) {\n        var set = new Set(other);\n        return function (value) {\n            if (!set.has(value)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    }\n    difference.lazy = lazy;\n})(difference || (difference = {}));\n", "import { purry } from './purry';\nimport { _reduceLazy } from './_reduceLazy';\nexport function differenceWith() {\n    return purry(_differenceWith, arguments, differenceWith.lazy);\n}\nfunction _differenceWith(array, other, isEquals) {\n    var lazy = differenceWith.lazy(other, isEquals);\n    return _reduceLazy(array, lazy);\n}\n(function (differenceWith) {\n    function lazy(other, isEquals) {\n        return function (value) {\n            if (other.every(function (otherValue) { return !isEquals(value, otherValue); })) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    }\n    differenceWith.lazy = lazy;\n})(differenceWith || (differenceWith = {}));\n", "import { purry } from './purry';\nexport function divide() {\n    return purry(_divide, arguments);\n}\nfunction _divide(value, divisor) {\n    return value / divisor;\n}\n", "import { purry } from './purry';\nimport { _reduceLazy } from './_reduceLazy';\nexport function drop() {\n    return purry(_drop, arguments, drop.lazy);\n}\nfunction _drop(array, n) {\n    return _reduceLazy(array, drop.lazy(n));\n}\n(function (drop) {\n    function lazy(n) {\n        var left = n;\n        return function (value) {\n            if (left > 0) {\n                left--;\n                return {\n                    done: false,\n                    hasNext: false,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        };\n    }\n    drop.lazy = lazy;\n})(drop || (drop = {}));\n", "export function swapInPlace(data, i, j) {\n    var _a;\n    _a = [data[j], data[i]], data[i] = _a[0], data[j] = _a[1];\n}\n", "import { swapInPlace } from './_swapInPlace';\nexport function heapify(heap, compareFn) {\n    for (var i = Math.floor(heap.length / 2) - 1; i >= 0; i--) {\n        heapSiftDown(heap, i, compareFn);\n    }\n}\nexport function heapMaybeInsert(heap, compareFn, item) {\n    var head = heap[0];\n    if (compareFn(item, head) >= 0) {\n        return;\n    }\n    heap[0] = item;\n    heapSiftDown(heap, 0, compareFn);\n    return head;\n}\nfunction heapSiftDown(heap, index, compareFn) {\n    var currentIndex = index;\n    while (currentIndex * 2 + 1 < heap.length) {\n        var firstChildIndex = currentIndex * 2 + 1;\n        var swapIndex = compareFn(heap[currentIndex], heap[firstChildIndex]) < 0\n            ?\n                firstChildIndex\n            : currentIndex;\n        var secondChildIndex = firstChildIndex + 1;\n        if (secondChildIndex < heap.length &&\n            compareFn(heap[swapIndex], heap[secondChildIndex]) < 0) {\n            swapIndex = secondChildIndex;\n        }\n        if (swapIndex === currentIndex) {\n            return;\n        }\n        swapInPlace(heap, currentIndex, swapIndex);\n        currentIndex = swapIndex;\n    }\n}\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar COMPARATORS = {\n    asc: function (x, y) { return x > y; },\n    desc: function (x, y) { return x < y; },\n};\nexport function purryOrderRules(func, inputArgs) {\n    var _a = (Array.isArray(inputArgs) ? inputArgs : Array.from(inputArgs)), dataOrRule = _a[0], rules = _a.slice(1);\n    if (!isOrderRule(dataOrRule)) {\n        var compareFn_1 = orderRuleComparer.apply(void 0, rules);\n        return func(dataOrRule, compareFn_1);\n    }\n    var compareFn = orderRuleComparer.apply(void 0, __spreadArray([dataOrRule], rules, false));\n    return function (data) { return func(data, compareFn); };\n}\nexport function purryOrderRulesWithArgument(func, inputArgs) {\n    var _a = Array.from(inputArgs), first = _a[0], second = _a[1], rest = _a.slice(2);\n    var arg;\n    var argRemoved;\n    if (isOrderRule(second)) {\n        arg = first;\n        argRemoved = __spreadArray([second], rest, true);\n    }\n    else {\n        arg = second;\n        argRemoved = __spreadArray([first], rest, true);\n    }\n    return purryOrderRules(function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return func.apply(void 0, __spreadArray(__spreadArray([], args, false), [arg], false));\n    }, argRemoved);\n}\nfunction orderRuleComparer(primaryRule, secondaryRule) {\n    var otherRules = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        otherRules[_i - 2] = arguments[_i];\n    }\n    var projector = typeof primaryRule === 'function' ? primaryRule : primaryRule[0];\n    var direction = typeof primaryRule === 'function' ? 'asc' : primaryRule[1];\n    var comparator = COMPARATORS[direction];\n    var nextComparer = secondaryRule === undefined\n        ? undefined\n        : orderRuleComparer.apply(void 0, __spreadArray([secondaryRule], otherRules, false));\n    return function (a, b) {\n        var _a;\n        var projectedA = projector(a);\n        var projectedB = projector(b);\n        if (comparator(projectedA, projectedB)) {\n            return 1;\n        }\n        if (comparator(projectedB, projectedA)) {\n            return -1;\n        }\n        return (_a = nextComparer === null || nextComparer === void 0 ? void 0 : nextComparer(a, b)) !== null && _a !== void 0 ? _a : 0;\n    };\n}\nfunction isOrderRule(x) {\n    if (isProjection(x)) {\n        return true;\n    }\n    if (typeof x !== 'object' || !Array.isArray(x)) {\n        return false;\n    }\n    var maybeProjection = x[0], maybeDirection = x[1], rest = x.slice(2);\n    return (isProjection(maybeProjection) &&\n        maybeDirection in COMPARATORS &&\n        rest.length === 0);\n}\nvar isProjection = function (x) {\n    return typeof x === 'function' && x.length === 1;\n};\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { heapify, heapMaybeInsert } from './_heap';\nimport { purryOrderRulesWithArgument } from './_purryOrderRules';\nexport function dropFirstBy() {\n    return purryOrderRulesWithArgument(dropFirstByImplementation, arguments);\n}\nfunction dropFirstByImplementation(data, compareFn, n) {\n    if (n >= data.length) {\n        return [];\n    }\n    if (n <= 0) {\n        return __spreadArray([], data, true);\n    }\n    var heap = data.slice(0, n);\n    heapify(heap, compareFn);\n    var out = [];\n    var rest = data.slice(n);\n    for (var _i = 0, rest_1 = rest; _i < rest_1.length; _i++) {\n        var item = rest_1[_i];\n        var previousHead = heapMaybeInsert(heap, compareFn, item);\n        out.push(previousHead !== null && previousHead !== void 0 ? previousHead : item);\n    }\n    return out;\n}\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { purry } from './purry';\nexport function dropLast() {\n    return purry(_dropLast, arguments);\n}\nfunction _dropLast(array, n) {\n    var copy = __spreadArray([], array, true);\n    if (n > 0) {\n        copy.splice(-n);\n    }\n    return copy;\n}\n", "import { purry } from './purry';\nexport function dropLastWhile() {\n    return purry(_dropLastWhile, arguments);\n}\nfunction _dropLastWhile(data, predicate) {\n    for (var i = data.length - 1; i >= 0; i--) {\n        if (!predicate(data[i])) {\n            return data.slice(0, i + 1);\n        }\n    }\n    return [];\n}\n", "import { purry } from './purry';\nexport function dropWhile() {\n    return purry(_dropWhile, arguments);\n}\nfunction _dropWhile(data, predicate) {\n    for (var i = 0; i < data.length; i++) {\n        if (!predicate(data[i])) {\n            return data.slice(i);\n        }\n    }\n    return [];\n}\n", "import { purry } from './purry';\nvar isArray = Array.isArray;\nvar keyList = Object.keys;\nexport function equals() {\n    return purry(_equals, arguments);\n}\nfunction _equals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (a && b && typeof a === 'object' && typeof b === 'object') {\n        var arrA = isArray(a);\n        var arrB = isArray(b);\n        var i = void 0;\n        var length_1;\n        var key = void 0;\n        if (arrA && arrB) {\n            length_1 = a.length;\n            if (length_1 !== b.length) {\n                return false;\n            }\n            for (i = length_1; i-- !== 0;) {\n                if (!equals(a[i], b[i])) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        if (arrA !== arrB) {\n            return false;\n        }\n        var dateA = a instanceof Date;\n        var dateB = b instanceof Date;\n        if (dateA !== dateB) {\n            return false;\n        }\n        if (dateA && dateB) {\n            return a.getTime() === b.getTime();\n        }\n        var regexpA = a instanceof RegExp;\n        var regexpB = b instanceof RegExp;\n        if (regexpA !== regexpB) {\n            return false;\n        }\n        if (regexpA && regexpB) {\n            return a.toString() === b.toString();\n        }\n        var keys = keyList(a);\n        length_1 = keys.length;\n        if (length_1 !== keyList(b).length) {\n            return false;\n        }\n        for (i = length_1; i-- !== 0;) {\n            if (!Object.prototype.hasOwnProperty.call(b, keys[i])) {\n                return false;\n            }\n        }\n        for (i = length_1; i-- !== 0;) {\n            key = keys[i];\n            if (!equals(a[key], b[key])) {\n                return false;\n            }\n        }\n        return true;\n    }\n    return a !== a && b !== b;\n}\n", "export function toPairs(object) {\n    return Object.entries(object);\n}\n(function (toPairs) {\n    function strict(object) {\n        return Object.entries(object);\n    }\n    toPairs.strict = strict;\n})(toPairs || (toPairs = {}));\n", "var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { purry } from './purry';\nimport { toPairs } from './toPairs';\nexport function evolve() {\n    return purry(_evolve, arguments);\n}\nfunction _evolve(data, evolver) {\n    if (typeof data !== 'object' || data === null) {\n        return data;\n    }\n    return toPairs.strict(evolver).reduce(function (result, _a) {\n        var key = _a[0], value = _a[1];\n        if (key in result) {\n            result[key] =\n                typeof value === 'function'\n                    ? value(result[key])\n                    : _evolve(result[key], value);\n        }\n        return result;\n    }, __assign({}, data));\n}\n", "export var _toLazyIndexed = function (fn) {\n    fn.indexed = true;\n    return fn;\n};\n", "import { purry } from './purry';\nimport { _reduceLazy } from './_reduceLazy';\nimport { _toLazyIndexed } from './_toLazyIndexed';\nexport function filter() {\n    return purry(_filter(false), arguments, filter.lazy);\n}\nvar _filter = function (indexed) {\n    return function (array, fn) {\n        return _reduceLazy(array, indexed ? filter.lazyIndexed(fn) : filter.lazy(fn), indexed);\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            var valid = indexed ? fn(value, index, array) : fn(value);\n            if (valid) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    };\n};\n(function (filter) {\n    function indexed() {\n        return purry(_filter(true), arguments, filter.lazyIndexed);\n    }\n    filter.indexed = indexed;\n    filter.lazy = _lazy(false);\n    filter.lazyIndexed = _toLazyIndexed(_lazy(true));\n})(filter || (filter = {}));\n", "export var _toSingle = function (fn) {\n    fn.single = true;\n    return fn;\n};\n", "import { purry } from './purry';\nimport { _toLazyIndexed } from './_toLazyIndexed';\nimport { _toSingle } from './_toSingle';\nexport function find() {\n    return purry(_find(false), arguments, find.lazy);\n}\nvar _find = function (indexed) {\n    return function (array, fn) {\n        if (indexed) {\n            return array.find(fn);\n        }\n        return array.find(function (x) { return fn(x); });\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            var valid = indexed ? fn(value, index, array) : fn(value);\n            return {\n                done: valid,\n                hasNext: valid,\n                next: value,\n            };\n        };\n    };\n};\n(function (find) {\n    function indexed() {\n        return purry(_find(true), arguments, find.lazyIndexed);\n    }\n    find.indexed = indexed;\n    find.lazy = _toSingle(_lazy(false));\n    find.lazyIndexed = _toSingle(_toLazyIndexed(_lazy(true)));\n})(find || (find = {}));\n", "import { purry } from './purry';\nimport { _toLazyIndexed } from './_toLazyIndexed';\nimport { _toSingle } from './_toSingle';\nexport function findIndex() {\n    return purry(_findIndex(false), arguments, findIndex.lazy);\n}\nvar _findIndex = function (indexed) {\n    return function (array, fn) {\n        if (indexed) {\n            return array.findIndex(fn);\n        }\n        return array.findIndex(function (x) { return fn(x); });\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        var i = 0;\n        return function (value, index, array) {\n            var valid = indexed ? fn(value, index, array) : fn(value);\n            if (valid) {\n                return {\n                    done: true,\n                    hasNext: true,\n                    next: i,\n                };\n            }\n            i++;\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    };\n};\n(function (findIndex) {\n    function indexed() {\n        return purry(_findIndex(true), arguments, findIndex.lazyIndexed);\n    }\n    findIndex.indexed = indexed;\n    findIndex.lazy = _toSingle(_lazy(false));\n    findIndex.lazyIndexed = _toSingle(_toLazyIndexed(_lazy(true)));\n})(findIndex || (findIndex = {}));\n", "import { purry } from './purry';\nexport function findLast() {\n    return purry(_findLast(false), arguments);\n}\nvar _findLast = function (indexed) {\n    return function (array, fn) {\n        for (var i = array.length - 1; i >= 0; i--) {\n            if (indexed ? fn(array[i], i, array) : fn(array[i])) {\n                return array[i];\n            }\n        }\n    };\n};\n(function (findLast) {\n    function indexed() {\n        return purry(_findLast(true), arguments);\n    }\n    findLast.indexed = indexed;\n})(findLast || (findLast = {}));\n", "import { purry } from './purry';\nexport function findLastIndex() {\n    return purry(_findLastIndex(false), arguments);\n}\nvar _findLastIndex = function (indexed) {\n    return function (array, fn) {\n        for (var i = array.length - 1; i >= 0; i--) {\n            if (indexed ? fn(array[i], i, array) : fn(array[i])) {\n                return i;\n            }\n        }\n        return -1;\n    };\n};\n(function (findLastIndex) {\n    function indexed() {\n        return purry(_findLastIndex(true), arguments);\n    }\n    findLastIndex.indexed = indexed;\n})(findLastIndex || (findLastIndex = {}));\n", "import { purry } from './purry';\nexport function first() {\n    return purry(_first, arguments, first.lazy);\n}\nfunction _first(_a) {\n    var first = _a[0];\n    return first;\n}\n(function (first) {\n    function lazy() {\n        return function (value) {\n            return {\n                done: true,\n                hasNext: true,\n                next: value,\n            };\n        };\n    }\n    first.lazy = lazy;\n    (function (lazy) {\n        lazy.single = true;\n    })(lazy = first.lazy || (first.lazy = {}));\n})(first || (first = {}));\n", "import { purry } from './purry';\nexport function hasAtLeast() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    return purry(hasAtLeastImplementation, args);\n}\nvar hasAtLeastImplementation = function (data, minimum) { return data.length >= minimum; };\n", "import { purryOrderRules } from './_purryOrderRules';\nimport { hasAtLeast } from './hasAtLeast';\nexport function firstBy() {\n    return purryOrderRules(firstByImplementation, arguments);\n}\nfunction firstByImplementation(data, compareFn) {\n    var currentFirst = data[0];\n    if (!hasAtLeast(data, 2)) {\n        return currentFirst;\n    }\n    var rest = data.slice(1);\n    for (var _i = 0, rest_1 = rest; _i < rest_1.length; _i++) {\n        var item = rest_1[_i];\n        if (compareFn(item, currentFirst) < 0) {\n            currentFirst = item;\n        }\n    }\n    return currentFirst;\n}\n", "import { _reduceLazy } from './_reduceLazy';\nimport { purry } from './purry';\nexport function flatten() {\n    return purry(_flatten, arguments, flatten.lazy);\n}\nfunction _flatten(items) {\n    return _reduceLazy(items, flatten.lazy());\n}\n(function (flatten) {\n    function lazy() {\n        return function (next) {\n            if (Array.isArray(next)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    hasMany: true,\n                    next: next,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: next,\n            };\n        };\n    }\n    flatten.lazy = lazy;\n})(flatten || (flatten = {}));\n", "import { flatten } from './flatten';\nimport { purry } from './purry';\nexport function flatMap() {\n    return purry(_flatMap, arguments, flatMap.lazy);\n}\nfunction _flatMap(array, fn) {\n    return flatten(array.map(function (item) { return fn(item); }));\n}\n(function (flatMap) {\n    function lazy(fn) {\n        return function (value) {\n            var next = fn(value);\n            if (Array.isArray(next)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    hasMany: true,\n                    next: next,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: next,\n            };\n        };\n    }\n    flatMap.lazy = lazy;\n})(flatMap || (flatMap = {}));\n", "import { purry } from './purry';\nexport function flatMapToObj() {\n    return purry(_flatMapToObj(false), arguments);\n}\nvar _flatMapToObj = function (indexed) {\n    return function (array, fn) {\n        return array.reduce(function (result, element, index) {\n            var items = indexed ? fn(element, index, array) : fn(element);\n            items.forEach(function (_a) {\n                var key = _a[0], value = _a[1];\n                result[key] = value;\n            });\n            return result;\n        }, {});\n    };\n};\n(function (flatMapToObj) {\n    function indexed() {\n        return purry(_flatMapToObj(true), arguments);\n    }\n    flatMapToObj.indexed = indexed;\n})(flatMapToObj || (flatMapToObj = {}));\n", "import { _reduceLazy } from './_reduceLazy';\nimport { purry } from './purry';\nexport function flattenDeep() {\n    return purry(_flattenDeep, arguments, flattenDeep.lazy);\n}\nfunction _flattenDeep(items) {\n    return _reduceLazy(items, flattenDeep.lazy());\n}\nfunction _flattenDeepValue(value) {\n    if (!Array.isArray(value)) {\n        return value;\n    }\n    var ret = [];\n    value.forEach(function (item) {\n        if (Array.isArray(item)) {\n            ret.push.apply(ret, flattenDeep(item));\n        }\n        else {\n            ret.push(item);\n        }\n    });\n    return ret;\n}\n(function (flattenDeep) {\n    function lazy() {\n        return function (value) {\n            var next = _flattenDeepValue(value);\n            if (Array.isArray(next)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    hasMany: true,\n                    next: next,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: next,\n            };\n        };\n    }\n    flattenDeep.lazy = lazy;\n})(flattenDeep || (flattenDeep = {}));\n", "import { _withPrecision } from './_withPrecision';\nimport { purry } from './purry';\nexport function floor() {\n    return purry(_withPrecision(Math.floor), arguments);\n}\n", "import { purry } from './purry';\nimport { _reduceLazy } from './_reduceLazy';\nimport { _toLazyIndexed } from './_toLazyIndexed';\nexport function forEach() {\n    return purry(_forEach(false), arguments, forEach.lazy);\n}\nvar _forEach = function (indexed) {\n    return function (array, fn) {\n        return _reduceLazy(array, indexed ? forEach.lazyIndexed(fn) : forEach.lazy(fn), indexed);\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            if (indexed) {\n                fn(value, index, array);\n            }\n            else {\n                fn(value);\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        };\n    };\n};\n(function (forEach) {\n    function indexed() {\n        return purry(_forEach(true), arguments, forEach.lazyIndexed);\n    }\n    forEach.indexed = indexed;\n    forEach.lazy = _lazy(false);\n    forEach.lazyIndexed = _toLazyIndexed(_lazy(true));\n})(forEach || (forEach = {}));\n", "import { purry } from './purry';\nexport function forEachObj() {\n    return purry(_forEachObj(false), arguments);\n}\nvar _forEachObj = function (indexed) {\n    return function (object, fn) {\n        for (var key in object) {\n            if (Object.prototype.hasOwnProperty.call(object, key)) {\n                var val = object[key];\n                if (indexed)\n                    fn(val, key, object);\n                else\n                    fn(val);\n            }\n        }\n        return object;\n    };\n};\n(function (forEachObj) {\n    function indexed() {\n        return purry(_forEachObj(true), arguments);\n    }\n    forEachObj.indexed = indexed;\n})(forEachObj || (forEachObj = {}));\n", "export function fromPairs(entries) {\n    var out = {};\n    for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n        var _a = entries_1[_i], key = _a[0], value = _a[1];\n        out[key] = value;\n    }\n    return out;\n}\n(function (fromPairs) {\n    fromPairs.strict = fromPairs;\n})(fromPairs || (fromPairs = {}));\n", "import { purry } from './purry';\nexport function groupBy() {\n    return purry(_groupBy(false), arguments);\n}\nvar _groupBy = function (indexed) {\n    return function (array, fn) {\n        var ret = {};\n        array.forEach(function (item, index) {\n            var key = indexed ? fn(item, index, array) : fn(item);\n            if (key !== undefined) {\n                var actualKey = String(key);\n                if (!ret[actualKey]) {\n                    ret[actualKey] = [];\n                }\n                ret[actualKey].push(item);\n            }\n        });\n        return ret;\n    };\n};\n(function (groupBy) {\n    function indexed() {\n        return purry(_groupBy(true), arguments);\n    }\n    groupBy.indexed = indexed;\n    groupBy.strict = groupBy;\n})(groupBy || (groupBy = {}));\n", "export function identity(value) {\n    return value;\n}\n", "import { purry } from './purry';\nexport function indexBy() {\n    return purry(_indexBy(false), arguments);\n}\nvar _indexBy = function (indexed) {\n    return function (array, fn) {\n        return array.reduce(function (ret, item, index) {\n            var value = indexed ? fn(item, index, array) : fn(item);\n            var key = String(value);\n            ret[key] = item;\n            return ret;\n        }, {});\n    };\n};\nfunction indexByStrict() {\n    return purry(_indexByStrict, arguments);\n}\nvar _indexByStrict = function (array, fn) {\n    return array.reduce(function (ret, item) {\n        var key = fn(item);\n        ret[key] = item;\n        return ret;\n    }, {});\n};\n(function (indexBy) {\n    function indexed() {\n        return purry(_indexBy(true), arguments);\n    }\n    indexBy.indexed = indexed;\n    indexBy.strict = indexByStrict;\n})(indexBy || (indexBy = {}));\n", "import { purry } from './purry';\nimport { _reduceLazy } from './_reduceLazy';\nexport function intersection() {\n    return purry(_intersection, arguments, intersection.lazy);\n}\nfunction _intersection(array, other) {\n    var lazy = intersection.lazy(other);\n    return _reduceLazy(array, lazy);\n}\n(function (intersection) {\n    function lazy(other) {\n        return function (value) {\n            var set = new Set(other);\n            if (set.has(value)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    }\n    intersection.lazy = lazy;\n})(intersection || (intersection = {}));\n", "import { _reduceLazy } from './_reduceLazy';\nimport { purry } from './purry';\nexport function intersectionWith() {\n    return purry(_intersectionWith, arguments, intersectionWith.lazy);\n}\nfunction _intersectionWith(array, other, comparator) {\n    var lazy = intersectionWith.lazy(other, comparator);\n    return _reduceLazy(array, lazy);\n}\n(function (intersectionWith) {\n    function lazy(other, comparator) {\n        return function (value) {\n            if (other.some(function (otherValue) { return comparator(value, otherValue); })) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    }\n    intersectionWith.lazy = lazy;\n})(intersectionWith || (intersectionWith = {}));\n", "import { purry } from './purry';\nexport function invert() {\n    return purry(_invert, arguments);\n}\nfunction _invert(object) {\n    var result = {};\n    for (var key in object) {\n        result[object[key]] = key;\n    }\n    return result;\n}\n", "export function isArray(data) {\n    return Array.isArray(data);\n}\n", "export function isBoolean(data) {\n    return typeof data === 'boolean';\n}\n", "export function isDate(data) {\n    return data instanceof Date;\n}\n", "export function isDefined(data) {\n    return typeof data !== 'undefined' && data !== null;\n}\n(function (isDefined) {\n    function strict(data) {\n        return data !== undefined;\n    }\n    isDefined.strict = strict;\n})(isDefined || (isDefined = {}));\n", "export function isObject(data) {\n    return !!data && !Array.isArray(data) && typeof data === 'object';\n}\n", "export function isString(data) {\n    return typeof data === 'string';\n}\n", "import { isArray } from './isArray';\nimport { isObject } from './isObject';\nimport { isString } from './isString';\nexport function isEmpty(data) {\n    if (data === undefined) {\n        return true;\n    }\n    if (isArray(data) || isString(data)) {\n        return data.length === 0;\n    }\n    if (isObject(data)) {\n        return Object.keys(data).length === 0;\n    }\n    return false;\n}\n", "export function isError(data) {\n    return data instanceof Error;\n}\n", "export function isFunction(data) {\n    return typeof data === 'function';\n}\n", "export function isNil(data) {\n    return data == null;\n}\n", "export function isNonNull(data) {\n    return data !== null;\n}\n", "export function isNot(predicate) {\n    return function (data) {\n        return !predicate(data);\n    };\n}\n", "export function isNumber(data) {\n    return typeof data === 'number' && !isNaN(data);\n}\n", "export var isObjectType = function (data) { return typeof data === 'object' && data !== null; };\n", "export function isPlainObject(data) {\n    if (typeof data !== 'object' || data === null) {\n        return false;\n    }\n    var proto = Object.getPrototypeOf(data);\n    return proto === null || proto === Object.prototype;\n}\n", "export function isPromise(data) {\n    return data instanceof Promise;\n}\n", "export function isSymbol(data) {\n    return typeof data === 'symbol';\n}\n", "import { purry } from './purry';\nexport function join() {\n    return purry(joinImplementation, arguments);\n}\nvar joinImplementation = function (data, glue) { return data.join(glue); };\n", "export function keys(source) {\n    return Object.keys(source);\n}\n(function (keys) {\n    keys.strict = keys;\n})(keys || (keys = {}));\n", "import { purry } from './purry';\nexport function last() {\n    return purry(_last, arguments);\n}\nfunction _last(array) {\n    return array[array.length - 1];\n}\n", "import { purry } from './purry';\nexport function length() {\n    return purry(_length, arguments);\n}\nfunction _length(items) {\n    return 'length' in items ? items.length : Array.from(items).length;\n}\n", "import { purry } from './purry';\nimport { _reduceLazy } from './_reduceLazy';\nimport { _toLazyIndexed } from './_toLazyIndexed';\nexport function map() {\n    return purry(_map(false), arguments, map.lazy);\n}\nvar _map = function (indexed) {\n    return function (array, fn) {\n        return _reduceLazy(array, indexed ? map.lazyIndexed(fn) : map.lazy(fn), indexed);\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            return {\n                done: false,\n                hasNext: true,\n                next: indexed ? fn(value, index, array) : fn(value),\n            };\n        };\n    };\n};\n(function (map) {\n    function indexed() {\n        return purry(_map(true), arguments, map.lazyIndexed);\n    }\n    map.indexed = indexed;\n    map.lazy = _lazy(false);\n    map.lazyIndexed = _toLazyIndexed(_lazy(true));\n    map.strict = map;\n})(map || (map = {}));\n", "export function mapKeys(arg1, arg2) {\n    if (arguments.length === 1) {\n        return function (data) { return _mapKeys(data, arg1); };\n    }\n    return _mapKeys(arg1, arg2);\n}\nfunction _mapKeys(obj, fn) {\n    return Object.keys(obj).reduce(function (acc, key) {\n        acc[fn(key, obj[key])] = obj[key];\n        return acc;\n    }, {});\n}\n", "import { purry } from './purry';\nexport function mapToObj() {\n    return purry(_mapToObj(false), arguments);\n}\nvar _mapToObj = function (indexed) {\n    return function (array, fn) {\n        return array.reduce(function (result, element, index) {\n            var _a = indexed ? fn(element, index, array) : fn(element), key = _a[0], value = _a[1];\n            result[key] = value;\n            return result;\n        }, {});\n    };\n};\n(function (mapToObj) {\n    function indexed() {\n        return purry(_mapToObj(true), arguments);\n    }\n    mapToObj.indexed = indexed;\n})(mapToObj || (mapToObj = {}));\n", "export function mapValues(arg1, arg2) {\n    if (arguments.length === 1) {\n        return function (data) { return _mapValues(data, arg1); };\n    }\n    return _mapValues(arg1, arg2);\n}\nfunction _mapValues(obj, fn) {\n    return Object.keys(obj).reduce(function (acc, key) {\n        acc[key] = fn(obj[key], key);\n        return acc;\n    }, {});\n}\n", "import { purry } from './purry';\nvar _maxBy = function (indexed) {\n    return function (array, fn) {\n        var ret = undefined;\n        var retMax = undefined;\n        array.forEach(function (item, i) {\n            var max = indexed ? fn(item, i, array) : fn(item);\n            if (retMax === undefined || max > retMax) {\n                ret = item;\n                retMax = max;\n            }\n        });\n        return ret;\n    };\n};\nexport function maxBy() {\n    return purry(_maxBy(false), arguments);\n}\n(function (maxBy) {\n    function indexed() {\n        return purry(_maxBy(true), arguments);\n    }\n    maxBy.indexed = indexed;\n})(maxBy || (maxBy = {}));\n", "import { purry } from './purry';\nvar _meanBy = function (indexed) {\n    return function (array, fn) {\n        if (array.length === 0) {\n            return NaN;\n        }\n        var sum = 0;\n        array.forEach(function (item, i) {\n            sum += indexed ? fn(item, i, array) : fn(item);\n        });\n        return sum / array.length;\n    };\n};\nexport function meanBy() {\n    return purry(_meanBy(false), arguments);\n}\n(function (meanBy) {\n    function indexed() {\n        return purry(_meanBy(true), arguments);\n    }\n    meanBy.indexed = indexed;\n})(meanBy || (meanBy = {}));\n", "import { purry } from './purry';\nexport function merge() {\n    return purry(_merge, arguments);\n}\nfunction _merge(a, b) {\n    return Object.assign({}, a, b);\n}\n", "var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nexport function mergeAll(items) {\n    return items.reduce(function (acc, x) { return (__assign(__assign({}, acc), x)); }, {});\n}\n", "var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { purry } from './purry';\nexport function mergeDeep() {\n    return purry(mergeDeepImplementation, arguments);\n}\nfunction mergeDeepImplementation(destination, source) {\n    var output = __assign(__assign({}, destination), source);\n    for (var key in source) {\n        if (!(key in destination)) {\n            continue;\n        }\n        var destinationValue = destination[key];\n        if (!isRecord(destinationValue)) {\n            continue;\n        }\n        var sourceValue = source[key];\n        if (!isRecord(sourceValue)) {\n            continue;\n        }\n        output[key] = mergeDeepImplementation(destinationValue, sourceValue);\n    }\n    return output;\n}\nfunction isRecord(object) {\n    return (typeof object === 'object' &&\n        object !== null &&\n        Object.getPrototypeOf(object) === Object.prototype);\n}\n", "import { purry } from './purry';\nvar _minBy = function (indexed) {\n    return function (array, fn) {\n        var ret = undefined;\n        var retMin = undefined;\n        array.forEach(function (item, i) {\n            var min = indexed ? fn(item, i, array) : fn(item);\n            if (retMin === undefined || min < retMin) {\n                ret = item;\n                retMin = min;\n            }\n        });\n        return ret;\n    };\n};\nexport function minBy() {\n    return purry(_minBy(false), arguments);\n}\n(function (minBy) {\n    function indexed() {\n        return purry(_minBy(true), arguments);\n    }\n    minBy.indexed = indexed;\n})(minBy || (minBy = {}));\n", "import { purry } from './purry';\nexport function multiply() {\n    return purry(_multiply, arguments);\n}\nfunction _multiply(value, multiplicand) {\n    return value * multiplicand;\n}\n", "export var noop = function () { return undefined; };\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { swapInPlace } from './_swapInPlace';\nexport var quickSelect = function (data, index, compareFn) {\n    return index < 0 || index >= data.length\n        ?\n            undefined\n        : quickSelectImplementation(__spreadArray([], data, true), 0, data.length - 1, index, compareFn);\n};\nfunction quickSelectImplementation(data, left, right, index, compareFn) {\n    if (left === right) {\n        return data[left];\n    }\n    var pivotIndex = partition(data, left, right, compareFn);\n    return index === pivotIndex\n        ?\n            data[index]\n        : quickSelectImplementation(data, index < pivotIndex ? left : pivotIndex + 1, index < pivotIndex ? pivotIndex - 1 : right, index, compareFn);\n}\nfunction partition(data, left, right, compareFn) {\n    var pivot = data[right];\n    var i = left;\n    for (var j = left; j < right; j++) {\n        if (compareFn(data[j], pivot) < 0) {\n            swapInPlace(data, i, j);\n            i++;\n        }\n    }\n    swapInPlace(data, i, right);\n    return i;\n}\n", "import { purryOrderRulesWithArgument } from './_purryOrderRules';\nimport { quickSelect } from './_quickSelect';\nexport function nthBy() {\n    return purryOrderRulesWithArgument(nthByImplementation, arguments);\n}\nvar nthByImplementation = function (data, compareFn, index) {\n    return quickSelect(data, index >= 0 ? index : data.length + index, compareFn);\n};\n", "import { purry } from './purry';\nexport function objOf() {\n    return purry(_objOf, arguments);\n}\nfunction _objOf(value, key) {\n    var _a;\n    return _a = {}, _a[key] = value, _a;\n}\n", "var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { fromPairs } from './fromPairs';\nimport { purry } from './purry';\nexport function omit() {\n    return purry(_omit, arguments);\n}\nfunction _omit(data, propNames) {\n    if (propNames.length === 0) {\n        return __assign({}, data);\n    }\n    if (propNames.length === 1) {\n        var propName = propNames[0];\n        var _a = data, _b = propName, omitted = _a[_b], remaining = __rest(_a, [typeof _b === \"symbol\" ? _b : _b + \"\"]);\n        return remaining;\n    }\n    if (!propNames.some(function (propName) { return propName in data; })) {\n        return __assign({}, data);\n    }\n    var asSet = new Set(propNames);\n    return fromPairs(Object.entries(data).filter(function (_a) {\n        var key = _a[0];\n        return !asSet.has(key);\n    }));\n}\n", "import { purry } from './purry';\nexport function omitBy() {\n    return purry(_omitBy, arguments);\n}\nfunction _omitBy(object, fn) {\n    return Object.keys(object).reduce(function (acc, key) {\n        if (!fn(object[key], key)) {\n            acc[key] = object[key];\n        }\n        return acc;\n    }, {});\n}\n", "export function once(fn) {\n    var called = false;\n    var ret;\n    return function () {\n        if (!called) {\n            ret = fn();\n            called = true;\n        }\n        return ret;\n    };\n}\n", "import { purry } from './purry';\nexport function only() {\n    return purry(_only, arguments);\n}\nfunction _only(array) {\n    if (array.length === 1) {\n        return array[0];\n    }\n    return undefined;\n}\n", "import { purry } from './purry';\nexport function partition() {\n    return purry(_partition(false), arguments);\n}\nvar _partition = function (indexed) {\n    return function (array, fn) {\n        var ret = [[], []];\n        array.forEach(function (item, index) {\n            var matches = indexed ? fn(item, index, array) : fn(item);\n            ret[matches ? 0 : 1].push(item);\n        });\n        return ret;\n    };\n};\n(function (partition) {\n    function indexed() {\n        return purry(_partition(true), arguments);\n    }\n    partition.indexed = indexed;\n})(partition || (partition = {}));\n", "import { purry } from './purry';\nexport function pathOr() {\n    return purry(_pathOr, arguments);\n}\nfunction _pathOr(object, path, defaultValue) {\n    var current = object;\n    for (var _i = 0, path_1 = path; _i < path_1.length; _i++) {\n        var prop = path_1[_i];\n        if (current == null || current[prop] == null) {\n            return defaultValue;\n        }\n        current = current[prop];\n    }\n    return current;\n}\n", "import { purry } from './purry';\nexport function pick() {\n    return purry(_pick, arguments);\n}\nfunction _pick(object, names) {\n    if (object == null) {\n        return {};\n    }\n    return names.reduce(function (acc, name) {\n        if (name in object) {\n            acc[name] = object[name];\n        }\n        return acc;\n    }, {});\n}\n", "import { purry } from './purry';\nexport function pickBy() {\n    return purry(_pickBy, arguments);\n}\nfunction _pickBy(object, fn) {\n    if (object == null) {\n        return {};\n    }\n    return Object.keys(object).reduce(function (acc, key) {\n        if (fn(object[key], key)) {\n            acc[key] = object[key];\n        }\n        return acc;\n    }, {});\n}\n", "export var prop = function (propName) {\n    return function (_a) {\n        var _b = propName, value = _a[_b];\n        return value;\n    };\n};\n", "import { purry } from './purry';\nexport function range() {\n    return purry(_range, arguments);\n}\nfunction _range(start, end) {\n    var ret = [];\n    for (var i = start; i < end; i++) {\n        ret.push(i);\n    }\n    return ret;\n}\n", "import { range } from './range';\nexport function randomString(length) {\n    var characterSet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    var randomChar = function () {\n        return characterSet[Math.floor(Math.random() * characterSet.length)];\n    };\n    return range(0, length).reduce(function (text) { return text + randomChar(); }, '');\n}\n", "import { purryOrderRulesWithArgument } from './_purryOrderRules';\nexport function rankBy() {\n    return purryOrderRulesWithArgument(rankByImplementation, arguments);\n}\nfunction rankByImplementation(data, compareFn, targetItem) {\n    var rank = 0;\n    for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\n        var item = data_1[_i];\n        if (compareFn(targetItem, item) > 0) {\n            rank++;\n        }\n    }\n    return rank;\n}\n", "import { purry } from './purry';\nexport function reduce() {\n    return purry(_reduce(false), arguments);\n}\nvar _reduce = function (indexed) {\n    return function (items, fn, initialValue) {\n        return items.reduce(function (acc, item, index) {\n            return indexed ? fn(acc, item, index, items) : fn(acc, item);\n        }, initialValue);\n    };\n};\n(function (reduce) {\n    function indexed() {\n        return purry(_reduce(true), arguments);\n    }\n    reduce.indexed = indexed;\n})(reduce || (reduce = {}));\n", "import { purry } from './purry';\nimport { _reduceLazy } from './_reduceLazy';\nimport { _toLazyIndexed } from './_toLazyIndexed';\nexport function reject() {\n    return purry(_reject(false), arguments, reject.lazy);\n}\nvar _reject = function (indexed) {\n    return function (array, fn) {\n        return _reduceLazy(array, indexed ? reject.lazyIndexed(fn) : reject.lazy(fn), indexed);\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            var valid = indexed ? fn(value, index, array) : fn(value);\n            if (!valid) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    };\n};\n(function (reject) {\n    function indexed() {\n        return purry(_reject(true), arguments, reject.lazyIndexed);\n    }\n    reject.indexed = indexed;\n    reject.lazy = _lazy(false);\n    reject.lazyIndexed = _toLazyIndexed(_lazy(true));\n})(reject || (reject = {}));\n", "import { purry } from './purry';\nexport function reverse() {\n    return purry(_reverse, arguments);\n}\nfunction _reverse(array) {\n    return array.slice().reverse();\n}\n", "import { _withPrecision } from './_withPrecision';\nimport { purry } from './purry';\nexport function round() {\n    return purry(_withPrecision(Math.round), arguments);\n}\n", "import { purry } from './purry';\nexport function sample() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    return purry(sampleImplementation, args);\n}\nfunction sampleImplementation(data, sampleSize) {\n    if (sampleSize < 0) {\n        throw new RangeError(\"sampleSize must cannot be negative: \".concat(sampleSize));\n    }\n    if (!Number.isInteger(sampleSize)) {\n        throw new TypeError(\"sampleSize must be an integer: \".concat(sampleSize));\n    }\n    if (sampleSize >= data.length) {\n        return data;\n    }\n    if (sampleSize === 0) {\n        return [];\n    }\n    var actualSampleSize = Math.min(sampleSize, data.length - sampleSize);\n    var sampleIndices = new Set();\n    while (sampleIndices.size < actualSampleSize) {\n        var randomIndex = Math.floor(Math.random() * data.length);\n        sampleIndices.add(randomIndex);\n    }\n    if (sampleSize === actualSampleSize) {\n        return Array.from(sampleIndices)\n            .sort(function (a, b) { return a - b; })\n            .map(function (index) { return data[index]; });\n    }\n    return data.filter(function (_, index) { return !sampleIndices.has(index); });\n}\n", "var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { purry } from './purry';\nexport function set() {\n    return purry(_set, arguments);\n}\nfunction _set(obj, prop, value) {\n    var _a;\n    return __assign(__assign({}, obj), (_a = {}, _a[prop] = value, _a));\n}\n", "var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { purry } from './purry';\nexport function setPath() {\n    return purry(_setPath, arguments);\n}\nexport function _setPath(object, path, value) {\n    var _a;\n    if (path.length === 0)\n        return value;\n    if (Array.isArray(object)) {\n        return object.map(function (item, index) {\n            if (index === path[0]) {\n                return _setPath(item, path.slice(1), value);\n            }\n            return item;\n        });\n    }\n    return __assign(__assign({}, object), (_a = {}, _a[path[0]] = _setPath(object[path[0]], path.slice(1), value), _a));\n}\n", "import { purry } from './purry';\nexport function shuffle() {\n    return purry(_shuffle, arguments);\n}\nfunction _shuffle(items) {\n    var result = items.slice();\n    for (var index = 0; index < items.length; index += 1) {\n        var rand = index + Math.floor(Math.random() * (items.length - index));\n        var value = result[rand];\n        result[rand] = result[index];\n        result[index] = value;\n    }\n    return result;\n}\n", "export var sliceString = function (indexStart, indexEnd) {\n    return function (data) {\n        return data.slice(indexStart, indexEnd);\n    };\n};\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { purry } from './purry';\nexport function sort() {\n    return purry(_sort, arguments);\n}\nfunction _sort(items, cmp) {\n    var ret = __spreadArray([], items, true);\n    ret.sort(cmp);\n    return ret;\n}\n(function (sort) {\n    sort.strict = sort;\n})(sort || (sort = {}));\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { purryOrderRules } from './_purryOrderRules';\nexport function sortBy() {\n    return purryOrderRules(_sortBy, arguments);\n}\nvar _sortBy = function (data, compareFn) {\n    return __spreadArray([], data, true).sort(compareFn);\n};\n(function (sortBy) {\n    sortBy.strict = sortBy;\n})(sortBy || (sortBy = {}));\n", "export function _binarySearchCutoffIndex(array, predicate) {\n    var lowIndex = 0;\n    var highIndex = array.length;\n    while (lowIndex < highIndex) {\n        var pivotIndex = (lowIndex + highIndex) >>> 1;\n        var pivot = array[pivotIndex];\n        if (predicate(pivot, pivotIndex)) {\n            lowIndex = pivotIndex + 1;\n        }\n        else {\n            highIndex = pivotIndex;\n        }\n    }\n    return highIndex;\n}\n", "import { purry } from './purry';\nimport { _binarySearchCutoffIndex } from './_binarySearchCutoffIndex';\nexport function sortedIndex() {\n    return purry(sortedIndexImplementation, arguments);\n}\nvar sortedIndexImplementation = function (array, item) { return _binarySearchCutoffIndex(array, function (pivot) { return pivot < item; }); };\n", "import { purry } from './purry';\nimport { _binarySearchCutoffIndex } from './_binarySearchCutoffIndex';\nexport function sortedIndexBy() {\n    return purry(sortedIndexByImplementation, arguments);\n}\n(function (sortedIndexBy) {\n    function indexed() {\n        return purry(sortedIndexByImplementation, arguments);\n    }\n    sortedIndexBy.indexed = indexed;\n})(sortedIndexBy || (sortedIndexBy = {}));\nfunction sortedIndexByImplementation(array, item, valueFunction) {\n    var value = valueFunction(item);\n    return _binarySearchCutoffIndex(array, function (pivot, index) { return valueFunction(pivot, index) < value; });\n}\n", "import { purry } from './purry';\nimport { _binarySearchCutoffIndex } from './_binarySearchCutoffIndex';\nexport function sortedIndexWith() {\n    return purry(_binarySearchCutoffIndex, arguments);\n}\n(function (sortedIndexWith) {\n    function indexed() {\n        return purry(_binarySearchCutoffIndex, arguments);\n    }\n    sortedIndexWith.indexed = indexed;\n})(sortedIndexWith || (sortedIndexWith = {}));\n", "import { purry } from './purry';\nimport { _binarySearchCutoffIndex } from './_binarySearchCutoffIndex';\nexport function sortedLastIndex() {\n    return purry(sortedLastIndexImplementation, arguments);\n}\nvar sortedLastIndexImplementation = function (array, item) {\n    return _binarySearchCutoffIndex(array, function (pivot) { return pivot <= item; });\n};\n", "import { purry } from './purry';\nimport { _binarySearchCutoffIndex } from './_binarySearchCutoffIndex';\nexport function sortedLastIndexBy() {\n    return purry(sortedLastIndexByImplementation, arguments);\n}\n(function (sortedLastIndexBy) {\n    function indexed() {\n        return purry(sortedLastIndexByImplementation, arguments);\n    }\n    sortedLastIndexBy.indexed = indexed;\n})(sortedLastIndexBy || (sortedLastIndexBy = {}));\nfunction sortedLastIndexByImplementation(array, item, valueFunction) {\n    var value = valueFunction(item);\n    return _binarySearchCutoffIndex(array, function (pivot, index) { return valueFunction(pivot, index) <= value; });\n}\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { purry } from './purry';\nexport function splice() {\n    return purry(_splice, arguments);\n}\nfunction _splice(items, start, deleteCount, replacement) {\n    var result = __spreadArray([], items, true);\n    result.splice.apply(result, __spreadArray([start, deleteCount], replacement, false));\n    return result;\n}\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { purry } from './purry';\nexport function splitAt() {\n    return purry(_splitAt, arguments);\n}\nfunction _splitAt(array, index) {\n    var copy = __spreadArray([], array, true);\n    var tail = copy.splice(index);\n    return [copy, tail];\n}\n", "import { splitAt } from './splitAt';\nimport { purry } from './purry';\nexport function splitWhen() {\n    return purry(_splitWhen, arguments);\n}\nfunction _splitWhen(array, fn) {\n    for (var i = 0; i < array.length; i++) {\n        if (fn(array[i])) {\n            return splitAt(array, i);\n        }\n    }\n    return [array, []];\n}\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nexport function stringToPath(path) {\n    return _stringToPath(path);\n}\nfunction _stringToPath(path) {\n    var _a;\n    if (path.length === 0)\n        return [];\n    var match = (_a = path.match(/^\\[(.+?)\\](.*)$/)) !== null && _a !== void 0 ? _a : path.match(/^\\.?([^.[\\]]+)(.*)$/);\n    if (match) {\n        var key = match[1], rest = match[2];\n        return __spreadArray([key], _stringToPath(rest), true);\n    }\n    return [path];\n}\n", "import { purry } from './purry';\nexport function subtract() {\n    return purry(_subtract, arguments);\n}\nfunction _subtract(value, subtrahend) {\n    return value - subtrahend;\n}\n", "import { purry } from './purry';\nvar _sumBy = function (indexed) {\n    return function (array, fn) {\n        var sum = 0;\n        array.forEach(function (item, i) {\n            var summand = indexed ? fn(item, i, array) : fn(item);\n            sum += summand;\n        });\n        return sum;\n    };\n};\nexport function sumBy() {\n    return purry(_sumBy(false), arguments);\n}\n(function (sumBy) {\n    function indexed() {\n        return purry(_sumBy(true), arguments);\n    }\n    sumBy.indexed = indexed;\n})(sumBy || (sumBy = {}));\n", "import { purry } from './purry';\nexport function swapIndices() {\n    return purry(_swapIndices, arguments);\n}\nfunction _swapIndices(item, index1, index2) {\n    return typeof item === 'string'\n        ? _swapString(item, index1, index2)\n        : _swapArray(item, index1, index2);\n}\nfunction _swapArray(item, index1, index2) {\n    var result = item.slice();\n    if (isNaN(index1) || isNaN(index2)) {\n        return result;\n    }\n    var positiveIndexA = index1 < 0 ? item.length + index1 : index1;\n    var positiveIndexB = index2 < 0 ? item.length + index2 : index2;\n    if (positiveIndexA < 0 || positiveIndexA > item.length) {\n        return result;\n    }\n    if (positiveIndexB < 0 || positiveIndexB > item.length) {\n        return result;\n    }\n    result[positiveIndexA] = item[positiveIndexB];\n    result[positiveIndexB] = item[positiveIndexA];\n    return result;\n}\nfunction _swapString(item, index1, index2) {\n    var result = _swapArray(item.split(''), index1, index2);\n    return result.join('');\n}\n", "var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { purry } from './purry';\nexport function swapProps() {\n    return purry(_swapProps, arguments);\n}\nfunction _swapProps(obj, key1, key2) {\n    var _a;\n    var _b = obj, _c = key1, value1 = _b[_c], _d = key2, value2 = _b[_d];\n    return __assign(__assign({}, obj), (_a = {}, _a[key1] = value2, _a[key2] = value1, _a));\n}\n", "import { purry } from './purry';\nimport { _reduceLazy } from './_reduceLazy';\nexport function take() {\n    return purry(_take, arguments, take.lazy);\n}\nfunction _take(array, n) {\n    return _reduceLazy(array, take.lazy(n));\n}\n(function (take) {\n    function lazy(n) {\n        return function (value) {\n            if (n === 0) {\n                return {\n                    done: true,\n                    hasNext: false,\n                };\n            }\n            n--;\n            if (n === 0) {\n                return {\n                    done: true,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        };\n    }\n    take.lazy = lazy;\n})(take || (take = {}));\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { heapify, heapMaybeInsert } from './_heap';\nimport { purryOrderRulesWithArgument } from './_purryOrderRules';\nexport function takeFirstBy() {\n    return purryOrderRulesWithArgument(takeFirstByImplementation, arguments);\n}\nfunction takeFirstByImplementation(data, compareFn, n) {\n    if (n <= 0) {\n        return [];\n    }\n    if (n >= data.length) {\n        return __spreadArray([], data, true);\n    }\n    var heap = data.slice(0, n);\n    heapify(heap, compareFn);\n    var rest = data.slice(n);\n    for (var _i = 0, rest_1 = rest; _i < rest_1.length; _i++) {\n        var item = rest_1[_i];\n        heapMaybeInsert(heap, compareFn, item);\n    }\n    return heap;\n}\n", "import { purry } from './purry';\nexport function takeLastWhile() {\n    return purry(_takeLastWhile, arguments);\n}\nfunction _takeLastWhile(data, predicate) {\n    for (var i = data.length - 1; i >= 0; i--) {\n        if (!predicate(data[i])) {\n            return data.slice(i + 1);\n        }\n    }\n    return data.slice();\n}\n", "import { purry } from './purry';\nexport function takeWhile() {\n    return purry(_takeWhile, arguments);\n}\nfunction _takeWhile(array, fn) {\n    var ret = [];\n    for (var _i = 0, array_1 = array; _i < array_1.length; _i++) {\n        var item = array_1[_i];\n        if (!fn(item)) {\n            break;\n        }\n        ret.push(item);\n    }\n    return ret;\n}\n", "import { purry } from './purry';\nexport function tap() {\n    return purry(_tap, arguments);\n}\nfunction _tap(value, fn) {\n    fn(value);\n    return value;\n}\n", "import { purry } from './purry';\nexport function times() {\n    return purry(_times, arguments);\n}\nfunction _times(count, fn) {\n    if (count < 0) {\n        throw new RangeError('n must be a non-negative number');\n    }\n    var res = [];\n    for (var i = 0; i < count; i++) {\n        res.push(fn(i));\n    }\n    return res;\n}\n", "import { purry } from './purry';\nimport { _reduceLazy } from './_reduceLazy';\nexport function uniq() {\n    return purry(_uniq, arguments, uniq.lazy);\n}\nfunction _uniq(array) {\n    return _reduceLazy(array, uniq.lazy());\n}\n(function (uniq) {\n    function lazy() {\n        var set = new Set();\n        return function (value) {\n            if (set.has(value)) {\n                return {\n                    done: false,\n                    hasNext: false,\n                };\n            }\n            set.add(value);\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        };\n    }\n    uniq.lazy = lazy;\n})(uniq || (uniq = {}));\n", "import { purry } from './purry';\nimport { _reduceLazy } from './_reduceLazy';\nexport function uniqBy() {\n    return purry(_uniqBy, arguments, lazyUniqBy);\n}\nfunction _uniqBy(array, transformer) {\n    return _reduceLazy(array, lazyUniqBy(transformer));\n}\nfunction lazyUniqBy(transformer) {\n    var set = new Set();\n    return function (value) {\n        var appliedItem = transformer(value);\n        if (set.has(appliedItem)) {\n            return {\n                done: false,\n                hasNext: false,\n            };\n        }\n        set.add(appliedItem);\n        return {\n            done: false,\n            hasNext: true,\n            next: value,\n        };\n    };\n}\n", "import { purry } from './purry';\nimport { _reduceLazy } from './_reduceLazy';\nimport { _toLazyIndexed } from './_toLazyIndexed';\nexport function uniqWith() {\n    return purry(_uniqWith, arguments, uniqWith.lazy);\n}\nfunction _uniqWith(array, isEquals) {\n    var lazy = uniqWith.lazy(isEquals);\n    return _reduceLazy(array, lazy, true);\n}\nfunction _lazy(isEquals) {\n    return function (value, index, array) {\n        if (array &&\n            array.findIndex(function (otherValue) { return isEquals(value, otherValue); }) === index) {\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        }\n        return {\n            done: false,\n            hasNext: false,\n        };\n    };\n}\n(function (uniqWith) {\n    uniqWith.lazy = _toLazyIndexed(_lazy);\n})(uniqWith || (uniqWith = {}));\n", "export function values(source) {\n    return Object.values(source);\n}\n", "import { purry } from './purry';\nexport function zip() {\n    return purry(_zip, arguments);\n}\nfunction _zip(first, second) {\n    var resultLength = first.length > second.length ? second.length : first.length;\n    var result = [];\n    for (var i = 0; i < resultLength; i++) {\n        result.push([first[i], second[i]]);\n    }\n    return result;\n}\n(function (zip) {\n    zip.strict = zip;\n})(zip || (zip = {}));\n", "import { purry } from './purry';\nexport function zipObj() {\n    return purry(_zipObj, arguments);\n}\nfunction _zipObj(first, second) {\n    var resultLength = first.length > second.length ? second.length : first.length;\n    var result = {};\n    for (var i = 0; i < resultLength; i++) {\n        result[first[i]] = second[i];\n    }\n    return result;\n}\n", "export function zipWith() {\n    var args = Array.from(arguments);\n    if (typeof args[0] === 'function' && args.length === 1) {\n        return function (f, s) {\n            return _zipWith(f, s, args[0]);\n        };\n    }\n    if (typeof args[0] === 'function' && args.length === 2) {\n        return function (f) {\n            return _zipWith(f, args[1], args[0]);\n        };\n    }\n    if (args.length === 3) {\n        return _zipWith(args[0], args[1], args[2]);\n    }\n}\nfunction _zipWith(first, second, fn) {\n    var resultLength = first.length > second.length ? second.length : first.length;\n    var result = [];\n    for (var i = 0; i < resultLength; i++) {\n        result.push(fn(first[i], second[i]));\n    }\n    return result;\n}\n", "/**\r\n * @param {number} value\r\n * @returns {string}\r\n */\r\nexport function ordinalString(value) {\r\n\tconst pluralRules = new Intl.PluralRules(game.i18n.lang, { type: \"ordinal\" });\r\n\tconst suffix = game.i18n.localize(\r\n\t\t`PF2E.OrdinalSuffixes.${pluralRules.select(value)}`,\r\n\t);\r\n\treturn game.i18n.format(\"PF2E.OrdinalNumber\", { value, suffix });\r\n}\r\n\r\n/**\r\n * @param {string} message\r\n * @returns {Error}\r\n */\r\nexport function ErrorPF2e(message) {\r\n\treturn Error(`PF2e System | ${message}`);\r\n}\r\n\r\n/**\r\n * @type {Intl.NumberFormat}\r\n */\r\nlet intlNumberFormat;\r\n/**\r\n * @param {number} value\r\n * @param {object} [options]\r\n * @param {boolean} [options.emptyStringZero]\r\n * @param {boolean} [options.zeroIsNegative]\r\n * @returns {string}\r\n */\r\nexport function signedInteger(\r\n\tvalue,\r\n\t{ emptyStringZero = false, zeroIsNegative = false } = {},\r\n) {\r\n\tif (value === 0 && emptyStringZero) return \"\";\r\n\r\n\tintlNumberFormat ??= new Intl.NumberFormat(game.i18n.lang, {\r\n\t\tmaximumFractionDigits: 0,\r\n\t\tsignDisplay: \"always\",\r\n\t});\r\n\r\n\tconst maybeNegativeZero = zeroIsNegative && value === 0 ? -0 : value;\r\n\r\n\treturn intlNumberFormat.format(maybeNegativeZero);\r\n}\r\n\r\n/**\r\n * @param {object} obj\r\n * @param {unknown} key\r\n * @returns {boolean}\r\n */\r\nexport function objectHasKey(obj, key) {\r\n\treturn (typeof key === \"string\" || typeof key === \"number\") && key in obj;\r\n}\r\n\r\n/**\r\n * @param {string} prefix\r\n * @returns {(...args: (string|Record<string, unknown>)[]) => string}\r\n */\r\nexport function localizer(prefix) {\r\n\treturn (...[suffix, formatArgs]) =>\r\n\t\tformatArgs\r\n\t\t\t? game.i18n.format(`${prefix}.${suffix}`, formatArgs)\r\n\t\t\t: game.i18n.localize(`${prefix}.${suffix}`);\r\n}\r\n\r\nconst actionGlyphMap = {\r\n\t0: \"F\",\r\n\tfree: \"F\",\r\n\t1: \"A\",\r\n\t2: \"D\",\r\n\t3: \"T\",\r\n\t\"1 or 2\": \"A/D\",\r\n\t\"1 to 3\": \"A - T\",\r\n\t\"2 or 3\": \"D/T\",\r\n\treaction: \"R\",\r\n};\r\n\r\n/**\r\n * @param {typeof actionGlyphMap} action\r\n * @returns {string}\r\n */\r\nexport function getActionGlyph(action) {\r\n\tif (!action && action !== 0) return \"\";\r\n\r\n\tconst value =\r\n\t\ttypeof action !== \"object\"\r\n\t\t\t? action\r\n\t\t\t: action.type === \"action\"\r\n\t\t\t  ? action.value\r\n\t\t\t  : action.type;\r\n\tconst sanitized = String(value ?? \"\")\r\n\t\t.toLowerCase()\r\n\t\t.trim();\r\n\r\n\treturn actionGlyphMap[sanitized]?.replace(\"-\", \"\u2013\") ?? \"\";\r\n}\r\n\r\nconst actionImgMap = {\r\n\t0: \"systems/pf2e/icons/actions/FreeAction.webp\",\r\n\tfree: \"systems/pf2e/icons/actions/FreeAction.webp\",\r\n\t1: \"systems/pf2e/icons/actions/OneAction.webp\",\r\n\t2: \"systems/pf2e/icons/actions/TwoActions.webp\",\r\n\t3: \"systems/pf2e/icons/actions/ThreeActions.webp\",\r\n\t\"1 or 2\": \"systems/pf2e/icons/actions/OneTwoActions.webp\",\r\n\t\"1 to 3\": \"systems/pf2e/icons/actions/OneThreeActions.webp\",\r\n\t\"2 or 3\": \"systems/pf2e/icons/actions/TwoThreeActions.webp\",\r\n\treaction: \"systems/pf2e/icons/actions/Reaction.webp\",\r\n\tpassive: \"systems/pf2e/icons/actions/Passive.webp\",\r\n};\r\n\r\n/**\r\n *\r\n * @param {string | {type: string, value: 1|2|3|null} | null} action\r\n * @param {string} [fallback]\r\n * @returns {string|null}\r\n */\r\nexport function getActionIcon(\r\n\taction,\r\n\tfallback = \"systems/pf2e/icons/actions/Empty.webp\",\r\n) {\r\n\tif (action === null) return actionImgMap.passive;\r\n\tconst value =\r\n\t\ttypeof action !== \"object\"\r\n\t\t\t? action\r\n\t\t\t: action.type === \"action\"\r\n\t\t\t  ? action.value\r\n\t\t\t  : action.type;\r\n\tconst sanitized = String(value ?? \"\")\r\n\t\t.toLowerCase()\r\n\t\t.trim();\r\n\treturn actionImgMap[sanitized] ?? fallback;\r\n}\r\n\r\n/**\r\n * @param {string} text\r\n * @param {object} [options]\r\n * @param {boolean|null} [options.camel]\r\n * @returns {string}\r\n */\r\nexport function sluggify(text, options) {\r\n\treturn game.pf2e.system.sluggify(text, options);\r\n}\r\n\r\n/**\r\n * @template T\r\n * @param {Set<T>} set\r\n * @param {T} value\r\n * @returns {boolean}\r\n */\r\nexport function setHasElement(set, value) {\r\n\treturn set.has(value);\r\n}\r\n\r\n/**\r\n * @template T\r\n * @param {[T, T]} array\r\n * @param {T} value\r\n * @returns {boolean}\r\n */\r\nexport function tupleHasValue(array, value) {\r\n\treturn array.includes(value);\r\n}\r\n\r\n/**\r\n * @param {unknown} value\r\n * @returns {boolean}\r\n */\r\nexport function isObject(value) {\r\n\treturn typeof value === \"object\" && value !== null;\r\n}\r\n", "export const adjustmentScale = [\r\n\t\"incredibly-easy\",\r\n\t\"very-easy\",\r\n\t\"easy\",\r\n\t\"normal\",\r\n\t\"hard\",\r\n\t\"very-hard\",\r\n\t\"incredibly-hard\",\r\n];\r\n\r\nexport const dcAdjustments = new Map([\r\n\t[\"incredibly-easy\", -10],\r\n\t[\"very-easy\", -5],\r\n\t[\"easy\", -2],\r\n\t[\"normal\", 0],\r\n\t[\"hard\", 2],\r\n\t[\"very-hard\", 5],\r\n\t[\"incredibly-hard\", 10],\r\n]);\r\n\r\nexport const dcByLevel = new Map([\r\n\t[-1, 13],\r\n\t[0, 14],\r\n\t[1, 15],\r\n\t[2, 16],\r\n\t[3, 18],\r\n\t[4, 19],\r\n\t[5, 20],\r\n\t[6, 22],\r\n\t[7, 23],\r\n\t[8, 24],\r\n\t[9, 26],\r\n\t[10, 27],\r\n\t[11, 28],\r\n\t[12, 30],\r\n\t[13, 31],\r\n\t[14, 32],\r\n\t[15, 34],\r\n\t[16, 35],\r\n\t[17, 36],\r\n\t[18, 38],\r\n\t[19, 39],\r\n\t[20, 40],\r\n\t[21, 42],\r\n\t[22, 44],\r\n\t[23, 46],\r\n\t[24, 48],\r\n\t[25, 50],\r\n]);\r\n\r\nexport const simpleDCs = new Map([\r\n\t[\"untrained\", 10],\r\n\t[\"trained\", 15],\r\n\t[\"expert\", 20],\r\n\t[\"master\", 30],\r\n\t[\"legendary\", 40],\r\n]);\r\n\r\nexport const simpleDCsWithoutLevel = new Map([\r\n\t[\"untrained\", 10],\r\n\t[\"trained\", 15],\r\n\t[\"expert\", 20],\r\n\t[\"master\", 25],\r\n\t[\"legendary\", 30],\r\n]);\r\n\r\n/**\r\n * @typedef {\"untrained\" | \"trained\" | \"expert\" | \"master\" | \"legendary\"} Rank\r\n */\r\n\r\n/**\r\n * @typedef {\"common\" | \"uncommon\" | \"rare\" | \"unique\"} Rarity\r\n */\r\n\r\n/**\r\n * @param {number} level\r\n * @returns {number}\r\n */\r\nexport function getDcByLevel(level) {\r\n\tconst clamped = Math.clamped(level, -1, 25);\r\n\treturn dcByLevel.get(clamped);\r\n}\r\n\r\n/**\r\n * @param {number} level\r\n * @param {object} [options]\r\n * @param {boolean} [options.pwol]\r\n * @param {Rarity} [options.rarity]\r\n * @returns {number}\r\n */\r\nexport function calculateDC(level, { pwol, rarity = \"common\" } = {}) {\r\n\tpwol ??= game.pf2e.settings.variants.pwol.enabled;\r\n\r\n\t// assume level 0 if garbage comes in. We cast level to number because the backing data may actually have it\r\n\t// stored as a string, which we can't catch at compile time\r\n\tconst dc = dcByLevel.get(level) ?? 14;\r\n\tif (pwol) {\r\n\t\t// -1 shouldn't be subtracted since it's just\r\n\t\t// a creature level and not related to PC levels\r\n\t\treturn adjustDCByRarity(dc - Math.max(level, 0), rarity);\r\n\t}\r\n\r\n\treturn adjustDCByRarity(dc, rarity);\r\n}\r\n\r\n/**\r\n *\r\n * @param {Rank} rank\r\n * @param {object} [options]\r\n * @param {boolean} [options.pwol]\r\n * @returns {number}\r\n */\r\nexport function calculateSimpleDC(rank, { pwol = false } = {}) {\r\n\tif (pwol) {\r\n\t\treturn simpleDCsWithoutLevel.get(rank) ?? 10;\r\n\t}\r\n\r\n\treturn simpleDCs.get(rank) ?? 10;\r\n}\r\n\r\n/**\r\n *\r\n * @param {number} spellLevel\r\n * @param {object} [options]\r\n * @param {boolean} [options.pwol]\r\n * @returns {number}\r\n */\r\nexport function calculateSpellDC(spellLevel, { pwol = false } = {}) {\r\n\treturn calculateDC(spellLevel * 2 - 1, { pwol });\r\n}\r\n\r\n/**\r\n *\r\n * @param {number} dc\r\n * @param {Rarity} rarity\r\n * @returns {number}\r\n */\r\nexport function adjustDCByRarity(dc, rarity = \"common\") {\r\n\treturn adjustDC(dc, rarityToDCAdjustment(rarity));\r\n}\r\n\r\n/**\r\n *\r\n * @param {number} dc\r\n * @param {Rarity} adjustment\r\n * @returns {number}\r\n */\r\nexport function adjustDC(dc, adjustment = \"normal\") {\r\n\treturn dc + (dcAdjustments.get(adjustment) ?? 0);\r\n}\r\n\r\n/**\r\n * @param {Rarity} rarity\r\n * @returns {\"hard\" | \"normal\" | \"very-hard\" | \"incredibly-hard\"}\r\n */\r\nexport function rarityToDCAdjustment(rarity = \"common\") {\r\n\tswitch (rarity) {\r\n\t\tcase \"uncommon\":\r\n\t\t\treturn \"hard\";\r\n\t\tcase \"rare\":\r\n\t\t\treturn \"very-hard\";\r\n\t\tcase \"unique\":\r\n\t\t\treturn \"incredibly-hard\";\r\n\t\tdefault:\r\n\t\t\treturn \"normal\";\r\n\t}\r\n}\r\n", "export const EFFECT_AREA_SHAPES = [\r\n\t\"burst\",\r\n\t\"cone\",\r\n\t\"cube\",\r\n\t\"cylinder\",\r\n\t\"emanation\",\r\n\t\"line\",\r\n\t\"square\",\r\n];\r\n\r\nexport const MAGIC_TRADITIONS = new Set([\r\n\t\"arcane\",\r\n\t\"divine\",\r\n\t\"occult\",\r\n\t\"primal\",\r\n]);\r\n\r\nexport const traditionSkills = {\r\n\tarcane: \"arcana\",\r\n\tdivine: \"religion\",\r\n\toccult: \"occultism\",\r\n\tprimal: \"nature\",\r\n};\r\n\r\n/**\r\n * @param {string} groupId\r\n * @returns {number|null}\r\n */\r\nexport function spellSlotGroupIdToNumber(groupId) {\r\n\tif (groupId === \"cantrips\") return 0;\r\n\tconst numericValue = Number(groupId ?? NaN);\r\n\treturn numericValue.between(0, 10) ? numericValue : null;\r\n}\r\n\r\n/**\r\n * @param {string} value\r\n * @returns {number|null}\r\n */\r\nexport function coerceToSpellGroupId(value) {\r\n\tif (value === \"cantrips\") return value;\r\n\tconst numericValue = Number(value) || NaN;\r\n\treturn numericValue.between(1, 10) ? numericValue : null;\r\n}\r\n", "import { adjustDCByRarity, calculateDC } from \"./dc\";\r\nimport { setHasElement } from \"./misc\";\r\nimport { MAGIC_TRADITIONS } from \"./spell\";\r\n\r\nexport class IdentifyItemPopup extends FormApplication {\r\n\tstatic get defaultOptions() {\r\n\t\treturn {\r\n\t\t\t...FormApplication.defaultOptions,\r\n\t\t\tid: \"identify-item\",\r\n\t\t\ttitle: game.i18n.localize(\"PF2E.identification.Identify\"),\r\n\t\t\ttemplate: \"systems/pf2e/templates/actors/identify-item.hbs\",\r\n\t\t\twidth: \"auto\",\r\n\t\t\tclasses: [\"identify-popup\"],\r\n\t\t};\r\n\t}\r\n\r\n\tdcs = getItemIdentificationDCs(this.object, {\r\n\t\tpwol: game.pf2e.settings.variants.pwol.enabled,\r\n\t\tnotMatchingTraditionModifier: game.settings.get(\r\n\t\t\t\"pf2e\",\r\n\t\t\t\"identifyMagicNotMatchingTraditionModifier\",\r\n\t\t),\r\n\t});\r\n\r\n\tasync getData() {\r\n\t\tconst item = this.object;\r\n\t\treturn {\r\n\t\t\t...(await super.getData()),\r\n\t\t\tisMagic: item.isMagical,\r\n\t\t\tisAlchemical: item.isAlchemical,\r\n\t\t\tdcs: this.dcs,\r\n\t\t};\r\n\t}\r\n\r\n\tactivateListeners($html) {\r\n\t\tconst html = $html[0];\r\n\r\n\t\tconst updateButton =\r\n\t\t\thtml.querySelector < HTMLButtonElement > \"button.update-identification\";\r\n\t\tupdateButton?.addEventListener(\"click\", () => {\r\n\t\t\tthis.submit({ updateData: { status: updateButton.value } });\r\n\t\t});\r\n\r\n\t\t// Add listener on Post skill checks to chat button that posts item unidentified img and name and skill checks\r\n\t\thtml\r\n\t\t\t.querySelector(\"button.post-skill-checks\")\r\n\t\t\t?.addEventListener(\"click\", async () => {\r\n\t\t\t\tconst item = this.object;\r\n\t\t\t\tconst identifiedName = item.system.identification.identified.name;\r\n\t\t\t\tconst dcs = this.dcs;\r\n\t\t\t\tconst action = item.isMagical\r\n\t\t\t\t\t? \"identify-magic\"\r\n\t\t\t\t\t: item.isAlchemical\r\n\t\t\t\t\t  ? \"identify-alchemy\"\r\n\t\t\t\t\t  : \"recall-knowledge\";\r\n\r\n\t\t\t\tconst content = await renderTemplate(\r\n\t\t\t\t\t\"systems/pf2e/templates/actors/identify-item-chat-skill-checks.hbs\",\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tidentifiedName,\r\n\t\t\t\t\t\taction,\r\n\t\t\t\t\t\tskills: R.omit(dcs, [\"dc\"]),\r\n\t\t\t\t\t\tunidentified: item.system.identification.unidentified,\r\n\t\t\t\t\t\tuuid: item.uuid,\r\n\t\t\t\t\t},\r\n\t\t\t\t);\r\n\r\n\t\t\t\tawait ChatMessage.implementation.create({\r\n\t\t\t\t\tuser: game.user.id,\r\n\t\t\t\t\tcontent,\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t}\r\n\r\n\tasync _updateObject(_event, formData) {\r\n\t\tconst status = formData.status;\r\n\t\tif (status === \"identified\") {\r\n\t\t\treturn this.object.setIdentificationStatus(status);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport function getItemIdentificationDCs(\r\n\titem,\r\n\t{ pwol = false, notMatchingTraditionModifier },\r\n) {\r\n\tconst baseDC = calculateDC(item.level, { pwol });\r\n\tconst rarity = getDcRarity(item);\r\n\tconst dc = adjustDCByRarity(baseDC, rarity);\r\n\tif (item.isMagical) {\r\n\t\treturn getIdentifyMagicDCs(item, dc, notMatchingTraditionModifier);\r\n\t}\r\n\r\n\treturn { crafting: dc };\r\n}\r\n\r\n/**\r\n *\r\n * @param {Item} item\r\n * @returns {import('./dc').Rarity}\r\n */\r\nfunction getDcRarity(item) {\r\n\treturn item.traits.has(\"cursed\") ? \"unique\" : item.rarity;\r\n}\r\n\r\n/**\r\n *\r\n * @param {PhysicalItemPF2e} item\r\n * @param {number} baseDC\r\n * @param {number} notMatchingTraditionModifier\r\n * @returns {{arcana: number; nature: number; occultism: number; religion: number;}}\r\n */\r\nfunction getIdentifyMagicDCs(item, baseDC, notMatchingTraditionModifier) {\r\n\tconst result = {\r\n\t\toccult: baseDC,\r\n\t\tprimal: baseDC,\r\n\t\tdivine: baseDC,\r\n\t\tarcane: baseDC,\r\n\t};\r\n\tconst traditions = getMagicTraditions(item);\r\n\tfor (const key of MAGIC_TRADITIONS) {\r\n\t\t// once an item has a magic tradition, all skills\r\n\t\t// that don't match the tradition are hard\r\n\t\tif (traditions.size > 0 && !traditions.has(key)) {\r\n\t\t\tresult[key] = baseDC + notMatchingTraditionModifier;\r\n\t\t}\r\n\t}\r\n\treturn {\r\n\t\tarcana: result.arcane,\r\n\t\tnature: result.primal,\r\n\t\treligion: result.divine,\r\n\t\toccultism: result.occult,\r\n\t};\r\n}\r\n\r\n/**\r\n * @param {PhysicalItemPF2e} item\r\n * @returns {MAGIC_TRADITIONS}\r\n */\r\nfunction getMagicTraditions(item) {\r\n\tconst traits = item.system.traits.value;\r\n\treturn new Set(traits.filter((t) => setHasElement(MAGIC_TRADITIONS, t)));\r\n}\r\n", "import * as R from \"remeda\";\r\nimport { getSelectedActors } from \"./actor\";\r\nimport { calculateDC } from \"./dc\";\r\nimport { htmlClosest, htmlQueryAll } from \"./html\";\r\nimport { ErrorPF2e, getActionGlyph, sluggify, tupleHasValue } from \"./misc\";\r\nimport { eventToRollParams } from \"./scripts\";\r\nimport { EFFECT_AREA_SHAPES } from \"./spell\";\r\n\r\nconst SAVE_TYPES = [\"fortitude\", \"reflex\", \"will\"];\r\nconst inlineSelector = [\"action\", \"check\", \"effect-area\"]\r\n\t.map((keyword) => `[data-pf2-${keyword}]`)\r\n\t.join(\",\");\r\n\r\nexport const InlineRollLinks = {\r\n\tinjectRepostElement: (links, foundryDoc) => {\r\n\t\tfor (const link of links) {\r\n\t\t\tif (!foundryDoc || foundryDoc.isOwner) link.classList.add(\"with-repost\");\r\n\r\n\t\t\tconst repostButtons = htmlQueryAll(link, \"i[data-pf2-repost]\");\r\n\t\t\tif (repostButtons.length > 0) {\r\n\t\t\t\tif (foundryDoc && !foundryDoc.isOwner) {\r\n\t\t\t\t\tfor (const button of repostButtons) {\r\n\t\t\t\t\t\tbutton.remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlink.classList.remove(\"with-repost\");\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (foundryDoc && !foundryDoc.isOwner) continue;\r\n\r\n\t\t\tconst newButton = document.createElement(\"i\");\r\n\t\t\tconst icon =\r\n\t\t\t\tlink.parentElement?.dataset?.pf2Checkgroup !== undefined\r\n\t\t\t\t\t? \"fa-comment-alt-dots\"\r\n\t\t\t\t\t: \"fa-comment-alt\";\r\n\t\t\tnewButton.classList.add(\"fa-solid\", icon);\r\n\t\t\tnewButton.dataset.pf2Repost = \"\";\r\n\t\t\tnewButton.title = game.i18n.localize(\"PF2E.Repost\");\r\n\t\t\tlink.appendChild(newButton);\r\n\r\n\t\t\tnewButton.addEventListener(\"click\", (event) => {\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t\tconst target = event.target;\r\n\t\t\t\tif (!(target instanceof HTMLElement)) return;\r\n\t\t\t\tconst parent = target?.parentElement;\r\n\t\t\t\tif (!parent) return;\r\n\r\n\t\t\t\tconst document = resolveDocument(target, foundryDoc);\r\n\t\t\t\tInlineRollLinks.repostAction(parent, document);\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\r\n\tlisten: (html, foundryDoc = resolveDocument(html)) => {\r\n\t\tconst links = htmlQueryAll(html, inlineSelector).filter((l) =>\r\n\t\t\t[\"A\", \"SPAN\"].includes(l.nodeName),\r\n\t\t);\r\n\t\tInlineRollLinks.injectRepostElement(links, foundryDoc);\r\n\r\n\t\tInlineRollLinks.flavorDamageRolls(\r\n\t\t\thtml,\r\n\t\t\tfoundryDoc instanceof Actor ? foundryDoc : null,\r\n\t\t);\r\n\r\n\t\tfor (const link of links.filter((l) => l.dataset.pf2Action)) {\r\n\t\t\tconst { pf2Action, pf2Glyph, pf2Variant, pf2Dc, pf2ShowDc, pf2Skill } =\r\n\t\t\t\tlink.dataset;\r\n\t\t\tlink.addEventListener(\"click\", (event) => {\r\n\t\t\t\tconst slug = sluggify(pf2Action ?? \"\");\r\n\t\t\t\tconst visibility = pf2ShowDc ?? \"all\";\r\n\t\t\t\tconst difficultyClass = Number.isNumeric(pf2Dc)\r\n\t\t\t\t\t? { scope: \"check\", value: Number(pf2Dc) || 0, visibility }\r\n\t\t\t\t\t: pf2Dc;\r\n\t\t\t\tif (slug && game.pf2e.actions.has(slug)) {\r\n\t\t\t\t\tgame.pf2e.actions\r\n\t\t\t\t\t\t.get(slug)\r\n\t\t\t\t\t\t?.use({\r\n\t\t\t\t\t\t\tevent,\r\n\t\t\t\t\t\t\tvariant: pf2Variant,\r\n\t\t\t\t\t\t\tdifficultyClass,\r\n\t\t\t\t\t\t\tstatistic: pf2Skill,\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch((reason) => ui.notifications.warn(reason));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst action =\r\n\t\t\t\t\t\tgame.pf2e.actions[\r\n\t\t\t\t\t\t\tpf2Action ? sluggify(pf2Action, { camel: \"dromedary\" }) : \"\"\r\n\t\t\t\t\t\t];\r\n\t\t\t\t\tif (pf2Action && action) {\r\n\t\t\t\t\t\taction({\r\n\t\t\t\t\t\t\tevent,\r\n\t\t\t\t\t\t\tglyph: pf2Glyph,\r\n\t\t\t\t\t\t\tvariant: pf2Variant,\r\n\t\t\t\t\t\t\tdifficultyClass,\r\n\t\t\t\t\t\t\tskill: pf2Skill,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.warn(\r\n\t\t\t\t\t\t\t`PF2e System | Skip executing unknown action '${pf2Action}'`,\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfor (const link of links.filter(\r\n\t\t\t(l) => l.dataset.pf2Check && !l.dataset.invalid,\r\n\t\t)) {\r\n\t\t\tconst {\r\n\t\t\t\tpf2Check,\r\n\t\t\t\tpf2Dc,\r\n\t\t\t\tpf2Traits,\r\n\t\t\t\tpf2Label,\r\n\t\t\t\tpf2Defense,\r\n\t\t\t\tpf2Adjustment,\r\n\t\t\t\tpf2Roller,\r\n\t\t\t\tpf2RollOptions,\r\n\t\t\t} = link.dataset;\r\n\t\t\tconst overrideTraits = \"overrideTraits\" in link.dataset;\r\n\t\t\tconst targetOwner = \"targetOwner\" in link.dataset;\r\n\r\n\t\t\tif (!pf2Check) return;\r\n\r\n\t\t\tlink.addEventListener(\"click\", async (event) => {\r\n\t\t\t\tconst parent = resolveActor(foundryDoc, link);\r\n\t\t\t\t// const actors = [parent];\r\n\t\t\t\tconst actors = (() => {\r\n\t\t\t\t\tswitch (pf2Roller) {\r\n\t\t\t\t\t\tcase \"self\":\r\n\t\t\t\t\t\t\treturn parent?.canUserModify(game.user, \"update\") ? [parent] : [];\r\n\t\t\t\t\t\tcase \"party\":\r\n\t\t\t\t\t\t\tif (parent?.isOfType(\"party\")) return [parent];\r\n\t\t\t\t\t\t\treturn R.compact([game.actors.party]);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Use the DOM document as a fallback if it's an actor and the check isn't a saving throw\r\n\t\t\t\t\tconst sheetActor = (() => {\r\n\t\t\t\t\t\tconst maybeActor =\r\n\t\t\t\t\t\t\tfoundryDoc instanceof Actor\r\n\t\t\t\t\t\t\t\t? foundryDoc\r\n\t\t\t\t\t\t\t\t: foundryDoc instanceof Item && foundryDoc.actor\r\n\t\t\t\t\t\t\t\t  ? foundryDoc.actor\r\n\t\t\t\t\t\t\t\t  : null;\r\n\t\t\t\t\t\treturn maybeActor?.isOwner && !maybeActor.isOfType(\"loot\", \"party\")\r\n\t\t\t\t\t\t\t? maybeActor\r\n\t\t\t\t\t\t\t: null;\r\n\t\t\t\t\t})();\r\n\t\t\t\t\tconst rollingActors = [\r\n\t\t\t\t\t\tsheetActor ??\r\n\t\t\t\t\t\t\tgetSelectedActors({ exclude: [\"loot\"], assignedFallback: true }),\r\n\t\t\t\t\t].flat();\r\n\r\n\t\t\t\t\tconst isSave = tupleHasValue(SAVE_TYPES, pf2Check);\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tparent?.isOfType(\"party\") ||\r\n\t\t\t\t\t\t(rollingActors.length === 0 && parent && !isSave)\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\treturn [parent];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn rollingActors;\r\n\t\t\t\t})();\r\n\r\n\t\t\t\tif (actors.length === 0) {\r\n\t\t\t\t\tui.notifications.error(\"PF2E.ErrorMessage.NoTokenSelected\", {\r\n\t\t\t\t\t\tlocalize: true,\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst extraRollOptions = [\r\n\t\t\t\t\t...(pf2Traits?.split(\",\").map((o) => o.trim()) ?? []),\r\n\t\t\t\t\t...(pf2RollOptions?.split(\",\").map((o) => o.trim()) ?? []),\r\n\t\t\t\t];\r\n\t\t\t\tconst eventRollParams = eventToRollParams(event, { type: \"check\" });\r\n\t\t\t\tconst checkSlug = link.dataset.slug\r\n\t\t\t\t\t? sluggify(link.dataset.slug)\r\n\t\t\t\t\t: null;\r\n\r\n\t\t\t\tswitch (pf2Check) {\r\n\t\t\t\t\tcase \"flat\": {\r\n\t\t\t\t\t\tfor (const actor of actors) {\r\n\t\t\t\t\t\t\tconst flatCheck = new actor.saves.reflex.constructor(actor, {\r\n\t\t\t\t\t\t\t\tlabel: \"\",\r\n\t\t\t\t\t\t\t\tslug: \"flat\",\r\n\t\t\t\t\t\t\t\tmodifiers: [],\r\n\t\t\t\t\t\t\t\tcheck: { type: \"flat-check\" },\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tconst dc = Number.isInteger(Number(pf2Dc))\r\n\t\t\t\t\t\t\t\t? { label: pf2Label, value: Number(pf2Dc) }\r\n\t\t\t\t\t\t\t\t: null;\r\n\t\t\t\t\t\t\tflatCheck.roll({\r\n\t\t\t\t\t\t\t\t...eventRollParams,\r\n\t\t\t\t\t\t\t\tslug: checkSlug,\r\n\t\t\t\t\t\t\t\textraRollOptions,\r\n\t\t\t\t\t\t\t\tdc,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdefault: {\r\n\t\t\t\t\t\tconst isSavingThrow = tupleHasValue(SAVE_TYPES, pf2Check);\r\n\r\n\t\t\t\t\t\t// Get actual traits for display in chat cards\r\n\t\t\t\t\t\tconst traits = isSavingThrow\r\n\t\t\t\t\t\t\t? []\r\n\t\t\t\t\t\t\t: extraRollOptions.filter((t) => t in CONFIG.PF2E.actionTraits) ??\r\n\t\t\t\t\t\t\t  [];\r\n\r\n\t\t\t\t\t\tfor (const actor of actors) {\r\n\t\t\t\t\t\t\tconst statistic = (() => {\r\n\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\tpf2Check in CONFIG.PF2E.magicTraditions &&\r\n\t\t\t\t\t\t\t\t\tactor.isOfType(\"creature\")\r\n\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\tconst bestSpellcasting =\r\n\t\t\t\t\t\t\t\t\t\tactor.spellcasting\r\n\t\t\t\t\t\t\t\t\t\t\t.filter((c) => c.tradition === pf2Check)\r\n\t\t\t\t\t\t\t\t\t\t\t.flatMap((s) => s.statistic ?? [])\r\n\t\t\t\t\t\t\t\t\t\t\t.sort((a, b) => b.check.mod - a.check.mod)\r\n\t\t\t\t\t\t\t\t\t\t\t.shift() ?? null;\r\n\t\t\t\t\t\t\t\t\tif (bestSpellcasting) return bestSpellcasting;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn actor.getStatistic(pf2Check);\r\n\t\t\t\t\t\t\t})();\r\n\r\n\t\t\t\t\t\t\tif (!statistic) {\r\n\t\t\t\t\t\t\t\tconsole.warn(\r\n\t\t\t\t\t\t\t\t\tErrorPF2e(`Skip rolling unknown statistic ${pf2Check}`)\r\n\t\t\t\t\t\t\t\t\t\t.message,\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tconst targetActor = pf2Defense\r\n\t\t\t\t\t\t\t\t? targetOwner\r\n\t\t\t\t\t\t\t\t\t? parent\r\n\t\t\t\t\t\t\t\t\t: game.user.targets.first()?.actor\r\n\t\t\t\t\t\t\t\t: null;\r\n\r\n\t\t\t\t\t\t\tconst dcValue = (() => {\r\n\t\t\t\t\t\t\t\tconst adjustment = Number(pf2Adjustment) || 0;\r\n\t\t\t\t\t\t\t\tif (pf2Dc === \"@self.level\") {\r\n\t\t\t\t\t\t\t\t\treturn calculateDC(actor.level) + adjustment;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn Number(pf2Dc ?? \"NaN\") + adjustment;\r\n\t\t\t\t\t\t\t})();\r\n\r\n\t\t\t\t\t\t\tconst dc = (() => {\r\n\t\t\t\t\t\t\t\tif (Number.isInteger(dcValue)) {\r\n\t\t\t\t\t\t\t\t\treturn { label: pf2Label, value: dcValue };\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (pf2Defense) {\r\n\t\t\t\t\t\t\t\t\tconst defenseStat = targetActor?.getStatistic(pf2Defense);\r\n\t\t\t\t\t\t\t\t\treturn defenseStat\r\n\t\t\t\t\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\t\t\t\t\tstatistic: defenseStat.dc,\r\n\t\t\t\t\t\t\t\t\t\t\t\tscope: \"check\",\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: defenseStat.dc.value,\r\n\t\t\t\t\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t\t\t\t\t: null;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\t})();\r\n\r\n\t\t\t\t\t\t\t// Retrieve the item if:\r\n\t\t\t\t\t\t\t// (2) The item is an action or,\r\n\t\t\t\t\t\t\t// (1) The check is a saving throw and the item is not a weapon.\r\n\t\t\t\t\t\t\t// Exclude weapons so that roll notes on strikes from incapacitation abilities continue to work.\r\n\t\t\t\t\t\t\tconst item = (() => {\r\n\t\t\t\t\t\t\t\tconst itemFromDoc =\r\n\t\t\t\t\t\t\t\t\tfoundryDoc instanceof Item\r\n\t\t\t\t\t\t\t\t\t\t? foundryDoc\r\n\t\t\t\t\t\t\t\t\t\t: foundryDoc instanceof ChatMessage\r\n\t\t\t\t\t\t\t\t\t\t  ? foundryDoc.item\r\n\t\t\t\t\t\t\t\t\t\t  : null;\r\n\r\n\t\t\t\t\t\t\t\treturn itemFromDoc?.isOfType(\r\n\t\t\t\t\t\t\t\t\t\"action\",\r\n\t\t\t\t\t\t\t\t\t\"feat\",\r\n\t\t\t\t\t\t\t\t\t\"campaignFeature\",\r\n\t\t\t\t\t\t\t\t) ||\r\n\t\t\t\t\t\t\t\t\t(isSavingThrow && !itemFromDoc?.isOfType(\"weapon\"))\r\n\t\t\t\t\t\t\t\t\t? itemFromDoc\r\n\t\t\t\t\t\t\t\t\t: null;\r\n\t\t\t\t\t\t\t})();\r\n\r\n\t\t\t\t\t\t\tconst args = {\r\n\t\t\t\t\t\t\t\t...eventRollParams,\r\n\t\t\t\t\t\t\t\textraRollOptions,\r\n\t\t\t\t\t\t\t\torigin:\r\n\t\t\t\t\t\t\t\t\tisSavingThrow && parent instanceof Actor ? parent : null,\r\n\t\t\t\t\t\t\t\tdc,\r\n\t\t\t\t\t\t\t\ttarget: !isSavingThrow && dc?.statistic ? targetActor : null,\r\n\t\t\t\t\t\t\t\titem,\r\n\t\t\t\t\t\t\t\ttraits,\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\t// Use a special header for checks against defenses\r\n\t\t\t\t\t\t\tconst itemIsEncounterAction =\r\n\t\t\t\t\t\t\t\t!overrideTraits &&\r\n\t\t\t\t\t\t\t\t!!(item?.isOfType(\"action\", \"feat\") && item.actionCost) &&\r\n\t\t\t\t\t\t\t\t![\"flat-check\", \"saving-throw\"].includes(statistic.check.type);\r\n\t\t\t\t\t\t\tif (itemIsEncounterAction) {\r\n\t\t\t\t\t\t\t\tconst subtitleLocKey =\r\n\t\t\t\t\t\t\t\t\tpf2Check in CONFIG.PF2E.magicTraditions\r\n\t\t\t\t\t\t\t\t\t\t? \"PF2E.ActionsCheck.spell\"\r\n\t\t\t\t\t\t\t\t\t\t: statistic.check.type === \"attack-roll\"\r\n\t\t\t\t\t\t\t\t\t\t  ? \"PF2E.ActionsCheck.x-attack-roll\"\r\n\t\t\t\t\t\t\t\t\t\t  : \"PF2E.ActionsCheck.x\";\r\n\t\t\t\t\t\t\t\targs.label = await renderTemplate(\r\n\t\t\t\t\t\t\t\t\t\"systems/pf2e/templates/chat/action/header.hbs\",\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tglyph: getActionGlyph(item.actionCost),\r\n\t\t\t\t\t\t\t\t\t\tsubtitle: game.i18n.format(subtitleLocKey, {\r\n\t\t\t\t\t\t\t\t\t\t\ttype: statistic.label,\r\n\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\ttitle: item.name,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\textraRollOptions.push(...createActionOptions(item));\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tstatistic.roll(args);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst templateConversion = {\r\n\t\t\tburst: \"circle\",\r\n\t\t\tcone: \"cone\",\r\n\t\t\tcube: \"rect\",\r\n\t\t\temanation: \"circle\",\r\n\t\t\tline: \"ray\",\r\n\t\t\trect: \"rect\",\r\n\t\t\tsquare: \"rect\",\r\n\t\t};\r\n\r\n\t\tfor (const link of links.filter((l) =>\r\n\t\t\tl.hasAttribute(\"data-pf2-effect-area\"),\r\n\t\t)) {\r\n\t\t\tconst {\r\n\t\t\t\tpf2EffectArea,\r\n\t\t\t\tpf2Distance,\r\n\t\t\t\tpf2TemplateData,\r\n\t\t\t\tpf2Traits,\r\n\t\t\t\tpf2Width,\r\n\t\t\t} = link.dataset;\r\n\t\t\tlink.addEventListener(\"click\", () => {\r\n\t\t\t\tif (!canvas.ready) return;\r\n\r\n\t\t\t\tif (typeof pf2EffectArea !== \"string\") {\r\n\t\t\t\t\tconsole.warn(`PF2e System | Could not create template'`);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst data = JSON.parse(pf2TemplateData ?? \"{}\");\r\n\t\t\t\tdata.distance ||= Number(pf2Distance);\r\n\t\t\t\tdata.fillColor ||= game.user.color;\r\n\t\t\t\tdata.t = templateConversion[pf2EffectArea];\r\n\r\n\t\t\t\tswitch (data.t) {\r\n\t\t\t\t\tcase \"ray\":\r\n\t\t\t\t\t\tdata.width =\r\n\t\t\t\t\t\t\tNumber(pf2Width) ||\r\n\t\t\t\t\t\t\tCONFIG.MeasuredTemplate.defaults.width *\r\n\t\t\t\t\t\t\t\tcanvas.dimensions.distance;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"cone\":\r\n\t\t\t\t\t\tdata.angle ||= CONFIG.MeasuredTemplate.defaults.angle;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"rect\": {\r\n\t\t\t\t\t\tconst distance = data.distance ?? 0;\r\n\t\t\t\t\t\tdata.distance = Math.hypot(distance, distance);\r\n\t\t\t\t\t\tdata.width = distance;\r\n\t\t\t\t\t\tdata.direction = 45;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst flags = {\r\n\t\t\t\t\tpf2e: {},\r\n\t\t\t\t};\r\n\r\n\t\t\t\tconst normalSize = (Math.ceil(data.distance) / 5) * 5 || 5;\r\n\t\t\t\tif (\r\n\t\t\t\t\ttupleHasValue(EFFECT_AREA_SHAPES, pf2EffectArea) &&\r\n\t\t\t\t\tdata.distance === normalSize\r\n\t\t\t\t) {\r\n\t\t\t\t\tflags.pf2e.areaShape = pf2EffectArea;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst messageId =\r\n\t\t\t\t\tfoundryDoc instanceof ChatMessage\r\n\t\t\t\t\t\t? foundryDoc.id\r\n\t\t\t\t\t\t: htmlClosest(html, \"[data-message-id]\")?.dataset.messageId ?? null;\r\n\t\t\t\tif (messageId) {\r\n\t\t\t\t\tflags.pf2e.messageId = messageId;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst actor = resolveActor(foundryDoc, link);\r\n\t\t\t\tif (actor || pf2Traits) {\r\n\t\t\t\t\tconst origin = {};\r\n\t\t\t\t\tif (actor) {\r\n\t\t\t\t\t\torigin.actor = actor.uuid;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (pf2Traits) {\r\n\t\t\t\t\t\torigin.traits = pf2Traits.split(\",\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tflags.pf2e.origin = origin;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!R.isEmpty(flags.pf2e)) {\r\n\t\t\t\t\tdata.flags = flags;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcanvas.templates.createPreview(data);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfor (const link of html.querySelectorAll(\"a[data-damage-roll]\")) {\r\n\t\t\tlink.dataset.itemUuid = foundryDoc.uuid;\r\n\t\t}\r\n\t},\r\n\r\n\tmakeRepostHtml: (target, defaultVisibility) => {\r\n\t\tconst flavor = game.i18n.localize(target.dataset.pf2RepostFlavor ?? \"\");\r\n\t\tconst showDC = target.dataset.pf2ShowDc ?? defaultVisibility;\r\n\t\treturn `<span data-visibility=\"${showDC}\">${flavor}</span> ${target.outerHTML}`.trim();\r\n\t},\r\n\r\n\trepostAction: async (target, foundryDoc = null) => {\r\n\t\tif (\r\n\t\t\t![\"pf2Action\", \"pf2Check\", \"pf2EffectArea\"].some(\r\n\t\t\t\t(d) => d in target.dataset,\r\n\t\t\t)\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst actor = resolveActor(foundryDoc, target);\r\n\t\tconst defaultVisibility = (actor ?? foundryDoc)?.hasPlayerOwner\r\n\t\t\t? \"all\"\r\n\t\t\t: \"gm\";\r\n\t\tconst content = (() => {\r\n\t\t\tif (target.parentElement?.dataset?.pf2Checkgroup !== undefined) {\r\n\t\t\t\tconst content = htmlQueryAll(target.parentElement, inlineSelector)\r\n\t\t\t\t\t.map((target) =>\r\n\t\t\t\t\t\tInlineRollLinks.makeRepostHtml(target, defaultVisibility),\r\n\t\t\t\t\t)\r\n\t\t\t\t\t.join(\"<br>\");\r\n\r\n\t\t\t\treturn `<div data-pf2-checkgroup>${content}</div>`;\r\n\t\t\t}\r\n\r\n\t\t\treturn InlineRollLinks.makeRepostHtml(target, defaultVisibility);\r\n\t\t})();\r\n\r\n\t\tconst ChatMessagePF2e = ChatMessage.implementation;\r\n\t\tconst speaker = actor\r\n\t\t\t? ChatMessagePF2e.getSpeaker({\r\n\t\t\t\t\tactor,\r\n\t\t\t\t\ttoken: actor.getActiveTokens(true, true).shift(),\r\n\t\t\t  })\r\n\t\t\t: ChatMessagePF2e.getSpeaker();\r\n\r\n\t\t// If the originating document is a journal entry, include its UUID as a flag. If a chat message, copy over\r\n\t\t// the origin flag.\r\n\t\tconst message = game.messages.get(\r\n\t\t\thtmlClosest(target, \"[data-message-id]\")?.dataset.messageId ?? \"\",\r\n\t\t);\r\n\t\tconst flags =\r\n\t\t\tfoundryDoc instanceof JournalEntry\r\n\t\t\t\t? { pf2e: { journalEntry: foundryDoc.uuid } }\r\n\t\t\t\t: message?.flags.pf2e.origin\r\n\t\t\t\t  ? { pf2e: { origin: fu.deepClone(message.flags.pf2e.origin) } }\r\n\t\t\t\t  : {};\r\n\r\n\t\treturn ChatMessagePF2e.create({ speaker, content, flags });\r\n\t},\r\n\r\n\t/** Give inline damage-roll links from items flavor text of the item name */\r\n\tflavorDamageRolls(html, actor = null) {\r\n\t\tfor (const rollLink of htmlQueryAll(\r\n\t\t\thtml,\r\n\t\t\t\"a.inline-roll[data-damage-roll]\",\r\n\t\t)) {\r\n\t\t\tconst itemId = htmlClosest(rollLink, \"[data-item-id]\")?.dataset.itemId;\r\n\t\t\tconst item = actor?.items.get(itemId ?? \"\");\r\n\t\t\tif (item) rollLink.dataset.flavor ||= item.name;\r\n\t\t}\r\n\t},\r\n};\r\n\r\n/** If the provided document exists returns it, otherwise attempt to derive it from the sheet */\r\nfunction resolveDocument(html, foundryDoc) {\r\n\tif (foundryDoc) return foundryDoc;\r\n\r\n\tconst sheet =\r\n\t\tui.windows[Number(html.closest(\".app.sheet\")?.dataset.appid)] ?? null;\r\n\r\n\tconst document = sheet?.document;\r\n\treturn document instanceof Actor || document instanceof JournalEntry\r\n\t\t? document\r\n\t\t: null;\r\n}\r\n\r\n/** Retrieve an actor via a passed document or item UUID in the dataset of a link */\r\nfunction resolveActor(foundryDoc, anchor) {\r\n\tif (foundryDoc instanceof Actor) return foundryDoc;\r\n\tif (foundryDoc instanceof Item || foundryDoc instanceof ChatMessage)\r\n\t\treturn foundryDoc.actor;\r\n\r\n\t// Retrieve item/actor from anywhere via UUID\r\n\tconst itemUuid = anchor.dataset.itemUuid;\r\n\tconst itemByUUID =\r\n\t\titemUuid && !itemUuid.startsWith(\"Compendium.\")\r\n\t\t\t? fromUuidSync(itemUuid)\r\n\t\t\t: null;\r\n\treturn itemByUUID instanceof Item ? itemByUUID.actor : null;\r\n}\r\n\r\n/** Create roll options with information about the action being used */\r\nfunction createActionOptions(item, extra = []) {\r\n\tif (!item?.isOfType(\"action\", \"feat\") || !item.actionCost) return [];\r\n\r\n\tconst slug = item.slug ?? sluggify(item.name);\r\n\tconst traits = R.uniq(\r\n\t\t[\r\n\t\t\titem.system.traits.value,\r\n\t\t\textra.filter((t) => t in CONFIG.PF2E.actionTraits),\r\n\t\t].flat(),\r\n\t);\r\n\tconst actionCost = item.actionCost.value;\r\n\r\n\treturn R.compact([\r\n\t\t`action:${slug}`,\r\n\t\t`action:cost:${actionCost}`,\r\n\t\t`self:action:slug:${slug}`,\r\n\t\t`self:action:cost:${actionCost}`,\r\n\t\t...traits.map((t) => `self:action:trait:${t}`),\r\n\t]);\r\n}\r\n", "import { createHTMLElement, htmlClosest } from \"./html\";\r\nimport { ErrorPF2e, localizer, setHasElement, sluggify } from \"./misc\";\r\nimport { eventToRollMode } from \"./scripts\";\r\n\r\nexport const HANDWRAPS_SLUG = \"handwraps-of-mighty-blows\";\r\n\r\n/**\r\n * @param {object} item\r\n * @returns {boolean}\r\n */\r\nexport function canBeInvested(item) {\r\n\treturn item.traits.has(\"invested\");\r\n}\r\n\r\n/**\r\n * @param {object} item\r\n * @returns {boolean}\r\n */\r\nexport function hasWornSlot(item) {\r\n\treturn item.system.equipped.inSlot != null;\r\n}\r\n\r\n/**\r\n * @param {object} item\r\n * @returns {boolean}\r\n */\r\nfunction isWornAs(item) {\r\n\treturn item.system.usage.type === \"worn\" && item.system.equipped.inSlot;\r\n}\r\n\r\n/**\r\n * @param {object} item\r\n * @returns {boolean}\r\n */\r\nexport function isInvestedOrWornAs(item) {\r\n\treturn item.isInvested || isWornAs(item);\r\n}\r\n\r\n/**\r\n * @param {object} item\r\n * @returns {boolean}\r\n */\r\nexport function isHeld(item) {\r\n\treturn item.system.usage.type === \"held\";\r\n}\r\n\r\n/**\r\n * @param {object} item\r\n * @returns {boolean}\r\n */\r\nexport function isTwoHanded(item) {\r\n\treturn isHeld(item) && item.system.usage.value === \"held-in-two-hands\";\r\n}\r\n\r\n/**\r\n * @param {object} item\r\n * @returns {boolean}\r\n */\r\nexport function isOneHanded(item) {\r\n\treturn isHeld(item) && item.system.usage.value === \"held-in-one-hand\";\r\n}\r\n\r\n/**\r\n * @tempate T\r\n * @param {object} item\r\n * @param {T} value\r\n * @returns {T|undefined}\r\n */\r\nfunction inSlotValue(item, value) {\r\n\tconst usage = item.system.usage;\r\n\treturn usage.type === \"worn\" && usage.where ? value : undefined;\r\n}\r\n\r\n/**\r\n * @param {object} item\r\n * @param {boolean} [invest]\r\n * @returns {boolean|undefined}\r\n */\r\nfunction toggleInvestedValue(item, invest) {\r\n\tconst value = invest ?? !item.system.equipped.invested;\r\n\treturn item.traits.has(\"invested\") ? value : undefined;\r\n}\r\n\r\n/**\r\n * @param {object} item\r\n * @param {object} options\r\n * @param {string} [options.carryType]\r\n * @param {number} [options.handsHeld]\r\n * @param {boolean} [options.inSlot]\r\n * @param {boolean} [options.invested]\r\n * @param {string|null} [options.containerId]\r\n * @returns {object}\r\n */\r\nexport function itemCarryUpdate(\r\n\titem,\r\n\t{ carryType = \"worn\", handsHeld = 0, inSlot, invested, containerId },\r\n) {\r\n\tconst update = {\r\n\t\t_id: item.id,\r\n\t\tsystem: {\r\n\t\t\tequipped: {\r\n\t\t\t\tcarryType: carryType,\r\n\t\t\t\thandsHeld: handsHeld,\r\n\t\t\t\tinSlot: inSlotValue(item, inSlot),\r\n\t\t\t\tinvested: toggleInvestedValue(item, invested),\r\n\t\t\t},\r\n\t\t},\r\n\t};\r\n\r\n\tif (containerId !== undefined) {\r\n\t\tupdate.system.containerId = containerId;\r\n\t}\r\n\r\n\treturn update;\r\n}\r\n\r\n/**\r\n * @param {object} item\r\n * @returns {boolean}\r\n */\r\nexport function isHandwrapsOfMightyBlows(item) {\r\n\treturn (\r\n\t\titem.isOfType(\"weapon\") &&\r\n\t\titem.slug === HANDWRAPS_SLUG &&\r\n\t\titem.category === \"unarmed\"\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {Item} item\r\n * @param {number} [quantity]\r\n * @returns {Coins}\r\n */\r\nexport function calculateItemPrice(item, quantity = 1, ratio = 1) {\r\n\tconst coins = game.pf2e.Coins.fromPrice(item.price, quantity);\r\n\tif (ratio === 1) return coins;\r\n\treturn coins.scale(ratio);\r\n}\r\n\r\n/**\r\n * @param {Actor} target\r\n * @param {Item} item\r\n * @param {number} quantity\r\n * @param {string} [containerId]\r\n * @param {boolean} [newStack]\r\n * @returns {Promise<Item>}\r\n */\r\nexport async function transferItemToActor(\r\n\ttarget,\r\n\titem,\r\n\tquantity,\r\n\tcontainerId,\r\n\tnewStack,\r\n) {\r\n\tconst itemQuantity = Math.min(quantity, item.quantity);\r\n\tconst newQuantity = item.quantity - itemQuantity;\r\n\r\n\tif (newQuantity < 1) {\r\n\t\tawait item.delete();\r\n\t} else {\r\n\t\tawait item.update({ \"system.quantity\": newQuantity });\r\n\t}\r\n\r\n\tconst newItemData = item.toObject();\r\n\tnewItemData.system.quantity = itemQuantity;\r\n\tnewItemData.system.equipped.carryType = \"worn\";\r\n\tif (\"invested\" in newItemData.system.equipped) {\r\n\t\tnewItemData.system.equipped.invested = item.traits.has(\"invested\")\r\n\t\t\t? false\r\n\t\t\t: null;\r\n\t}\r\n\r\n\treturn target.addToInventory(newItemData, containerId, newStack);\r\n}\r\n\r\nexport class MoveLootPopup extends FormApplication {\r\n\t/**\r\n\t * @param {Actor} object\r\n\t * @param {object} options\r\n\t * @param {{default: number, max: number}} options.quantity\r\n\t * @param {boolean} options.newStack\r\n\t * @param {boolean} options.lockStack\r\n\t * @param {boolean} options.isPurchase\r\n\t * @param {(quantity: number, newStack: boolean) => void} callback\r\n\t */\r\n\tconstructor(object, options, callback) {\r\n\t\tsuper(object, options);\r\n\t\tthis.onSubmitCallback = callback;\r\n\t}\r\n\r\n\tasync getData() {\r\n\t\tconst [prompt, buttonLabel] = this.options.isPurchase\r\n\t\t\t? [\"PF2E.loot.PurchaseLootMessage\", \"PF2E.loot.PurchaseLoot\"]\r\n\t\t\t: [\"PF2E.loot.MoveLootMessage\", \"PF2E.loot.MoveLoot\"];\r\n\r\n\t\treturn {\r\n\t\t\t...(await super.getData()),\r\n\t\t\tquantity: {\r\n\t\t\t\tdefault: this.options.quantity.default,\r\n\t\t\t\tmax: this.options.quantity.max,\r\n\t\t\t},\r\n\t\t\tnewStack: this.options.newStack,\r\n\t\t\tlockStack: this.options.lockStack,\r\n\t\t\tprompt,\r\n\t\t\tbuttonLabel,\r\n\t\t};\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn {\r\n\t\t\t...FormApplication.defaultOptions,\r\n\t\t\tid: \"MoveLootPopup\",\r\n\t\t\tclasses: [],\r\n\t\t\ttitle: game.i18n.localize(\"PF2E.loot.MoveLootPopupTitle\"),\r\n\t\t\ttemplate: \"systems/pf2e/templates/popups/loot/move-loot-popup.hbs\",\r\n\t\t\twidth: \"auto\",\r\n\t\t\tquantity: {\r\n\t\t\t\tdefault: 1,\r\n\t\t\t\tmax: 1,\r\n\t\t\t},\r\n\t\t\tnewStack: false,\r\n\t\t\tlockStack: false,\r\n\t\t\tisPurchase: false,\r\n\t\t};\r\n\t}\r\n\r\n\tasync _updateObject(_event, formData) {\r\n\t\tthis.onSubmitCallback(formData.quantity, formData.newStack);\r\n\t}\r\n}\r\n\r\nexport async function detachSubitem(subitem, skipConfirm) {\r\n\tconst parentItem = subitem.parentItem;\r\n\tif (!parentItem) throw ErrorPF2e(\"Subitem has no parent item\");\r\n\r\n\tconst localize = localizer(\"PF2E.Item.Physical.Attach.Detach\");\r\n\tconst confirmed =\r\n\t\tskipConfirm ||\r\n\t\t(await Dialog.confirm({\r\n\t\t\ttitle: localize(\"Label\"),\r\n\t\t\tcontent: createHTMLElement(\"p\", {\r\n\t\t\t\tchildren: [localize(\"Prompt\", { attachable: subitem.name })],\r\n\t\t\t}).outerHTML,\r\n\t\t}));\r\n\tif (!confirmed) return;\r\n\r\n\tconst deletePromise = subitem.delete();\r\n\tconst createPromise = (async () => {\r\n\t\t// Find a stack match, cloning the subitem as worn so the search won't fail due to it being equipped\r\n\t\tconst stack = subitem.isOfType(\"consumable\")\r\n\t\t\t? parentItem.actor?.inventory.findStackableItem(\r\n\t\t\t\t\tsubitem.clone({ \"system.equipped.carryType\": \"worn\" }),\r\n\t\t\t  )\r\n\t\t\t: null;\r\n\t\tconst keepId =\r\n\t\t\t!!parentItem.actor && !parentItem.actor.items.has(subitem.id);\r\n\t\treturn (\r\n\t\t\tstack?.update({ \"system.quantity\": stack.quantity + 1 }) ??\r\n\t\t\tItem.implementation.create(\r\n\t\t\t\tmergeObject(subitem.toObject(), {\r\n\t\t\t\t\t\"system.containerId\": parentItem.system.containerId,\r\n\t\t\t\t}),\r\n\t\t\t\t{ parent: parentItem.actor, keepId },\r\n\t\t\t)\r\n\t\t);\r\n\t})();\r\n\r\n\tawait Promise.all([deletePromise, createPromise]);\r\n}\r\n\r\nexport async function unownedItemToMessage(event, item, actor, options = {}) {\r\n\tconst ChatMessagePF2e = ChatMessage.implementation;\r\n\r\n\t// Basic template rendering data\r\n\tconst type = sluggify(item.type);\r\n\tconst template = `systems/pf2e/templates/chat/${type}-card.hbs`;\r\n\tconst token = actor.token;\r\n\tconst nearestItem = htmlClosest(event?.target, \".item\");\r\n\tconst rollOptions = options.data ?? { ...(nearestItem?.dataset ?? {}) };\r\n\tconst templateData = {\r\n\t\tactor: actor,\r\n\t\ttokenId: token ? `${token.parent?.id}.${token.id}` : null,\r\n\t\titem: item,\r\n\t\tdata: await item.getChatData(undefined, rollOptions),\r\n\t};\r\n\r\n\t// Basic chat message data\r\n\tconst originalEvent =\r\n\t\tevent instanceof MouseEvent ? event : event?.originalEvent;\r\n\tconst rollMode = options.rollMode ?? eventToRollMode(originalEvent);\r\n\tconst chatData = ChatMessagePF2e.applyRollMode(\r\n\t\t{\r\n\t\t\ttype: CONST.CHAT_MESSAGE_TYPES.OTHER,\r\n\t\t\tspeaker: ChatMessagePF2e.getSpeaker({\r\n\t\t\t\tactor: actor,\r\n\t\t\t\ttoken: actor.getActiveTokens(false, true).at(0),\r\n\t\t\t}),\r\n\t\t\tcontent: await renderTemplate(template, templateData),\r\n\t\t\tflags: { pf2e: { origin: item.getOriginData() } },\r\n\t\t},\r\n\t\trollMode,\r\n\t);\r\n\r\n\t// Create the chat message\r\n\treturn options.create ?? true\r\n\t\t? ChatMessagePF2e.create(chatData, { rollMode, renderSheet: false })\r\n\t\t: new ChatMessagePF2e(chatData, { rollMode });\r\n}\r\n\r\n/**\r\n * @param {ItemOrSource} item\r\n * @param  {...any: string[]} types\r\n * @returns {boolean}\r\n */\r\nexport function itemIsOfType(item, ...types) {\r\n\treturn (\r\n\t\ttypeof item.name === \"string\" &&\r\n\t\ttypes.some((t) =>\r\n\t\t\tt === \"physical\"\r\n\t\t\t\t? setHasElement(PHYSICAL_ITEM_TYPES, item.type)\r\n\t\t\t\t: item.type === t,\r\n\t\t)\r\n\t);\r\n}\r\n", "import * as R from \"remeda\";\r\nimport { calculateDC } from \"./dc\";\r\nimport { ErrorPF2e, setHasElement } from \"./misc\";\r\nimport { MAGIC_TRADITIONS, traditionSkills } from \"./spell\";\r\nimport { isInstanceOf } from \"../utils\";\r\n\r\n/**\r\n * @typedef {\"scroll\" | \"wand\" | \"cantripDeck5\"} SpellConsumableItemType\r\n */\r\n\r\nconst CANTRIP_DECK_ID = \"tLa4bewBhyqzi6Ow\";\r\n\r\nconst scrollCompendiumIds = {\r\n\t1: \"RjuupS9xyXDLgyIr\",\r\n\t2: \"Y7UD64foDbDMV9sx\",\r\n\t3: \"ZmefGBXGJF3CFDbn\",\r\n\t4: \"QSQZJ5BC3DeHv153\",\r\n\t5: \"tjLvRWklAylFhBHQ\",\r\n\t6: \"4sGIy77COooxhQuC\",\r\n\t7: \"fomEZZ4MxVVK3uVu\",\r\n\t8: \"iPki3yuoucnj7bIt\",\r\n\t9: \"cFHomF3tty8Wi1e5\",\r\n\t10: \"o1XIHJ4MJyroAHfF\",\r\n};\r\n\r\nconst SPELL_CONSUMABLE_ITEM_TYPE = new Set([\"cantripDeck5\", \"scroll\", \"wand\"]);\r\nconst SPELL_CONSUMABLE_NAME_TEMPLATES = {\r\n\tcantripDeck5: \"PF2E.Item.Physical.FromSpell.CantripDeck5\",\r\n\tscroll: \"PF2E.Item.Physical.FromSpell.Scroll\",\r\n\twand: \"PF2E.Item.Physical.FromSpell.Wand\",\r\n};\r\n\r\nconst wandCompendiumIds = {\r\n\t1: \"UJWiN0K3jqVjxvKk\",\r\n\t2: \"vJZ49cgi8szuQXAD\",\r\n\t3: \"wrDmWkGxmwzYtfiA\",\r\n\t4: \"Sn7v9SsbEDMUIwrO\",\r\n\t5: \"5BF7zMnrPYzyigCs\",\r\n\t6: \"kiXh4SUWKr166ZeM\",\r\n\t7: \"nmXPj9zuMRQBNT60\",\r\n\t8: \"Qs8RgNH6thRPv2jt\",\r\n\t9: \"Fgv722039TVM5JTc\",\r\n};\r\n\r\n/**\r\n * @param {Item} item\r\n * @param {object} [options]\r\n * @param {boolean} [options.pwol]\r\n * @returns {number}\r\n */\r\nexport function calculateTrickMagicItemCheckDC(\r\n\titem,\r\n\toptions = { pwol: false },\r\n) {\r\n\tconst level = Number(item.level);\r\n\tconst saveDC = calculateDC(level, options);\r\n\r\n\tconst traditions = item.system.spell?.system.traits.traditions ?? [];\r\n\tconst skills = [...item.system.traits.value, ...traditions]\r\n\t\t.filter((t) => setHasElement(MAGIC_TRADITIONS, t))\r\n\t\t.map((tradition) => [traditionSkills[tradition], saveDC]);\r\n\r\n\treturn Object.fromEntries(skills);\r\n}\r\n\r\n/**\r\n * @param {SpellPF2e} spell\r\n * @param {object} options\r\n * @param {SpellConsumableItemType} options.type\r\n * @param {number} [options.heightenedLevel]\r\n * @param {boolean} [options.mystified]\r\n * @param {boolean} [options.temp]\r\n * @param {string} [options.itemImg]\r\n * @param {string} [options.itemName]\r\n * @returns {Promise<ConsumableSource>}\r\n */\r\nexport async function createConsumableFromSpell(\r\n\tspell,\r\n\t{\r\n\t\ttype,\r\n\t\theightenedLevel = spell.baseRank,\r\n\t\tmystified = false,\r\n\t\ttemp = false,\r\n\t\titemImg,\r\n\t\titemName = type,\r\n\t},\r\n) {\r\n\tconst pack = game.packs.find((p) => p.collection === \"pf2e.equipment-srd\");\r\n\tconst itemId = getIdForSpellConsumable(type, heightenedLevel);\r\n\tconst consumable = await pack?.getDocument(itemId ?? \"\");\r\n\tif (!isInstanceOf(consumable, \"ConsumablePF2e\")) {\r\n\t\tthrow ErrorPF2e(\"Failed to retrieve consumable item\");\r\n\t}\r\n\r\n\tconst consumableSource = { ...consumable.toObject(), _id: null }; // Clear _id\r\n\r\n\tconst { traits } = consumableSource.system;\r\n\ttraits.value = R.uniq([...traits.value, ...spell.traits]);\r\n\ttraits.rarity = spell.rarity;\r\n\tif (\r\n\t\ttraits.value.includes(\"magical\") &&\r\n\t\ttraits.value.some((t) => setHasElement(MAGIC_TRADITIONS, t))\r\n\t) {\r\n\t\ttraits.value.splice(traits.value.indexOf(\"magical\"), 1);\r\n\t}\r\n\ttraits.value.sort();\r\n\r\n\tconsumableSource.name = getNameForSpellConsumable(\r\n\t\titemName,\r\n\t\tspell.name,\r\n\t\theightenedLevel,\r\n\t);\r\n\tconst description = consumableSource.system.description.value;\r\n\r\n\tconsumableSource.system.description.value = (() => {\r\n\t\tconst paragraphElement = document.createElement(\"p\");\r\n\t\tparagraphElement.append(\r\n\t\t\tspell.sourceId\r\n\t\t\t\t? `@UUID[${spell.sourceId}]{${spell.name}}`\r\n\t\t\t\t: spell.description,\r\n\t\t);\r\n\r\n\t\tconst containerElement = document.createElement(\"div\");\r\n\t\tconst hrElement = document.createElement(\"hr\");\r\n\t\tcontainerElement.append(paragraphElement, hrElement);\r\n\t\thrElement.insertAdjacentHTML(\"afterend\", description);\r\n\r\n\t\treturn containerElement.innerHTML;\r\n\t})();\r\n\r\n\t// Cantrip deck casts at level 1\r\n\tif (type !== \"cantripDeck5\") {\r\n\t\tconsumableSource.system.spell = spell\r\n\t\t\t.clone(\r\n\t\t\t\t{\r\n\t\t\t\t\t_id: randomID(),\r\n\t\t\t\t\t\"system.location.heightenedLevel\": heightenedLevel,\r\n\t\t\t\t},\r\n\t\t\t\t{ keepId: true },\r\n\t\t\t)\r\n\t\t\t.toObject();\r\n\t}\r\n\r\n\tif (mystified) {\r\n\t\tconsumableSource.system.identification.status = \"unidentified\";\r\n\t}\r\n\r\n\tif (typeof itemImg === \"string\") {\r\n\t\tconsumableSource.img = itemImg;\r\n\t}\r\n\r\n\tif (temp) {\r\n\t\tconsumableSource.system.temporary = true;\r\n\t}\r\n\r\n\treturn consumableSource;\r\n}\r\n\r\n/**\r\n *\r\n * @param {SpellConsumableItemType} type\r\n * @param {number} heightenedLevel\r\n * @returns {string | null}\r\n */\r\nexport function getIdForSpellConsumable(type, heightenedLevel) {\r\n\tswitch (type) {\r\n\t\tcase \"cantripDeck5\":\r\n\t\t\treturn CANTRIP_DECK_ID;\r\n\t\tcase \"scroll\":\r\n\t\t\treturn scrollCompendiumIds[heightenedLevel] ?? null;\r\n\t\tdefault:\r\n\t\t\treturn wandCompendiumIds[heightenedLevel] ?? null;\r\n\t}\r\n}\r\n\r\n/**\r\n *\r\n * @param {SpellConsumableItemType} type\r\n * @param {string} spellName\r\n * @param {number} heightenedLevel\r\n * @returns {string}\r\n */\r\nexport function getNameForSpellConsumable(type, spellName, heightenedLevel) {\r\n\tconst templateId =\r\n\t\tSPELL_CONSUMABLE_NAME_TEMPLATES[type] ||\r\n\t\t`${type} of {name} (Level {level})`;\r\n\treturn game.i18n.format(templateId, {\r\n\t\tname: spellName,\r\n\t\tlevel: heightenedLevel,\r\n\t});\r\n}\r\n", "export const DEGREE_OF_SUCCESS = {\r\n\tCRITICAL_SUCCESS: 3,\r\n\tSUCCESS: 2,\r\n\tFAILURE: 1,\r\n\tCRITICAL_FAILURE: 0,\r\n};\r\n\r\nexport const DEGREE_ADJUSTMENT_AMOUNTS = {\r\n\tLOWER_BY_TWO: -2,\r\n\tLOWER: -1,\r\n\tINCREASE: 1,\r\n\tINCREASE_BY_TWO: 2,\r\n\tTO_CRITICAL_FAILURE: \"criticalFailure\",\r\n\tTO_FAILURE: \"failure\",\r\n\tTO_SUCCESS: \"success\",\r\n\tTO_CRITICAL_SUCCESS: \"criticalSuccess\",\r\n};\r\n\r\nexport const DEGREE_OF_SUCCESS_STRINGS = [\r\n\t\"criticalFailure\",\r\n\t\"failure\",\r\n\t\"success\",\r\n\t\"criticalSuccess\",\r\n];\r\n\r\n/**\r\n * @class\r\n * @constructor\r\n */\r\nexport class DegreeOfSuccess {\r\n\t/**\r\n\t * @param {{dieResult: number, rollTotal: number}} roll\r\n\t * @param {number|{value: number}} dc\r\n\t * @param {object|null} [dosAdjustments]\r\n\t */\r\n\tconstructor(roll, dc, dosAdjustments = null) {\r\n\t\tif (roll instanceof Roll) {\r\n\t\t\tthis.dieResult =\r\n\t\t\t\t(roll.isDeterministic\r\n\t\t\t\t\t? roll.terms.find((t) => t instanceof NumericTerm)\r\n\t\t\t\t\t: roll.dice.find((d) => d instanceof Die && d.faces === 20)\r\n\t\t\t\t)?.total ?? 1;\r\n\t\t\tthis.rollTotal = roll.total;\r\n\t\t} else {\r\n\t\t\tthis.dieResult = roll.dieValue;\r\n\t\t\tthis.rollTotal = roll.dieValue + roll.modifier;\r\n\t\t}\r\n\r\n\t\tthis.dc = typeof dc === \"number\" ? { value: dc } : dc;\r\n\r\n\t\tthis.unadjusted = this.#calculateDegreeOfSuccess();\r\n\t\tthis.adjustment = this.#getDegreeAdjustment(\r\n\t\t\tthis.unadjusted,\r\n\t\t\tdosAdjustments,\r\n\t\t);\r\n\t\t/**\r\n\t\t * @type {0|1|2|3}\r\n\t\t */\r\n\t\tthis.value = this.adjustment\r\n\t\t\t? this.#adjustDegreeOfSuccess(this.adjustment.amount, this.unadjusted)\r\n\t\t\t: this.unadjusted;\r\n\t}\r\n\r\n\tstatic CRITICAL_FAILURE = 0;\r\n\tstatic FAILURE = 1;\r\n\tstatic SUCCESS = 2;\r\n\tstatic CRITICAL_SUCCESS = 3;\r\n\r\n\t#getDegreeAdjustment(degree, adjustments) {\r\n\t\tif (!adjustments) return null;\r\n\r\n\t\tfor (const outcome of [\"all\", ...DEGREE_OF_SUCCESS_STRINGS]) {\r\n\t\t\tconst { label, amount } = adjustments[outcome] ?? {};\r\n\t\t\tif (\r\n\t\t\t\tamount &&\r\n\t\t\t\tlabel &&\r\n\t\t\t\t!(\r\n\t\t\t\t\tdegree === DegreeOfSuccess.CRITICAL_SUCCESS &&\r\n\t\t\t\t\tamount === DEGREE_ADJUSTMENT_AMOUNTS.INCREASE\r\n\t\t\t\t) &&\r\n\t\t\t\t!(\r\n\t\t\t\t\tdegree === DegreeOfSuccess.CRITICAL_FAILURE &&\r\n\t\t\t\t\tamount === DEGREE_ADJUSTMENT_AMOUNTS.LOWER\r\n\t\t\t\t) &&\r\n\t\t\t\t(outcome === \"all\" ||\r\n\t\t\t\t\tDEGREE_OF_SUCCESS_STRINGS.indexOf(outcome) === degree)\r\n\t\t\t) {\r\n\t\t\t\treturn { label, amount };\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t#adjustDegreeOfSuccess(amount, degreeOfSuccess) {\r\n\t\tswitch (amount) {\r\n\t\t\tcase \"criticalFailure\":\r\n\t\t\t\treturn 0;\r\n\t\t\tcase \"failure\":\r\n\t\t\t\treturn 1;\r\n\t\t\tcase \"success\":\r\n\t\t\t\treturn 2;\r\n\t\t\tcase \"criticalSuccess\":\r\n\t\t\t\treturn 3;\r\n\t\t\tdefault:\r\n\t\t\t\treturn Math.clamped(degreeOfSuccess + amount, 0, 3);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param degree The current success value\r\n\t * @return The new success value\r\n\t */\r\n\t#adjustDegreeByDieValue(degree) {\r\n\t\tif (this.dieResult === 20) {\r\n\t\t\treturn this.#adjustDegreeOfSuccess(\r\n\t\t\t\tDEGREE_ADJUSTMENT_AMOUNTS.INCREASE,\r\n\t\t\t\tdegree,\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tif (this.dieResult === 1) {\r\n\t\t\treturn this.#adjustDegreeOfSuccess(\r\n\t\t\t\tDEGREE_ADJUSTMENT_AMOUNTS.LOWER,\r\n\t\t\t\tdegree,\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn degree;\r\n\t}\r\n\r\n\t#calculateDegreeOfSuccess() {\r\n\t\tconst dc = this.dc.value;\r\n\r\n\t\tif (this.rollTotal - dc >= 10) {\r\n\t\t\treturn this.#adjustDegreeByDieValue(DegreeOfSuccess.CRITICAL_SUCCESS);\r\n\t\t}\r\n\r\n\t\tif (dc - this.rollTotal >= 10) {\r\n\t\t\treturn this.#adjustDegreeByDieValue(DegreeOfSuccess.CRITICAL_FAILURE);\r\n\t\t}\r\n\r\n\t\tif (this.rollTotal >= dc) {\r\n\t\t\treturn this.#adjustDegreeByDieValue(DegreeOfSuccess.SUCCESS);\r\n\t\t}\r\n\r\n\t\treturn this.#adjustDegreeByDieValue(DegreeOfSuccess.FAILURE);\r\n\t}\r\n}\r\n", "export function getEsotericSkill(actor) {\r\n    const skillKeys = ['esoteric', 'esoteric-lore', 'lore-esoteric']\r\n    const skill = Object.values(actor.skills).find(x => skillKeys.includes(x.slug))\r\n\r\n    if (!skill) ui.notifications.warn(`This character doesn't have the 'Esoteric' skill`)\r\n    return skill\r\n}\r\n", "import { getEsotericSkill } from './shared/esoteric'\r\n\r\nexport function esotericCheck(event, actor) {\r\n    if (!actor || !actor.isOwner || !actor.isOfType('character')) {\r\n        ui.notifications.warn('You must select a character token you own.')\r\n        return\r\n    }\r\n\r\n    const skill = getEsotericSkill(actor)\r\n    if (!skill) return\r\n\r\n    const extraRollOptions = new Set()\r\n\r\n    const extraRollNotes = [\r\n        {\r\n            text: `Can be used to Recall Knowledge regarding haunts, curses \r\n    and creatures of any type, but can't be used to Recall Knowledge of other topics.`,\r\n        },\r\n    ]\r\n\r\n    skill.roll({\r\n        rollMode: 'blindroll',\r\n        extraRollNotes,\r\n        options: extraRollOptions,\r\n    })\r\n}\r\n", "import { getItemWithSourceId } from \"module-api\";\r\n\r\nconst FEAT_UUID = \"Compendium.pf2e.classfeatures.Item.jyCEC3eC4B6YaGoy\";\r\nconst EFFECT_UUID = \"Compendium.idleuh.effects.Item.9IapmSGjH0hDaVMv\";\r\n\r\nconst PHYSICAL_TYPES = [\"bludgeoning\", \"slashing\", \"piercing\"];\r\nconst TYPES = [\"fire\", \"earth\", ...PHYSICAL_TYPES];\r\n\r\nexport async function extractElement(event, actor) {\r\n\tif (!actor?.isOfType(\"character\")) {\r\n\t\tui.notifications.warn(\"You need to select a character\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst feat = getItemWithSourceId(actor, FEAT_UUID, [\"feat\"]);\r\n\tif (!feat) {\r\n\t\tui.notifications.warn(\r\n\t\t\t\"Your selected character needs to have the feat <strong>Extract Element</strong>\",\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst targetToken = game.user.targets.first();\r\n\tconst targetActor = targetToken?.actor;\r\n\tif (!targetActor || targetActor === actor) {\r\n\t\tui.notifications.warn(\"You need to target another actor\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst existing = getItemWithSourceId(targetActor, EFFECT_UUID, [\"effect\"]);\r\n\tif (existing) {\r\n\t\tui.notifications.warn(\"Your target's elements have already been extracted\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst saveRoll = await targetActor.saves.fortitude.roll({\r\n\t\tevent,\r\n\t\tlabel: \"Fortitude Save - Extract Element\",\r\n\t\tdc: {\r\n\t\t\tslug: \"class\",\r\n\t\t\tlabel: \"Kineticist DC\",\r\n\t\t\tvalue: actor.classDC.dc.value,\r\n\t\t},\r\n\t});\r\n\r\n\tif (saveRoll.degreeOfSuccess > 2) return;\r\n\r\n\tconst source = (await fromUuid(EFFECT_UUID))?.toObject();\r\n\tconst rules = source.system.rules;\r\n\r\n\tsource.flags.core.sourceId = EFFECT_UUID;\r\n\r\n\tconst warnings = {};\r\n\r\n\trules.push({\r\n\t\tkey: \"Immunity\",\r\n\t\tmode: \"remove\",\r\n\t\ttype: TYPES.slice(),\r\n\t\tpredicate: [\"origin:effect:kinetic-aura\"],\r\n\t});\r\n\r\n\tlet hasEarth = false;\r\n\tconst resistances = targetActor.attributes.resistances.filter(({ type }) =>\r\n\t\tTYPES.includes(type),\r\n\t);\r\n\tfor (const { type, value, exceptions, doubleVs } of resistances) {\r\n\t\tif (type === \"earth\") {\r\n\t\t\thasEarth = {\r\n\t\t\t\tvalue,\r\n\t\t\t\texceptions,\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\trules.push({\r\n\t\t\t\tkey: \"Weakness\",\r\n\t\t\t\ttype,\r\n\t\t\t\tvalue,\r\n\t\t\t\texceptions,\r\n\t\t\t\tpredicate: [\"origin:effect:kinetic-aura\"],\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (doubleVs.length) warnings.doubleVs = true;\r\n\t}\r\n\r\n\tif (hasEarth) {\r\n\t\tfor (const type of PHYSICAL_TYPES) {\r\n\t\t\trules.push({\r\n\t\t\t\tkey: \"Weakness\",\r\n\t\t\t\ttype,\r\n\t\t\t\tvalue: hasEarth.value,\r\n\t\t\t\texceptions: hasEarth.exceptions,\r\n\t\t\t\tpredicate: [\"origin:effect:kinetic-aura\"],\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\ttargetActor.createEmbeddedDocuments(\"Item\", [source]);\r\n\r\n\tconst notes = [];\r\n\tif (warnings.doubleVs) {\r\n\t\tnotes.push(\r\n\t\t\t`The creature has some resistances that are doubled versus criticals, this can't be automated and will have to be manually handled by the GM.`,\r\n\t\t);\r\n\t}\r\n\r\n\tconst formula = `${Math.ceil(actor.level / 2) + 1}d4`;\r\n\tconst DamageRoll = CONFIG.Dice.rolls.find(\r\n\t\t(Roll) => Roll.name === \"DamageRoll\",\r\n\t);\r\n\tconst damageRoll = await new DamageRoll(formula).evaluate({ async: true });\r\n\r\n\tlet flavor = `\r\n<h4 class=\"action\">\r\n    <strong>Extract Element</strong>\r\n    <span class=\"action-glyph\">1</span>\r\n</h4>\r\n<div class=\"target-dc-result\" data-tooltip-class=\"pf2e\" data-tooltip-direction=\"UP\">\r\n    <div class=\"target-dc\"><span data-visibility=\"all\" data-whose=\"target\">Target: ${targetActor.name}</span></div>\r\n</div>\r\n`;\r\n\r\n\tfor (const note of notes) {\r\n\t\tflavor += `<p>${note}</p>`;\r\n\t}\r\n\r\n\tdamageRoll.toMessage({\r\n\t\tflavor,\r\n\t\tspeaker: ChatMessage.getSpeaker({ actor: actor }),\r\n\t\tflags: {\r\n\t\t\tpf2e: {\r\n\t\t\t\tcontext: {\r\n\t\t\t\t\ttarget: {\r\n\t\t\t\t\t\ttoken: targetToken.document.uuid,\r\n\t\t\t\t\t\tactor: targetActor.uuid,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t});\r\n\r\n\tconsole.log({ saveRoll, damageRoll, source });\r\n}\r\n", "import { R, getItemIdentificationDCs, templatePath } from \"module-api\";\r\n\r\nexport class Identify extends Application {\r\n\tconstructor(items, options) {\r\n\t\tsuper(options);\r\n\t\tthis.items = items;\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn mergeObject(Application.defaultOptions, {\r\n\t\t\tid: \"idleuh-identify\",\r\n\t\t\ttitle: \"Identify Items\",\r\n\t\t\ttemplate: templatePath(\"identify\"),\r\n\t\t\twidth: 500,\r\n\t\t});\r\n\t}\r\n\r\n\tgetData(options) {\r\n\t\treturn mergeObject(super.getData(options), {\r\n\t\t\titems: this.items.map((item) => {\r\n\t\t\t\tconst data = item.system.identification.identified;\r\n\t\t\t\tconst identified = item.isIdentified;\r\n\t\t\t\tconst checked =\r\n\t\t\t\t\t!identified && item.getFlag(\"world\", \"identify.checked\");\r\n\r\n\t\t\t\tconst classes = [];\r\n\t\t\t\tif (identified) classes.push(\"identified\");\r\n\t\t\t\tif (checked) classes.push(\"checked\");\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tuuid: item.uuid,\r\n\t\t\t\t\timg: data.img,\r\n\t\t\t\t\tname: item.isOfType(\"treasure\") ? `($) ${data.name}` : data.name,\r\n\t\t\t\t\tcss: classes.join(\" \"),\r\n\t\t\t\t\tidentified,\r\n\t\t\t\t\tchecked,\r\n\t\t\t\t};\r\n\t\t\t}),\r\n\t\t});\r\n\t}\r\n\r\n\tactivateListeners(html) {\r\n\t\thtml.find('[data-action=\"chat\"]').on(\"click\", this.#onChat.bind(this));\r\n\t\thtml.find('[data-action=\"checks\"]').on(\"click\", this.#onChecks.bind(this));\r\n\t\thtml\r\n\t\t\t.find('[data-action=\"identify\"]')\r\n\t\t\t.on(\"click\", this.#onIdentify.bind(this));\r\n\t\thtml.find('[data-action=\"remove\"]').on(\"click\", this.#onRemove.bind(this));\r\n\t\thtml.find('[data-action=\"reset\"]').on(\"click\", this.#onReset.bind(this));\r\n\t}\r\n\r\n\tasync #onChat(event) {\r\n\t\tconst item = await getItemFromEvent(event);\r\n\t\titem?.toMessage(undefined, { create: true });\r\n\t}\r\n\r\n\tasync #onChecks(event) {\r\n\t\tconst item = await getItemFromEvent(event);\r\n\t\tconst identifiedName = item.system.identification.identified.name;\r\n\t\tconst dcs = getItemIdentificationDCs(item, {\r\n\t\t\tpwol: game.pf2e.settings.variants.pwol.enabled,\r\n\t\t\tnotMatchingTraditionModifier: game.settings.get(\r\n\t\t\t\t\"pf2e\",\r\n\t\t\t\t\"identifyMagicNotMatchingTraditionModifier\",\r\n\t\t\t),\r\n\t\t});\r\n\t\tconst action = item.isMagical\r\n\t\t\t? \"identify-magic\"\r\n\t\t\t: item.isAlchemical\r\n\t\t\t  ? \"identify-alchemy\"\r\n\t\t\t  : \"recall-knowledge\";\r\n\r\n\t\tconst content = await renderTemplate(\r\n\t\t\t\"systems/pf2e/templates/actors/identify-item-chat-skill-checks.hbs\",\r\n\t\t\t{\r\n\t\t\t\tidentifiedName,\r\n\t\t\t\taction,\r\n\t\t\t\tskills: R.omit(dcs, [\"dc\"]),\r\n\t\t\t\tunidentified: item.system.identification.unidentified,\r\n\t\t\t\tuuid: item.uuid,\r\n\t\t\t},\r\n\t\t);\r\n\r\n\t\tawait ChatMessage.implementation.create({ user: game.user.id, content });\r\n\t}\r\n\r\n\tasync #onIdentify(event) {\r\n\t\tconst item = await getItemFromEvent(event);\r\n\t\tif (!item) return;\r\n\t\tawait item.setIdentificationStatus(\r\n\t\t\titem.isIdentified ? \"unidentified\" : \"identified\",\r\n\t\t);\r\n\t\tthis.render();\r\n\t}\r\n\r\n\tasync #onRemove(event) {\r\n\t\tconst item = await getItemFromEvent(event);\r\n\t\tif (!item) return;\r\n\r\n\t\tconst checked = item.getFlag(\"world\", \"identify.checked\");\r\n\t\tawait item.setFlag(\"world\", \"identify.checked\", !checked);\r\n\r\n\t\tthis.render();\r\n\t}\r\n\r\n\tasync #onReset(event) {\r\n\t\tevent.preventDefault();\r\n\r\n\t\tfor (const item of this.items) {\r\n\t\t\tif (item.isIdentified || !item.getFlag(\"world\", \"identify.checked\"))\r\n\t\t\t\tcontinue;\r\n\t\t\tawait item.setFlag(\"world\", \"identify.checked\", false);\r\n\t\t}\r\n\r\n\t\tthis.render();\r\n\t}\r\n}\r\n\r\nasync function getItemFromEvent(event) {\r\n\tconst parent = $(event.currentTarget).closest(\"[data-item]\");\r\n\tconst uuid = parent.attr(\"data-item\");\r\n\tconst item = await fromUuid(uuid);\r\n\tif (!item) parent.remove();\r\n\treturn item;\r\n}\r\n", "import { Identify } from '../apps/identify'\r\n\r\nexport function identify() {\r\n    if (!game.user.isGM) {\r\n        ui.notifications.warn('You not the GM yo!')\r\n        return\r\n    }\r\n\r\n    const actors = game.actors\r\n    const items = actors.reduce((acc, actor) => {\r\n        if (!actor.hasPlayerOwner) return acc\r\n        const filtered = actor.items.filter(item => item.isOfType('physical') && !item.isIdentified)\r\n        acc.push(...filtered)\r\n        return acc\r\n    }, [])\r\n\r\n    new Identify(items).render(true)\r\n}\r\n", "import { chatUUID, createConsumableFromSpell, error } from \"module-api\";\r\n\r\nconst packId = \"pf2e.spells-srd\";\r\nconst bookId = \"Item.dcALVAyJbYSovzqt\";\r\n\r\nexport async function ripImaginarium(actor) {\r\n\tif (!actor)\r\n\t\treturn ui.notifications.warn(\r\n\t\t\t\"You must select an actor with the Imaginarium\",\r\n\t\t);\r\n\r\n\tconst book = actor.itemTypes.equipment.find(\r\n\t\t(x) => x.getFlag(\"core\", \"sourceId\") === bookId,\r\n\t);\r\n\tif (!book || book.system.equipped.carryType === \"dropped\")\r\n\t\treturn ui.notifications.warn(\r\n\t\t\t\"This actor doesn't have the Imaginarium in their possession\",\r\n\t\t);\r\n\r\n\tconst level = Math.floor(actor.level / 2) || 1;\r\n\tconst pack = game.packs.get(packId);\r\n\tconst index = await pack.getIndex({\r\n\t\tfields: [\"system.level.value\", \"system.traits\", \"system.ritual\"],\r\n\t});\r\n\r\n\tconst entries = index.filter(\r\n\t\t(x) =>\r\n\t\t\tx.system.level.value <= level &&\r\n\t\t\t!x.system.traits.value.includes(\"cantrip\") &&\r\n\t\t\t!x.system.traits.value.includes(\"focus\") &&\r\n\t\t\t!x.system.ritual &&\r\n\t\t\tx.system.traits.rarity === \"common\",\r\n\t);\r\n\r\n\tconst roll = Math.floor(Math.random() * entries.length);\r\n\tconst spell = await pack.getDocument(entries[roll]._id);\r\n\r\n\tconst scroll = await createConsumableFromSpell(spell, {\r\n\t\ttype: \"scroll\",\r\n\t\theightenedLevel: level,\r\n\t});\r\n\r\n\tif (!scroll) {\r\n\t\terror(\"An error occured while creating an imaginarium scroll\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tscroll.name = `${scroll.name} *`;\r\n\tconst [item] = await actor.createEmbeddedDocuments(\"Item\", [scroll]);\r\n\tconst link = chatUUID(spell.uuid, item.name);\r\n\r\n\tChatMessage.create({\r\n\t\tcontent: `<p>Ripped the last page of the Imaginarium:</p><p>${link}</p>`,\r\n\t\tspeaker: ChatMessage.getSpeaker({ actor: actor }),\r\n\t});\r\n}\r\n", "import { getItemWithSourceId } from \"module-api\";\r\n\r\nconst effectUUID = \"Compendium.idleuh.effects.Item.jjFsfolNR04KzPVh\";\r\nconst featUUID = \"Compendium.idleuh.feats.Item.X3SZ0gTpBkGw3UGX\";\r\nconst debuffUUID = \"Compendium.idleuh.effects.Item.r0hicuQPY0OEAC6g\";\r\n\r\nexport async function marshalInspiration(event, actor) {\r\n\tif (!actor || !actor.isOwner || !actor.isOfType(\"character\")) {\r\n\t\tui.notifications.warn(\"You must select a character token you own.\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (!getItemWithSourceId(actor, featUUID, [\"feat\"])) {\r\n\t\tui.notifications.warn(\r\n\t\t\t\"This character doesn't have <strong>Inspiring Marshal Stance</strong> feat.\",\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (getItemWithSourceId(actor, debuffUUID, [\"effect\"])) {\r\n\t\tui.notifications.warn(\r\n\t\t\t\"This character cannot enter <strong>Inspiring Marshal Stance</strong>.\",\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst dc = getDcByLevel(actor.level);\r\n\r\n\tconst roll = await actor.skills.diplomacy.roll({\r\n\t\tdc: { value: dc },\r\n\t\trollMode: \"roll\",\r\n\t\tlabel:\r\n\t\t\t'<span class=\"pf2-icon\">A</span> <b>Marshal Inspiration</b> <span>(Diplomacy Check)</span>',\r\n\t\textraRollNotes: [\r\n\t\t\t{\r\n\t\t\t\toutcome: [\"criticalFailure\"],\r\n\t\t\t\ttext: `<strong>Critical Failure</strong> You fail to enter the stance and can't take this action again for 1 minute.`,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\toutcome: [\"failure\"],\r\n\t\t\t\ttext: \"<strong>Failure</strong> You fail to enter the stance.\",\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\toutcome: [\"success\"],\r\n\t\t\t\ttext: `<strong>Success</strong> Your marshal's aura grants you and allies a +1 status bonus to attack rolls and saves against mental effects.`,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\toutcome: [\"criticalSuccess\"],\r\n\t\t\t\ttext: `<strong>Critical Success</strong> Your marshal's aura increases to a 20ft. emanation and grants you and allies a +1 status bonus to attack rolls and saves against mental effects.`,\r\n\t\t\t},\r\n\t\t],\r\n\t});\r\n\r\n\tconst success = roll.degreeOfSuccess;\r\n\r\n\tif (success >= 2) {\r\n\t\tawait setEffect(actor, success);\r\n\t} else {\r\n\t\tawait (await getEffect(actor))?.delete();\r\n\t\tif (success === 0) await setDebuff(actor);\r\n\t}\r\n}\r\n\r\nasync function setDebuff(actor) {\r\n\tconst effect = await fromUuid(debuffUUID);\r\n\tif (!effect) return;\r\n\tawait actor.createEmbeddedDocuments(\"Item\", [effect.toObject()]);\r\n}\r\n\r\nasync function setEffect(actor, success) {\r\n\tconst radius = success === 3 ? 20 : 10;\r\n\tconst existing = await getEffect(actor);\r\n\r\n\tif (existing) {\r\n\t\tconst rules = deepClone(existing._source.system.rules);\r\n\t\tconst rule = rules.find((rule) => rule.key === \"ChoiceSet\");\r\n\t\tif (rule.selection === radius) return;\r\n\r\n\t\trule.selection = radius;\r\n\t\texisting.update({ \"system.rules\": rules });\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst effect = await fromUuid(effectUUID);\r\n\tif (!effect) return;\r\n\r\n\tconst source = effect.toObject();\r\n\tconst rule = source.system.rules.find((rule) => rule.key === \"ChoiceSet\");\r\n\r\n\trule.selection = radius;\r\n\tawait actor.createEmbeddedDocuments(\"Item\", [source]);\r\n}\r\n\r\nasync function getEffect(actor) {\r\n\treturn getItemWithSourceId(actor, effectUUID, [\"effect\"]);\r\n}\r\n", "export async function rollDamage({ actor, token, item, formula }) {\r\n    const DamageRoll = CONFIG.Dice.rolls.find(x => x.name === 'DamageRoll')\r\n    const roll = await new DamageRoll(formula).evaluate({ async: true })\r\n    const traits = Array.from(item.traits)\r\n    const context = {\r\n        type: 'damage-roll',\r\n        sourceType: 'attack',\r\n        actor: actor.id,\r\n        token: token?.id,\r\n        target: null,\r\n        domains: [],\r\n        options: [traits, actor.getRollOptions(), item.getRollOptions('item')].flat(),\r\n        mapIncreases: undefined,\r\n        notes: [],\r\n        secret: false,\r\n        rollMode: 'roll',\r\n        traits,\r\n        skipDialog: false,\r\n        outcome: null,\r\n        unadjustedOutcome: null,\r\n    }\r\n\r\n    let flavor = `<h4 class=\"action\"><strong>${item.name}</strong></h4>`\r\n    flavor += '<div class=\"tags\" data-tooltip-class=\"pf2e\">'\r\n    flavor += traits\r\n        .map(tag => {\r\n            const label = game.i18n.localize(CONFIG.PF2E.actionTraits[tag])\r\n            const tooltip = CONFIG.PF2E.traitsDescriptions[tag]\r\n            return `<span class=\"tag\" data-trait=\"${tag}\" data-tooltip=\"${tooltip}\">${label}</span>`\r\n        })\r\n        .join('')\r\n    flavor += '</div><hr>'\r\n\r\n    return roll.toMessage({\r\n        flavor,\r\n        speaker: ChatMessage.implementation.getSpeaker({ actor: actor, token: token }),\r\n        flags: {\r\n            pf2e: {\r\n                context,\r\n                origin: item.getOriginData(),\r\n            },\r\n        },\r\n    })\r\n}\r\n", "import { rollDamage } from './shared/damage'\r\n\r\nconst FEAT_UUID = 'Compendium.pf2e.feats-srd.Item.XJCsa3UbQtsKcqve'\r\n\r\nexport async function thermalNimbus(actor, token) {\r\n    const item = actor?.itemTypes.feat.find(x => x.sourceId === FEAT_UUID)\r\n\r\n    if (!item) {\r\n        ui.notifications.warn('You need to select a kineticist with the <strong>Thermal Nimbus</strong> feat.')\r\n        return\r\n    }\r\n\r\n    const formula = `${Math.floor(actor.level / 2)}[fire]`\r\n\r\n    await rollDamage({ actor, token, item, formula })\r\n}\r\n", "const proficiency = ['untrained', 'trained', 'expert', 'master', 'legendary']\r\n\r\nexport async function groupPerception() {\r\n    if (!game.user.isGM) {\r\n        ui.notifications.warn('You not the GM yo!')\r\n        return\r\n    }\r\n\r\n    let content = ''\r\n\r\n    const actors = game.actors.party?.members ?? []\r\n\r\n    await Promise.all(\r\n        actors.map(async actor => {\r\n            if (!actor.isOfType('character')) return\r\n\r\n            const roll = await actor.perception.roll({ createMessage: false })\r\n            const die = roll.dice[0].total\r\n\r\n            content += `<div style=\"display:flex;justify-content:space-between;\" title=\"${roll.result}\">`\r\n            content += `<span>${actor.name} (${proficiency[actor.perception.rank]})</span><span`\r\n            if (die === 20) content += ' style=\"color: green;\"'\r\n            else if (die === 1) content += ' style=\"color: red;\"'\r\n            content += `>${roll.total}</span></div>`\r\n        })\r\n    )\r\n\r\n    if (content) ChatMessage.create({ content, flavor: 'Group Perception Checks<hr>', whisper: [game.user.id] })\r\n}\r\n", "import { getItemWithSourceId } from \"module-api\";\r\n\r\nconst FEAT_UUID = \"Compendium.pf2e.feats-srd.Item.40mZVDnIP5qBNhTH\";\r\n\r\nexport function sandSnatcher(event, actor) {\r\n\tif (!actor?.isOfType(\"character\")) {\r\n\t\tui.notifications.warn(\"You need to select a character\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst feat = getItemWithSourceId(actor, FEAT_UUID, [\"feat\"]);\r\n\tif (!feat) {\r\n\t\tui.notifications.warn(\r\n\t\t\t\"Your selected character needs to have the feat <strong>Sand Snatcher</strong>\",\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst target = game.user.targets.first()?.actor;\r\n\r\n\tactor.getStatistic(\"impulse\").roll({\r\n\t\tevent,\r\n\t\tlabel: \"Sand Snatcher - Grapple\",\r\n\t\ttarget,\r\n\t\tdc: {\r\n\t\t\tslug: \"fortitude\",\r\n\t\t\tlabel: \"Fortitude DC\",\r\n\t\t\tvalue: target?.saves.fortitude.dc.value,\r\n\t\t},\r\n\t\ttraits: [\"attack\", \"impulse\", \"kineticist\"],\r\n\t\textraRollNotes: [\r\n\t\t\t{\r\n\t\t\t\ttext: game.i18n.localize(\"PF2E.Actions.Grapple.Notes.criticalSuccess\"),\r\n\t\t\t\toutcome: [\"criticalSuccess\"],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: game.i18n.localize(\"PF2E.Actions.Grapple.Notes.success\"),\r\n\t\t\t\toutcome: [\"success\"],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: game.i18n.localize(\"PF2E.Actions.Grapple.Notes.failure\"),\r\n\t\t\t\toutcome: [\"failure\"],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: game.i18n.localize(\"PF2E.Actions.Grapple.Notes.criticalFailure\"),\r\n\t\t\t\toutcome: [\"criticalFailure\"],\r\n\t\t\t},\r\n\t\t],\r\n\t});\r\n}\r\n", "import { rollDamage } from './shared/damage'\r\n\r\nconst effectName = '<strong>Spike Skin</strong> effect'\r\n\r\nconst EFFECT_UUID = 'Compendium.idleuh.effects.Item.aJWj25WLTiG67a1y'\r\nconst FEAT_UUID = 'Compendium.pf2e.feats-srd.Item.9p28s0zg4Vv4r5i2'\r\n\r\nfunction getEffect(actor) {\r\n    return actor?.itemTypes.effect.find(x => x.sourceId === EFFECT_UUID)\r\n}\r\n\r\nfunction effectMissing() {\r\n    ui.notifications.warn(`You need to select an actor with the ${effectName}.`)\r\n}\r\n\r\nexport async function spikeSkinDuration(actor) {\r\n    const effect = getEffect(actor)\r\n\r\n    if (!effect) return effectMissing()\r\n\r\n    const remaining = effect.system.duration.value\r\n    if (remaining <= 0) {\r\n        ui.notifications.warn(`The ${effectName} is already expired on the selected actor.`)\r\n        return\r\n    }\r\n\r\n    await effect.update({ 'system.duration.value': Math.max(0, remaining - 1) })\r\n    ui.notifications.info(`The ${effectName} duration has been reduced by 1 minute.`)\r\n}\r\n\r\nexport async function spikeSkinDamage(actor, token) {\r\n    const effect = getEffect(actor)\r\n\r\n    if (!effect) return effectMissing()\r\n\r\n    const item = await fromUuid(FEAT_UUID)\r\n    const formula = `${Math.floor((actor.level - 8) / 2) * 2 + 2}[piercing]`\r\n\r\n    await rollDamage({ actor, token, item, formula })\r\n}\r\n", "import {\r\n\tgetItemWithSourceId,\r\n\thasItemWithSourceId,\r\n\tsocketEmit,\r\n} from \"module-api\";\r\nimport { getEsotericSkill } from \"./shared/esoteric\";\r\n\r\nconst effectUUID = \"Compendium.idleuh.effects.Item.MqgbuaqGMJ92VRze\";\r\nconst targetUUID = \"Compendium.idleuh.effects.Item.Lz5hNf4dbXKjDWBa\";\r\nconst mortalUUID = \"Compendium.idleuh.effects.Item.8BxBB5ztfRI9vFfZ\";\r\nconst ffUUID = \"Compendium.pf2e.conditionitems.Item.AJh5ex99aV6VTggg\";\r\n\r\nexport async function exploitVulnerability(event, actor, filterTypes) {\r\n\tif (event.ctrlKey) {\r\n\t\tif (game.user.isGM) cleanExploitVulnerabilityGM();\r\n\t\telse socketEmit({ type: \"clean-exploit-vulnerability\" });\r\n\t\tui.notifications.notify(\"All effects are being removed.\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst targets = game.user.targets;\r\n\tconst [target] = targets;\r\n\tconst targetActor = target?.actor;\r\n\r\n\tif (\r\n\t\t!actor ||\r\n\t\t!actor.isOwner ||\r\n\t\t!actor.isOfType(\"character\") ||\r\n\t\ttargets.size !== 1 ||\r\n\t\t!targetActor ||\r\n\t\t!targetActor.isOfType(\"creature\")\r\n\t) {\r\n\t\tui.notifications.warn(\r\n\t\t\t\"You must select a character token you own and target another one.\",\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst skill = getEsotericSkill(actor);\r\n\tif (!skill) return;\r\n\r\n\tconst actionSlug = \"action:recall-knowledge\";\r\n\tconst dc = getDcByLevel(targetActor.level);\r\n\r\n\tconst extraRollOptions = actor.getRollOptions([\r\n\t\t\"all\",\r\n\t\t\"skill-check\",\r\n\t\t\"Esoteric\",\r\n\t]);\r\n\textraRollOptions.push(actionSlug);\r\n\textraRollOptions.push(\"secret\");\r\n\r\n\tconst dv = targetActor.system.attributes.weaknesses;\r\n\tconst vulnerability = dv.reduce((prev, curr) => {\r\n\t\tif (curr.value > prev) return curr.value;\r\n\t\treturn prev;\r\n\t}, 0);\r\n\r\n\tconst weaknesses = dv\r\n\t\t.filter((x) => x.value === vulnerability)\r\n\t\t.map((x) => x.type);\r\n\r\n\tconst joinedWeaknessess = weaknesses.join(\", \");\r\n\r\n\tconst weaknessStr = joinedWeaknessess\r\n\t\t? `<strong>[ ${joinedWeaknessess} ]</strong> = ${vulnerability}<br>`\r\n\t\t: \"\";\r\n\r\n\tconst roll = await skill.roll({\r\n\t\textraRollOptions,\r\n\t\tdc: { value: dc },\r\n\t\trollMode: \"roll\",\r\n\t\tlabel: `<span class=\"pf2-icon\">A</span> <b>Exploit Vulnerability</b> <span\">(Esoteric Check)</span>`,\r\n\t\textraRollNotes: [\r\n\t\t\t{\r\n\t\t\t\toutcome: [\"criticalFailure\"],\r\n\t\t\t\ttext: `<strong>Critical Failure</strong> You couldn't remember the right object to use and become distracted while you rummage through your esoterica. You become flat-footed until the beginning of your next turn.`,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\toutcome: [\"failure\"],\r\n\t\t\t\ttext: `<strong>Failure</strong> Failing to recall a salient weakness about the creature, you instead attempt to exploit a more personal vulnerability. You can exploit only the creature's personal antithesis. Your unarmed and weapon Strikes against the creature also become magical if they weren't already.`,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\toutcome: [\"success\"],\r\n\t\t\t\ttext: `${weaknessStr}<strong>Success</strong> You recall an important fact about the creature, learning its highest weakness (or one of its highest weaknesses, if it has multiple with the same value) but not its other weaknesses, resistances, or immunities. You can exploit either the creature's mortal weakness or personal antithesis. Your unarmed and weapon Strikes against the creature also become magical if they weren't already.`,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\toutcome: [\"criticalSuccess\"],\r\n\t\t\t\ttext: `${weaknessStr}<strong>Critical Success</strong> You remember the creature's weaknesses, and as you empower your esoterica, you have a flash of insight that grants even more knowledge about the creature. You learn all of the creature's resistances, weaknesses, and immunities, including the amounts of the resistances and weaknesses and any unusual weaknesses or vulnerabilities, such as what spells will pass through a golem's antimagic. You can exploit either the creature's mortal weakness or personal antithesis (see the Exploit Vulnerability class feature). Your unarmed and weapon Strikes against the creature also become magical if they weren't already.`,\r\n\t\t\t},\r\n\t\t],\r\n\t});\r\n\r\n\tconst success = roll.degreeOfSuccess;\r\n\r\n\tconst effect = getItemWithSourceId(actor, effectUUID, [\"effect\"]);\r\n\tif (success >= 1 && !effect) {\r\n\t\tconst data = (await fromUuid(effectUUID)).toObject();\r\n\t\tactor.createEmbeddedDocuments(\"Item\", [data]);\r\n\t} else if (success < 1) {\r\n\t\teffect?.delete();\r\n\t\tconst flatEffect = hasItemWithSourceId(actor, ffUUID, [\"condition\"]);\r\n\t\tif (!flatEffect) {\r\n\t\t\tconst data = (await fromUuid(ffUUID)).toObject();\r\n\t\t\tactor.createEmbeddedDocuments(\"Item\", [data]);\r\n\t\t}\r\n\t}\r\n\r\n\tconst filteredWeaknesses = weaknesses.filter((x) => !filterTypes.includes(x));\r\n\r\n\tconst packet = {\r\n\t\ttype: \"exploit-vulnerability\",\r\n\t\tactorId: actor.id,\r\n\t\ttargetId: target.id,\r\n\t\tvulnerability: filteredWeaknesses.length ? vulnerability : 0,\r\n\t\tsuccess,\r\n\t};\r\n\r\n\tif (game.user.isGM) exploitVulnerabilityGM(packet);\r\n\telse socketEmit(packet);\r\n}\r\n\r\nexport async function exploitVulnerabilityGM({\r\n\tactorId,\r\n\ttargetId,\r\n\tvulnerability,\r\n\tsuccess,\r\n}) {\r\n\tconst actor = game.actors.get(actorId);\r\n\tconst targetActor = canvas.tokens.get(targetId)?.actor;\r\n\tif (!actor || !targetActor) return;\r\n\r\n\tconst personal = 2 + Math.floor(actor.level / 2);\r\n\tconst isMortal = success > 1 && vulnerability >= personal;\r\n\r\n\tconst mortalData = (await fromUuid(mortalUUID)).toObject();\r\n\tconst rule = {\r\n\t\tkey: \"Weakness\",\r\n\t\ttype: \"piercing\",\r\n\t\tvalue: vulnerability,\r\n\t\tpredicate: [\"origin:effect:exploit-vulnerability\"],\r\n\t};\r\n\tmortalData.system.rules.push(rule);\r\n\r\n\tfor (const token of canvas.tokens.placeables) {\r\n\t\tconst tokenActor = token.actor;\r\n\t\tif (!tokenActor || tokenActor === actor) continue;\r\n\r\n\t\tconst targetEffect = getItemWithSourceId(tokenActor, targetUUID, [\r\n\t\t\t\"effect\",\r\n\t\t]);\r\n\t\tconst mortalsEffect = getItemWithSourceId(tokenActor, mortalUUID, [\r\n\t\t\t\"effect\",\r\n\t\t]);\r\n\r\n\t\tawait targetEffect?.delete();\r\n\t\tawait mortalsEffect?.delete();\r\n\r\n\t\tif (success < 1) continue;\r\n\r\n\t\tif (tokenActor === targetActor) {\r\n\t\t\tconst data = (await fromUuid(targetUUID)).toObject();\r\n\t\t\tconst rule = {\r\n\t\t\t\tkey: \"Weakness\",\r\n\t\t\t\ttype: \"piercing\",\r\n\t\t\t\tvalue: isMortal ? vulnerability : personal,\r\n\t\t\t\tpredicate: [\"origin:effect:exploit-vulnerability\"],\r\n\t\t\t};\r\n\t\t\tdata.system.rules.push(rule);\r\n\t\t\ttokenActor.createEmbeddedDocuments(\"Item\", [data]);\r\n\t\t} else if (isMortal && tokenActor.id === targetActor.id) {\r\n\t\t\ttokenActor.createEmbeddedDocuments(\"Item\", [mortalData]);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport function cleanExploitVulnerabilityGM() {\r\n\tfor (const token of canvas.tokens.placeables) {\r\n\t\tconst tokenActor = token.actor;\r\n\t\tif (!tokenActor) continue;\r\n\r\n\t\tconst effect = getItemWithSourceId(tokenActor, effectUUID, [\"effect\"]);\r\n\t\tconst targetEffect = getItemWithSourceId(tokenActor, targetUUID, [\r\n\t\t\t\"effect\",\r\n\t\t]);\r\n\t\tconst mortalsEffect = getItemWithSourceId(tokenActor, mortalUUID, [\r\n\t\t\t\"effect\",\r\n\t\t]);\r\n\r\n\t\teffect?.delete();\r\n\t\ttargetEffect?.delete();\r\n\t\tmortalsEffect?.delete();\r\n\t}\r\n}\r\n", "import { MODULE, getSetting, registerModule, socketOn } from \"module-api\";\r\nimport { esotericCheck } from \"./macros/esoteric\";\r\nimport { extractElement } from \"./macros/extract\";\r\nimport { identify } from \"./macros/identify\";\r\nimport { ripImaginarium } from \"./macros/imaginarium\";\r\nimport { marshalInspiration } from \"./macros/marshal\";\r\nimport { thermalNimbus } from \"./macros/nimbus\";\r\nimport { groupPerception } from \"./macros/perception\";\r\nimport { sandSnatcher } from \"./macros/snatcher\";\r\nimport { spikeSkinDamage, spikeSkinDuration } from \"./macros/spike\";\r\nimport {\r\n\tcleanExploitVulnerabilityGM,\r\n\texploitVulnerability,\r\n\texploitVulnerabilityGM,\r\n} from \"./macros/vulnerability\";\r\n\r\nregisterModule(\"idleuh\");\r\n\r\nHooks.once(\"init\", () => {\r\n\tif (!Array.prototype.toReversed) {\r\n\t\tArray.prototype.toReversed = function() {\r\n\t\t\tconst reversed = []\r\n\t\t\tfor (let i = this.length -1; i >= 0; i--) {\r\n\t\t\t\treversed.push(this[i])\r\n\t\t\t}\r\n\t\t\treturn reversed\r\n\t\t}\r\n\t}\r\n\r\n\tgame.modules.get(MODULE.id).api = {\r\n\t\tmacros: {\r\n\t\t\texploitVulnerability,\r\n\t\t\tesotericCheck,\r\n\t\t\tgroupPerception,\r\n\t\t\tidentify,\r\n\t\t\tripImaginarium,\r\n\t\t\tmarshalInspiration,\r\n\t\t\tsandSnatcher,\r\n\t\t\textractElement,\r\n\t\t\tthermalNimbus,\r\n\t\t\tspikeSkinDuration,\r\n\t\t\tspikeSkinDamage,\r\n\t\t},\r\n\t};\r\n\r\n\tgame.settings.register(MODULE.id, \"jquery\", {\r\n\t\tname: \"Disable JQuery Animations\",\r\n\t\thint: \"Will cancel sliding animations on different parts of the UI.\",\r\n\t\ttype: Boolean,\r\n\t\tdefault: false,\r\n\t\tconfig: true,\r\n\t\tscope: \"client\",\r\n\t\tonChange: setJQueryFx,\r\n\t});\r\n});\r\n\r\nHooks.once(\"ready\", () => {\r\n\tif (game.user.isGM) {\r\n\t\tsocketOn(onPacketReceived);\r\n\t}\r\n\r\n\tif (getSetting(\"jquery\")) setJQueryFx(true);\r\n});\r\n\r\nfunction setJQueryFx(disabled) {\r\n\tjQuery.fx.off = disabled;\r\n}\r\n\r\nfunction onPacketReceived(packet) {\r\n\tif (packet.type === \"exploit-vulnerability\") exploitVulnerabilityGM(packet);\r\n\telse if (packet.type === \"clean-exploit-vulnerability\")\r\n\t\tcleanExploitVulnerabilityGM();\r\n}\r\n"],
  "mappings": "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",
  "names": ["chatUUID", "uuid", "label", "__name", "getSourceId", "doc", "__name", "includesSourceId", "list", "sourceId", "getSourceIdCondition", "item", "AsyncFunction", "isInstanceOf", "obj", "name", "cursor", "__name", "joinStr", "separator", "path", "x", "__name", "templatePath", "path", "MODULE", "joinStr", "__name", "getItems", "actor", "itemTypes", "types", "type", "__name", "hasItemWithSourceId", "sourceId", "getSourceIdCondition", "getItemWithSourceId", "localize", "args", "MODULE", "data", "joinStr", "__name", "MODULE_ID", "MODULE", "str", "registerModule", "id", "__name", "notify", "str", "arg1", "arg2", "arg3", "type", "data", "permanent", "localize", "__name", "error", "str", "arg1", "arg2", "notify", "__name", "getSetting", "setting", "MODULE", "__name", "socketOn", "callback", "MODULE", "__name", "socketEmit", "packet", "MODULE", "__name", "es_exports", "__export", "_setPath", "add", "addProp", "allPass", "anyPass", "ceil", "chunk", "clamp", "clone", "compact", "concat", "conditional", "countBy", "createPipe", "debounce", "difference", "differenceWith", "divide", "drop", "dropFirstBy", "dropLast", "dropLastWhile", "dropWhile", "equals", "evolve", "filter", "find", "findIndex", "findLast", "findLastIndex", "first", "firstBy", "flatMap", "flatMapToObj", "flatten", "flattenDeep", "floor", "forEach", "forEachObj", "fromPairs", "groupBy", "hasAtLeast", "identity", "indexBy", "intersection", "intersectionWith", "invert", "isArray", "isBoolean", "isDate", "isDefined", "isEmpty", "isError", "isFunction", "isNil", "isNonNull", "isNot", "isNumber", "isObject", "isObjectType", "isPlainObject", "isPromise", "isString", "isSymbol", "isTruthy", "join", "keys", "last", "length", "map", "mapKeys", "mapToObj", "mapValues", "maxBy", "meanBy", "merge", "mergeAll", "mergeDeep", "minBy", "multiply", "noop", "nthBy", "objOf", "omit", "omitBy", "once", "only", "partition", "pathOr", "pick", "pickBy", "pipe", "prop", "purry", "randomString", "range", "rankBy", "reduce", "reject", "reverse", "round", "sample", "set", "setPath", "shuffle", "sliceString", "sort", "sortBy", "sortedIndex", "sortedIndexBy", "sortedIndexWith", "sortedLastIndex", "sortedLastIndexBy", "splice", "splitAt", "splitWhen", "stringToPath", "subtract", "sumBy", "swapIndices", "swapProps", "take", "takeFirstBy", "takeLastWhile", "takeWhile", "tap", "times", "toPairs", "type", "uniq", "uniqBy", "uniqWith", "values", "zip", "zipObj", "zipWith", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purry", "fn", "args", "lazy", "diff", "arrayArgs", "ret", "__name", "data", "add", "purry", "_add", "__name", "value", "addend", "__assign", "t", "s", "i", "n", "p", "addProp", "purry", "_addProp", "__name", "obj", "prop", "value", "_a", "allPass", "purry", "_allPass", "__name", "data", "fns", "fn", "anyPass", "purry", "_anyPass", "__name", "data", "fns", "fn", "MAX_PRECISION", "_withPrecision", "roundingFn", "value", "precision", "multiplier", "__name", "ceil", "purry", "_withPrecision", "__name", "chunk", "purry", "_chunk", "__name", "array", "size", "ret", "index", "clamp", "purry", "_clamp", "__name", "value", "limits", "type", "val", "__name", "_cloneRegExp", "pattern", "__name", "_clone", "value", "refFrom", "refTo", "deep", "copy", "copiedValue", "len", "idx", "key", "type", "clone", "isTruthy", "data", "__name", "compact", "items", "isTruthy", "__name", "concat", "purry", "_concat", "__name", "arr1", "arr2", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purryOn", "isArg", "implementation", "args", "callArgs", "dataOrArg", "rest", "data", "__name", "conditional", "purryOn", "isCase", "conditionalImplementation", "__name", "data", "cases", "_i", "_a", "cases_1", "_b", "when", "then", "maybeCase", "rest", "trivialDefaultCase", "_countBy", "__name", "indexed", "array", "fn", "ret", "item", "index", "value", "countBy", "purry", "pipe", "value", "operations", "_i", "ret", "lazyOps", "op", "_a", "lazy", "lazyArgs", "fn", "opIdx", "lazyOp", "lazySeq", "j", "acc", "ret_1", "item", "_processItem", "lastLazySeq", "__name", "lazyResult", "isDone", "i", "lazyFn", "indexed", "index", "items", "nextValues", "nextValues_1", "subItem", "subResult", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "createPipe", "operations", "_i", "value", "pipe", "__name", "debounce", "func", "_a", "waitMs", "_b", "timing", "maxWaitMs", "coolDownTimeoutId", "maxWaitTimeoutId", "latestCallArgs", "result", "handleInvoke", "__name", "timeoutId", "args", "handleCoolDownEnd", "handleDebouncedCall", "_i", "_reduceLazy", "array", "lazy", "indexed", "newArray", "index", "item", "result", "__name", "difference", "purry", "_difference", "__name", "array", "other", "lazy", "_reduceLazy", "set", "value", "differenceWith", "purry", "_differenceWith", "__name", "array", "other", "isEquals", "lazy", "_reduceLazy", "value", "otherValue", "divide", "purry", "_divide", "__name", "value", "divisor", "drop", "purry", "_drop", "__name", "array", "n", "_reduceLazy", "lazy", "left", "value", "swapInPlace", "data", "i", "j", "_a", "__name", "heapify", "heap", "compareFn", "i", "heapSiftDown", "__name", "heapMaybeInsert", "item", "head", "index", "currentIndex", "firstChildIndex", "swapIndex", "secondChildIndex", "swapInPlace", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "COMPARATORS", "x", "y", "purryOrderRules", "func", "inputArgs", "_a", "dataOrRule", "rules", "isOrderRule", "compareFn_1", "orderRuleComparer", "compareFn", "data", "__name", "purryOrderRulesWithArgument", "first", "second", "rest", "arg", "argRemoved", "args", "_i", "primaryRule", "secondaryRule", "otherRules", "projector", "direction", "comparator", "nextComparer", "a", "b", "projectedA", "projectedB", "isProjection", "maybeProjection", "maybeDirection", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "dropFirstBy", "purryOrderRulesWithArgument", "dropFirstByImplementation", "__name", "data", "compareFn", "n", "heap", "heapify", "out", "rest", "_i", "rest_1", "item", "previousHead", "heapMaybeInsert", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "dropLast", "purry", "_dropLast", "__name", "array", "n", "copy", "dropLastWhile", "purry", "_dropLastWhile", "__name", "data", "predicate", "i", "dropWhile", "purry", "_dropWhile", "__name", "data", "predicate", "i", "isArray", "keyList", "equals", "purry", "_equals", "__name", "a", "b", "arrA", "arrB", "length_1", "key", "dateA", "dateB", "regexpA", "regexpB", "keys", "toPairs", "object", "__name", "strict", "__assign", "t", "s", "i", "n", "p", "evolve", "purry", "_evolve", "__name", "data", "evolver", "toPairs", "result", "_a", "key", "value", "_toLazyIndexed", "__name", "fn", "filter", "purry", "_filter", "__name", "indexed", "array", "fn", "_reduceLazy", "_lazy", "value", "index", "valid", "_toLazyIndexed", "_toSingle", "__name", "fn", "find", "purry", "_find", "__name", "indexed", "array", "fn", "x", "_lazy", "value", "index", "valid", "_toSingle", "_toLazyIndexed", "findIndex", "purry", "_findIndex", "__name", "indexed", "array", "fn", "x", "_lazy", "i", "value", "index", "valid", "_toSingle", "_toLazyIndexed", "findLast", "purry", "_findLast", "__name", "indexed", "array", "fn", "i", "findLastIndex", "purry", "_findLastIndex", "__name", "indexed", "array", "fn", "i", "first", "purry", "_first", "__name", "_a", "lazy", "value", "hasAtLeast", "args", "_i", "purry", "hasAtLeastImplementation", "__name", "data", "minimum", "firstBy", "purryOrderRules", "firstByImplementation", "__name", "data", "compareFn", "currentFirst", "hasAtLeast", "rest", "_i", "rest_1", "item", "flatten", "purry", "_flatten", "__name", "items", "_reduceLazy", "lazy", "next", "flatMap", "purry", "_flatMap", "__name", "array", "fn", "flatten", "item", "lazy", "value", "next", "flatMapToObj", "purry", "_flatMapToObj", "__name", "indexed", "array", "fn", "result", "element", "index", "items", "_a", "key", "value", "flattenDeep", "purry", "_flattenDeep", "__name", "items", "_reduceLazy", "_flattenDeepValue", "value", "ret", "item", "lazy", "next", "floor", "purry", "_withPrecision", "__name", "forEach", "purry", "_forEach", "__name", "indexed", "array", "fn", "_reduceLazy", "_lazy", "value", "index", "_toLazyIndexed", "forEachObj", "purry", "_forEachObj", "__name", "indexed", "object", "fn", "key", "val", "fromPairs", "entries", "out", "_i", "entries_1", "_a", "key", "value", "__name", "groupBy", "purry", "_groupBy", "__name", "indexed", "array", "fn", "ret", "item", "index", "key", "actualKey", "identity", "value", "__name", "indexBy", "purry", "_indexBy", "__name", "indexed", "array", "fn", "ret", "item", "index", "value", "key", "indexByStrict", "_indexByStrict", "intersection", "purry", "_intersection", "__name", "array", "other", "lazy", "_reduceLazy", "value", "set", "intersectionWith", "purry", "_intersectionWith", "__name", "array", "other", "comparator", "lazy", "_reduceLazy", "value", "otherValue", "invert", "purry", "_invert", "__name", "object", "result", "key", "isArray", "data", "__name", "isBoolean", "data", "__name", "isDate", "data", "__name", "isDefined", "data", "__name", "strict", "isObject", "data", "__name", "isString", "data", "__name", "isEmpty", "data", "isArray", "isString", "isObject", "__name", "isError", "data", "__name", "isFunction", "data", "__name", "isNil", "data", "__name", "isNonNull", "data", "__name", "isNot", "predicate", "data", "__name", "isNumber", "data", "__name", "isObjectType", "__name", "data", "isPlainObject", "data", "proto", "__name", "isPromise", "data", "__name", "isSymbol", "data", "__name", "join", "purry", "joinImplementation", "__name", "data", "glue", "keys", "source", "__name", "last", "purry", "_last", "__name", "array", "length", "purry", "_length", "__name", "items", "map", "purry", "_map", "__name", "indexed", "array", "fn", "_reduceLazy", "_lazy", "value", "index", "_toLazyIndexed", "mapKeys", "arg1", "arg2", "data", "_mapKeys", "__name", "obj", "fn", "acc", "key", "mapToObj", "purry", "_mapToObj", "__name", "indexed", "array", "fn", "result", "element", "index", "_a", "key", "value", "mapValues", "arg1", "arg2", "data", "_mapValues", "__name", "obj", "fn", "acc", "key", "_maxBy", "__name", "indexed", "array", "fn", "ret", "retMax", "item", "i", "max", "maxBy", "purry", "_meanBy", "__name", "indexed", "array", "fn", "sum", "item", "i", "meanBy", "purry", "merge", "purry", "_merge", "__name", "a", "b", "__assign", "t", "s", "i", "n", "p", "mergeAll", "items", "acc", "x", "__name", "__assign", "t", "s", "i", "n", "p", "mergeDeep", "purry", "mergeDeepImplementation", "__name", "destination", "source", "output", "key", "destinationValue", "isRecord", "sourceValue", "object", "_minBy", "__name", "indexed", "array", "fn", "ret", "retMin", "item", "i", "min", "minBy", "purry", "multiply", "purry", "_multiply", "__name", "value", "multiplicand", "noop", "__name", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "quickSelect", "__name", "data", "index", "compareFn", "quickSelectImplementation", "left", "right", "pivotIndex", "partition", "pivot", "j", "swapInPlace", "nthBy", "purryOrderRulesWithArgument", "nthByImplementation", "__name", "data", "compareFn", "index", "quickSelect", "objOf", "purry", "_objOf", "__name", "value", "key", "_a", "__assign", "t", "s", "i", "n", "p", "__rest", "e", "omit", "purry", "_omit", "__name", "data", "propNames", "propName", "_a", "_b", "omitted", "remaining", "asSet", "fromPairs", "key", "omitBy", "purry", "_omitBy", "__name", "object", "fn", "acc", "key", "once", "fn", "called", "ret", "__name", "only", "purry", "_only", "__name", "array", "partition", "purry", "_partition", "__name", "indexed", "array", "fn", "ret", "item", "index", "matches", "pathOr", "purry", "_pathOr", "__name", "object", "path", "defaultValue", "current", "_i", "path_1", "prop", "pick", "purry", "_pick", "__name", "object", "names", "acc", "name", "pickBy", "purry", "_pickBy", "__name", "object", "fn", "acc", "key", "prop", "__name", "propName", "_a", "_b", "value", "range", "purry", "_range", "__name", "start", "end", "ret", "i", "randomString", "length", "characterSet", "randomChar", "__name", "range", "text", "rankBy", "purryOrderRulesWithArgument", "rankByImplementation", "__name", "data", "compareFn", "targetItem", "rank", "_i", "data_1", "item", "reduce", "purry", "_reduce", "__name", "indexed", "items", "fn", "initialValue", "acc", "item", "index", "reject", "purry", "_reject", "__name", "indexed", "array", "fn", "_reduceLazy", "_lazy", "value", "index", "valid", "_toLazyIndexed", "reverse", "purry", "_reverse", "__name", "array", "round", "purry", "_withPrecision", "__name", "sample", "args", "_i", "purry", "sampleImplementation", "__name", "data", "sampleSize", "actualSampleSize", "sampleIndices", "randomIndex", "b", "index", "_", "__assign", "t", "s", "i", "n", "p", "set", "purry", "_set", "__name", "obj", "prop", "value", "_a", "__assign", "t", "s", "i", "n", "p", "setPath", "purry", "_setPath", "__name", "object", "path", "value", "_a", "item", "index", "shuffle", "purry", "_shuffle", "__name", "items", "result", "index", "rand", "value", "sliceString", "__name", "indexStart", "indexEnd", "data", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "sort", "purry", "_sort", "__name", "items", "cmp", "ret", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "sortBy", "purryOrderRules", "_sortBy", "__name", "data", "compareFn", "_binarySearchCutoffIndex", "array", "predicate", "lowIndex", "highIndex", "pivotIndex", "pivot", "__name", "sortedIndex", "purry", "sortedIndexImplementation", "__name", "array", "item", "_binarySearchCutoffIndex", "pivot", "sortedIndexBy", "purry", "sortedIndexByImplementation", "__name", "indexed", "array", "item", "valueFunction", "value", "_binarySearchCutoffIndex", "pivot", "index", "sortedIndexWith", "purry", "_binarySearchCutoffIndex", "__name", "indexed", "sortedLastIndex", "purry", "sortedLastIndexImplementation", "__name", "array", "item", "_binarySearchCutoffIndex", "pivot", "sortedLastIndexBy", "purry", "sortedLastIndexByImplementation", "__name", "indexed", "array", "item", "valueFunction", "value", "_binarySearchCutoffIndex", "pivot", "index", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "splice", "purry", "_splice", "__name", "items", "start", "deleteCount", "replacement", "result", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "splitAt", "purry", "_splitAt", "__name", "array", "index", "copy", "tail", "splitWhen", "purry", "_splitWhen", "__name", "array", "fn", "i", "splitAt", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "stringToPath", "path", "_stringToPath", "__name", "_a", "match", "key", "rest", "subtract", "purry", "_subtract", "__name", "value", "subtrahend", "_sumBy", "__name", "indexed", "array", "fn", "sum", "item", "i", "summand", "sumBy", "purry", "swapIndices", "purry", "_swapIndices", "__name", "item", "index1", "index2", "_swapString", "_swapArray", "result", "positiveIndexA", "positiveIndexB", "__assign", "t", "s", "i", "n", "p", "swapProps", "purry", "_swapProps", "__name", "obj", "key1", "key2", "_a", "_b", "_c", "value1", "_d", "value2", "take", "purry", "_take", "__name", "array", "n", "_reduceLazy", "lazy", "value", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "takeFirstBy", "purryOrderRulesWithArgument", "takeFirstByImplementation", "__name", "data", "compareFn", "n", "heap", "heapify", "rest", "_i", "rest_1", "item", "heapMaybeInsert", "takeLastWhile", "purry", "_takeLastWhile", "__name", "data", "predicate", "i", "takeWhile", "purry", "_takeWhile", "__name", "array", "fn", "ret", "_i", "array_1", "item", "tap", "purry", "_tap", "__name", "value", "fn", "times", "purry", "_times", "__name", "count", "fn", "res", "i", "uniq", "purry", "_uniq", "__name", "array", "_reduceLazy", "lazy", "set", "value", "uniqBy", "purry", "_uniqBy", "lazyUniqBy", "__name", "array", "transformer", "_reduceLazy", "set", "value", "appliedItem", "uniqWith", "purry", "_uniqWith", "__name", "array", "isEquals", "lazy", "_reduceLazy", "_lazy", "value", "index", "otherValue", "_toLazyIndexed", "values", "source", "__name", "zip", "purry", "_zip", "__name", "first", "second", "resultLength", "result", "zipObj", "purry", "_zipObj", "__name", "first", "second", "resultLength", "result", "zipWith", "args", "f", "s", "_zipWith", "__name", "first", "second", "fn", "resultLength", "result", "i", "ErrorPF2e", "message", "__name", "setHasElement", "set", "value", "__name", "dcAdjustments", "dcByLevel", "calculateDC", "level", "pwol", "rarity", "dc", "dcByLevel", "adjustDCByRarity", "__name", "adjustDCByRarity", "dc", "rarity", "adjustDC", "rarityToDCAdjustment", "__name", "adjustment", "dcAdjustments", "MAGIC_TRADITIONS", "IdentifyItemPopup", "getItemIdentificationDCs", "item", "$html", "html", "updateButton", "identifiedName", "dcs", "action", "content", "_event", "formData", "status", "__name", "pwol", "notMatchingTraditionModifier", "baseDC", "calculateDC", "rarity", "getDcRarity", "dc", "adjustDCByRarity", "getIdentifyMagicDCs", "result", "traditions", "getMagicTraditions", "key", "MAGIC_TRADITIONS", "traits", "t", "setHasElement", "inlineSelector", "keyword", "MoveLootPopup", "object", "options", "callback", "prompt", "buttonLabel", "_event", "formData", "__name", "CANTRIP_DECK_ID", "scrollCompendiumIds", "SPELL_CONSUMABLE_NAME_TEMPLATES", "wandCompendiumIds", "createConsumableFromSpell", "spell", "type", "heightenedLevel", "mystified", "temp", "itemImg", "itemName", "pack", "p", "itemId", "getIdForSpellConsumable", "consumable", "isInstanceOf", "ErrorPF2e", "consumableSource", "traits", "uniq", "t", "setHasElement", "MAGIC_TRADITIONS", "getNameForSpellConsumable", "description", "paragraphElement", "containerElement", "hrElement", "__name", "CANTRIP_DECK_ID", "scrollCompendiumIds", "wandCompendiumIds", "spellName", "templateId", "SPELL_CONSUMABLE_NAME_TEMPLATES", "DEGREE_ADJUSTMENT_AMOUNTS", "DEGREE_OF_SUCCESS_STRINGS", "_getDegreeAdjustment", "getDegreeAdjustment_fn", "_adjustDegreeOfSuccess", "adjustDegreeOfSuccess_fn", "_adjustDegreeByDieValue", "adjustDegreeByDieValue_fn", "_calculateDegreeOfSuccess", "calculateDegreeOfSuccess_fn", "_DegreeOfSuccess", "roll", "dc", "dosAdjustments", "__privateAdd", "t", "d", "__privateMethod", "DegreeOfSuccess", "__name", "degree", "adjustments", "outcome", "label", "amount", "degreeOfSuccess", "__publicField", "getEsotericSkill", "actor", "skillKeys", "skill", "x", "__name", "esotericCheck", "event", "actor", "skill", "getEsotericSkill", "extraRollOptions", "extraRollNotes", "__name", "FEAT_UUID", "EFFECT_UUID", "PHYSICAL_TYPES", "TYPES", "extractElement", "event", "actor", "getItemWithSourceId", "targetToken", "targetActor", "saveRoll", "source", "rules", "warnings", "hasEarth", "resistances", "type", "value", "exceptions", "doubleVs", "notes", "formula", "DamageRoll", "Roll", "damageRoll", "flavor", "note", "__name", "Identify", "items", "options", "templatePath", "item", "data", "identified", "checked", "classes", "html", "#onChat", "#onChecks", "#onIdentify", "#onRemove", "#onReset", "event", "getItemFromEvent", "identifiedName", "dcs", "getItemIdentificationDCs", "action", "content", "es_exports", "__name", "parent", "uuid", "identify", "items", "acc", "actor", "filtered", "item", "Identify", "__name", "packId", "bookId", "ripImaginarium", "actor", "book", "x", "level", "pack", "entries", "roll", "spell", "scroll", "createConsumableFromSpell", "error", "item", "link", "chatUUID", "__name", "effectUUID", "featUUID", "debuffUUID", "marshalInspiration", "event", "actor", "getItemWithSourceId", "dc", "success", "setEffect", "getEffect", "setDebuff", "__name", "effect", "radius", "existing", "rules", "rule", "source", "rollDamage", "actor", "token", "item", "formula", "DamageRoll", "x", "roll", "traits", "context", "flavor", "tag", "label", "tooltip", "__name", "FEAT_UUID", "thermalNimbus", "actor", "token", "item", "x", "formula", "rollDamage", "__name", "proficiency", "groupPerception", "content", "actors", "actor", "roll", "die", "__name", "FEAT_UUID", "sandSnatcher", "event", "actor", "getItemWithSourceId", "target", "__name", "effectName", "EFFECT_UUID", "FEAT_UUID", "getEffect", "actor", "x", "__name", "effectMissing", "spikeSkinDuration", "effect", "remaining", "spikeSkinDamage", "token", "item", "formula", "rollDamage", "effectUUID", "targetUUID", "mortalUUID", "ffUUID", "exploitVulnerability", "event", "actor", "filterTypes", "cleanExploitVulnerabilityGM", "socketEmit", "targets", "target", "targetActor", "skill", "getEsotericSkill", "actionSlug", "dc", "extraRollOptions", "dv", "vulnerability", "prev", "curr", "weaknesses", "x", "joinedWeaknessess", "weaknessStr", "success", "effect", "getItemWithSourceId", "data", "hasItemWithSourceId", "filteredWeaknesses", "packet", "exploitVulnerabilityGM", "__name", "actorId", "targetId", "personal", "isMortal", "mortalData", "rule", "token", "tokenActor", "targetEffect", "mortalsEffect", "registerModule", "reversed", "i", "MODULE", "exploitVulnerability", "esotericCheck", "groupPerception", "identify", "ripImaginarium", "marshalInspiration", "sandSnatcher", "extractElement", "thermalNimbus", "spikeSkinDuration", "spikeSkinDamage", "setJQueryFx", "socketOn", "onPacketReceived", "getSetting", "disabled", "__name", "packet", "exploitVulnerabilityGM", "cleanExploitVulnerabilityGM"]
}
